<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="For the class: Statistics and Analysis with R &amp; Quarto">

<title>통계와 분석 - 12&nbsp; 선형 회귀분석</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./solutions.html" rel="next">
<link href="./variance-analysis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./linear-regression.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">선형 회귀분석</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">통계와 분석</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">안내</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">강의 소개</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">통계의 기초 개념</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R 기본</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./write-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quarto 사용하기</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">데이터의 변환, 요약, 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">기술통계</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exploratoy-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">탐색적 데이터 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probabilistic-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">확률분포와 표집분포</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-hypothesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">추정과 가설 검정</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./categorical-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">범주형 자료분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variance-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">분산분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">선형 회귀분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">해답</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">참고문헌</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#피어슨-상관계수" id="toc-피어슨-상관계수" class="nav-link active" data-scroll-target="#피어슨-상관계수"><span class="header-section-number">12.1</span> 피어슨 상관계수</a></li>
  <li><a href="#편상관계수" id="toc-편상관계수" class="nav-link" data-scroll-target="#편상관계수"><span class="header-section-number">12.2</span> 편상관계수</a></li>
  <li><a href="#공분산" id="toc-공분산" class="nav-link" data-scroll-target="#공분산"><span class="header-section-number">12.3</span> 공분산</a></li>
  <li><a href="#단순회귀분석" id="toc-단순회귀분석" class="nav-link" data-scroll-target="#단순회귀분석"><span class="header-section-number">12.4</span> 단순회귀분석</a>
  <ul class="collapse">
  <li><a href="#단순회귀계수-산출" id="toc-단순회귀계수-산출" class="nav-link" data-scroll-target="#단순회귀계수-산출"><span class="header-section-number">12.4.1</span> 단순회귀계수 산출</a></li>
  <li><a href="#anscombes-quartet" id="toc-anscombes-quartet" class="nav-link" data-scroll-target="#anscombes-quartet"><span class="header-section-number">12.4.2</span> Anscombe’s quartet</a></li>
  <li><a href="#단순회귀모형-적합성-검정" id="toc-단순회귀모형-적합성-검정" class="nav-link" data-scroll-target="#단순회귀모형-적합성-검정"><span class="header-section-number">12.4.3</span> 단순회귀모형 적합성 검정</a></li>
  <li><a href="#분산분석표" id="toc-분산분석표" class="nav-link" data-scroll-target="#분산분석표"><span class="header-section-number">12.4.4</span> 분산분석표</a></li>
  <li><a href="#단순회귀모형의-유의성-검토" id="toc-단순회귀모형의-유의성-검토" class="nav-link" data-scroll-target="#단순회귀모형의-유의성-검토"><span class="header-section-number">12.4.5</span> 단순회귀모형의 유의성 검토</a></li>
  <li><a href="#단순회귀-추정의-표준오차" id="toc-단순회귀-추정의-표준오차" class="nav-link" data-scroll-target="#단순회귀-추정의-표준오차"><span class="header-section-number">12.4.6</span> 단순회귀 추정의 표준오차</a></li>
  <li><a href="#결정계수" id="toc-결정계수" class="nav-link" data-scroll-target="#결정계수"><span class="header-section-number">12.4.7</span> 결정계수</a></li>
  <li><a href="#회귀계수의-신뢰구간" id="toc-회귀계수의-신뢰구간" class="nav-link" data-scroll-target="#회귀계수의-신뢰구간"><span class="header-section-number">12.4.8</span> 회귀계수의 신뢰구간</a></li>
  </ul></li>
  <li><a href="#단순회귀모형의-검토" id="toc-단순회귀모형의-검토" class="nav-link" data-scroll-target="#단순회귀모형의-검토"><span class="header-section-number">12.5</span> 단순회귀모형의 검토</a>
  <ul class="collapse">
  <li><a href="#잔차의-검토" id="toc-잔차의-검토" class="nav-link" data-scroll-target="#잔차의-검토"><span class="header-section-number">12.5.1</span> 잔차의 검토</a></li>
  <li><a href="#선형성-검토" id="toc-선형성-검토" class="nav-link" data-scroll-target="#선형성-검토"><span class="header-section-number">12.5.2</span> 선형성 검토</a></li>
  <li><a href="#정규성-검토" id="toc-정규성-검토" class="nav-link" data-scroll-target="#정규성-검토"><span class="header-section-number">12.5.3</span> 정규성 검토</a></li>
  <li><a href="#등분산성-검토" id="toc-등분산성-검토" class="nav-link" data-scroll-target="#등분산성-검토"><span class="header-section-number">12.5.4</span> 등분산성 검토</a></li>
  <li><a href="#독립성-검토" id="toc-독립성-검토" class="nav-link" data-scroll-target="#독립성-검토"><span class="header-section-number">12.5.5</span> 독립성 검토</a></li>
  </ul></li>
  <li><a href="#다중회귀분석" id="toc-다중회귀분석" class="nav-link" data-scroll-target="#다중회귀분석"><span class="header-section-number">12.6</span> 다중회귀분석</a>
  <ul class="collapse">
  <li><a href="#다중회귀-회귀계수" id="toc-다중회귀-회귀계수" class="nav-link" data-scroll-target="#다중회귀-회귀계수"><span class="header-section-number">12.6.1</span> 다중회귀 회귀계수</a></li>
  <li><a href="#다중회귀-분산분석표" id="toc-다중회귀-분산분석표" class="nav-link" data-scroll-target="#다중회귀-분산분석표"><span class="header-section-number">12.6.2</span> 다중회귀 분산분석표</a></li>
  <li><a href="#다중회귀-결정계수" id="toc-다중회귀-결정계수" class="nav-link" data-scroll-target="#다중회귀-결정계수"><span class="header-section-number">12.6.3</span> 다중회귀 결정계수</a></li>
  <li><a href="#다중회귀-유의성-검정" id="toc-다중회귀-유의성-검정" class="nav-link" data-scroll-target="#다중회귀-유의성-검정"><span class="header-section-number">12.6.4</span> 다중회귀 유의성 검정</a></li>
  <li><a href="#다공선성" id="toc-다공선성" class="nav-link" data-scroll-target="#다공선성"><span class="header-section-number">12.6.5</span> 다공선성</a></li>
  <li><a href="#교호작용" id="toc-교호작용" class="nav-link" data-scroll-target="#교호작용"><span class="header-section-number">12.6.6</span> 교호작용</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-reg" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">선형 회귀분석</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="피어슨-상관계수" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="피어슨-상관계수"><span class="header-section-number">12.1</span> 피어슨 상관계수</h2>
<p><strong>상관분석</strong> correlation analysis 은 두 변수 사이의 관계가 관련되어 있는 정도를 측정하는 방법입니다. 여러 기법이 있는데, <strong>피어슨 상관계수</strong> Pearson correlation coefficient 는 상관분석에서 가장 흔하게 사용하는 방법입니다. 모집단에서 각 개체가 가진 특성 두 개를 X와 Y라고 하면, 두 변수 사이에 직선관계가 얼마나 강한가를 <span class="math inline">\(\rho\)</span>=Corr(<span class="math inline">\(X,Y\)</span>)로 표기합니다. 상관계수는 -1에서 1 사이의 값을 가지며 0이면 두 변수가 독립적입니다.</p>
<p>모 상관계수의 계산은;</p>
<p><span class="math display">\[ \rho_{XY} = {Corr}(X,Y) = \frac{Cov(X,Y)}{\sigma_X \sigma_Y} \]</span></p>
<p>표본 상관계수의 계산은;</p>
<p><span class="math display">\[ r = \frac{\sum_{i=1}^{n}(x_i-\bar x)(y_i-\bar y)}{\sqrt{\sum_{i=1}^{n}(x_i-\bar x)^2 \sum_{i=1}^{n}(y_i-\bar y)^2}} = \frac{S_{xy}}{S_x S_y} \]</span></p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.1 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>다음은 옷가게에서 손님의 키와 무게를 조사한 것입니다. 상관계수를 구하세요.</p>
</blockquote>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">6</th>
<th style="text-align: center;">7</th>
<th style="text-align: center;">8</th>
<th style="text-align: center;">9</th>
<th style="text-align: center;">10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">키</td>
<td style="text-align: center;">162</td>
<td style="text-align: center;">158</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">168</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">154</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">166</td>
<td style="text-align: center;">170</td>
<td style="text-align: center;">146</td>
</tr>
<tr class="even">
<td style="text-align: center;">무게</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">52</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">50</td>
<td style="text-align: center;">67</td>
<td style="text-align: center;">56</td>
<td style="text-align: center;">66</td>
<td style="text-align: center;">72</td>
<td style="text-align: center;">51</td>
</tr>
</tbody>
</table>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x=키, y=무게</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">162</span>, <span class="dv">158</span>, <span class="dv">160</span>, <span class="dv">168</span>, <span class="dv">150</span>, <span class="dv">154</span>, <span class="dv">160</span>, <span class="dv">166</span>, <span class="dv">170</span>, <span class="dv">146</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">52</span>, <span class="dv">60</span>, <span class="dv">58</span>, <span class="dv">50</span>, <span class="dv">67</span>, <span class="dv">56</span>, <span class="dv">66</span>, <span class="dv">72</span>, <span class="dv">51</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)   <span class="co"># x 평균</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)   <span class="co"># y 평균</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>S_xy <span class="ot">&lt;-</span> <span class="fu">sum</span>( (x<span class="sc">-</span>xbar)<span class="sc">*</span>(y<span class="sc">-</span>ybar) ) <span class="co"># 공분산: x 편차와 y 편차를 곱해서 다 더한 것</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>S_x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( <span class="fu">sum</span>( (x<span class="sc">-</span>xbar)<span class="sc">^</span><span class="dv">2</span> ) )  <span class="co"># x 편차를 제곱해서 다 더한 뒤에 제곱근</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>S_y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( <span class="fu">sum</span>( (y<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span> ) )  <span class="co"># y 편차를 제곱해서 다 더한 뒤에 제곱근</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> S_xy<span class="sc">/</span>(S_x<span class="sc">*</span>S_y)  <span class="co"># 공식에 대입해서 구한 상관계수</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"상관계수= "</span>, r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>상관계수=  0.6208491</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x,y)  <span class="co"># 답이 맞나 확인</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.6208491</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>위의 코드청크는 전에 나왔던 벡터변수를 계산하는 공식을 사용한 것입니다. 참고로 다시 잠깐 떠올려 봅시다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 벡터변수를 만들고 계산하는 예</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 3</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)   <span class="co"># 평균</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)    <span class="co"># 합</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 6</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>x <span class="sc">*</span> <span class="dv">3</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3 6 9</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>y</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4 5 6</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 벡터변수 두 개를 서로 곱하면; </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>x <span class="sc">*</span> y  <span class="co"># (1*4, 2*5, 3*6)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]  4 10 18</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x <span class="sc">*</span> y)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 32</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.2 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>위의 키와 무게 상관계수 <span class="math inline">\(r\)</span>의 표준오차 <span class="math inline">\(S_{r}\)</span>와 <span class="math inline">\(r\)</span>의 <span class="math inline">\(t\)</span> 값은 얼마입니까?</p>
</blockquote>
</div>
<p><strong>답:</strong> 아래의 공식에 따라서 <span class="math inline">\(r\)</span>의 <span class="math inline">\(t\)</span>값과 표준오차를 구합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> r <span class="co">#위의 r값을 그대로 가져온다</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)  <span class="co"># 10 손님의 수 또는 표본의 크기</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>S_r <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( (<span class="dv">1</span><span class="sc">-</span>r<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(n<span class="dv">-2</span>) )</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (r<span class="dv">-0</span>)<span class="sc">/</span>S_r</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pt</span>(t, n<span class="dv">-2</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>         <span class="co"># \n은 줄 바꿈 기능, round( ,3)은 소수3자리 반올림</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"표준오차= "</span>, <span class="fu">round</span>(S_r, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>) </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>out2 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"t= "</span>, <span class="fu">round</span>(t, <span class="dv">3</span>), <span class="st">"p= "</span>, <span class="fu">round</span>(p, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>out3 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"(참고로 임곗값은"</span>, <span class="fu">round</span>(<span class="fu">qt</span>(<span class="fl">0.025</span>, <span class="dv">8</span>), <span class="dv">3</span>), </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>              <span class="fu">round</span>(<span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="dv">8</span>), <span class="dv">3</span>), <span class="st">")"</span> )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 한꺼번에 출력</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(out1, out2, out3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>표준오차=  0.784 
 t=  0.792 p=  0.713 
 (참고로 임곗값은 -2.306 2.306 )</code></pre>
</div>
</div>
<p>여기에서 모 상관계수가 0인지 아닌지 또는 두 변수가 상관관계가 있는지 없는지 알기 위해서 검정을 할 수 있습니다. 검정 통계량은 <span class="math inline">\(t\)</span> 값입니다. 자유도는 <span class="math inline">\(n-2\)</span>.</p>
<ul>
<li><span class="math inline">\(H_0: \rho=0\)</span> 두 변수는 상관관계가 없다.</li>
<li><span class="math inline">\(H_A: \rho \ne 0\)</span> 두 변수는 상관관계가 있다.</li>
</ul>
<p>검정을 하려면 표본 상관계수 <span class="math inline">\(r\)</span>의 표집분포를 살펴봐야 합니다. 모집단에서 두 변수가 관계가 없다는 가정을 하면 모집단의 상관계수 <span class="math inline">\(\rho\)</span>=0 입니다. 따라서 상관계수의 <span class="math inline">\(t\)</span>값은 아래와 같습니다. <span class="math inline">\(S_r\)</span>은 <span class="math inline">\(r\)</span>의 표준오차입니다.</p>
<p><span class="math display">\[ t=\frac{r-0}{S_r}, \; \; 여기서 \; \; S_r=\sqrt{\frac{1-r^2}{n-2}}   \]</span></p>
<p>산출한 <span class="math inline">\(t\)</span>값 또는 그에 대응하는 <span class="math inline">\(p\)</span>값을 미리 정한 유의수준 <span class="math inline">\(\alpha\)</span>이나 그에 대응하는 <span class="math inline">\(t\)</span> 임계값과 비교하여 결정합니다.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.3 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>iris 데이터셋의 변수 Sepal.Length 와 Petal.Length 의 상관계수를 구하세요.</p>
</blockquote>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"iris"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 피어슨 상관계수 계산</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Petal.Length)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  iris$Sepal.Length and iris$Petal.Length
t = 21.646, df = 148, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.8270363 0.9055080
sample estimates:
      cor 
0.8717538 </code></pre>
</div>
</div>
<p><strong>답:</strong> <span class="math inline">\(r\)</span>= 0.8717538, <span class="math inline">\(t\)</span>= 21.6460193, <span class="math inline">\(p\)</span>= 0 <span class="math inline">\(\lt 0.005\)</span></p>
<p>따라서 유의수준 <span class="math inline">\(\alpha\)</span>=1% 수준에서 두 변수는 상관관계가 있다.</p>
<p>(참고로 신뢰구간은 0.8270363, 0.905508)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>$r$= `r result[4]`, $t$= `r result[1]`, $p$= `r round(result[[3]], 3)` $\lt 0.005$</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>따라서 유의수준 $\alpha$=1% 수준에서 두 변수는 상관관계가 있다. </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>(참고로 신뢰구간은 `r result$conf.int`)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>상관계수는 리스트 변수인 <code>result</code> 속의 한 요소로서 <strong>이름 있는 데이터</strong> named data 로 저장되어 있습니다. 그래서 인라인 코드에서 <code>result[4]</code>하면 미리 정한 규칙에 따라 숫자만을 되주지만 <code>round(result[4])</code>는 에러가 납니다. <code>round()</code>에는 숫자형 데이터만 들어갈 수 있기 때문입니다 (이름 있는 데이터가 아니고). 함수를 사용하면서 이름 있는 데이터 형에서 숫자만을 끄집어내려면 ’[[ ]]’을 사용합니다. 그래서 <code>round(result[[4]])</code>라고 해야 합니다. (또는 이름을 사용해서, <code>result[["estimate"]]</code>) 아래의 차이를 보세요.</p>
<div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>result[<span class="dv">4</span>]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>result[<span class="st">"estimate"</span>]</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>result[[<span class="dv">4</span>]]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>result[[<span class="st">"estimate"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>$estimate
      cor 
0.8717538 </code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>$estimate
      cor 
0.8717538 </code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>      cor 
0.8717538 </code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>      cor 
0.8717538 </code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
결과에 나타난 용어의 의미
</div>
</div>
<div class="callout-body-container callout-body">
<p>위 상관분석 결과에서 나타난 용어 <code>confidence interval</code>과 <code>estimate</code>를 주목해주세요. 이 용어들은 <a href="inference-hypothesis.html"><span>9</span></a> 장의 <a href="inference-hypothesis.html#sec-hyp-p-estimate">점 추정</a>과 <a href="inference-hypothesis.html#sec-hyp-conf-interval">구간 추정</a>에서 배웠습니다. 거기에 다시 가서 한 번 읽어보세요.</p>
</div>
</div>
<p>위의 <code>corr.test</code> 함수 결과가 저장된 <code>result</code>는 데이터 형태가 <strong>리스트 list</strong> 입니다. 다루기 어렵지 않지만 익숙해지기까지 시간이 걸리니까 위의 예를 보고 그대로 사용하거나 또는 코드청크의 결과를 보고 직접 숫자를 넣어도 좋습니다. 아래는 위의 청크를 실행한 뒤에 오른쪽 위 Environment 패널에 생긴 result를 클릭하면 왼쪽 위에 나타나는 result의 리스트 값들입니다. 작은 삼각형들을 눌러서 펼친 결과입니다.</p>
<div id="fig-list-result-lm" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/list-result-lm.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.1: result의 리스트 형태</figcaption>
</figure>
</div>
<p>참고로 <a href="data-transform.html#sec-tra-list"><span>Section&nbsp;5.3</span></a> 에 나왔던 여러 데이터 형태를 다시 보면,</p>
<div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ve <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)  <span class="co"># 벡터</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ve</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>), <span class="at">nrow=</span><span class="dv">2</span>)  <span class="co"># 매트릭스</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ma</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>li <span class="ot">&lt;-</span> <span class="fu">list</span>(보호자<span class="ot">=</span><span class="st">"영희"</span>, 아이_수<span class="ot">=</span><span class="dv">3</span>, 아이_나이<span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">9</span>), 아이_이름<span class="ot">=</span><span class="fu">c</span>(<span class="st">"수동"</span>, <span class="st">"길동"</span>, <span class="st">"신혜"</span>) )    <span class="co"># 리스트</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>li</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>키 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">174</span>, <span class="dv">182</span>, <span class="dv">167</span>, <span class="dv">164</span>, <span class="dv">161</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>무게 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">72</span>, <span class="dv">74</span>, <span class="dv">65</span>, <span class="dv">62</span>, <span class="dv">59</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(키, 무게)  <span class="co"># 데이터 프레임</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>da</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>     [,1] [,2]
[1,]    5    7
[2,]    6    8</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>$보호자
[1] "영희"

$아이_수
[1] 3

$아이_나이
[1] 4 7 9

$아이_이름
[1] "수동" "길동" "신혜"</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>   키 무게
1 174   72
2 182   74
3 167   65
4 164   62
5 161   59</code></pre>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>위의 0.8717538에서 대체 [4]인 것을 어떻게 알았는가? 하는 생각이 들겠지요. 환경 패널의 result 리스트를 펼쳐서 네 번째 요소에 r이 들었다는 걸 (estimate 와 cor을) 찾으면 됩니다.</p>
</div>
</div>
<p>산포도를 그려보는 게 관계를 아는 데 도움이됩니다. iris 데이터에는 품종 Species 변수도 있으므로 산포도에서 세 품종의 빛깔을 달리해서 품종에 따라 관계가 다른지 눈으로 확인해 봅시다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Sepal.Length =꽃받침.길이, Petal.Length=꽃잎.길이, Species=품종</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(Sepal.Length, Petal.Length, <span class="at">colour =</span> Species)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ggp-iris-r-color" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-regression_files/figure-html/fig-ggp-iris-r-color-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.2: <strong>?(caption)</strong></figcaption>
</figure>
</div>
</div>
</div>
<p>변수가 여럿일 때 pairs 함수가 관계를 예측하는 데 도움이 됩니다.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">col =</span> iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pairs-iris" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-regression_files/figure-html/fig-pairs-iris-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.3: iris 데이터의 산포도 행렬</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="편상관계수" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="편상관계수"><span class="header-section-number">12.2</span> 편상관계수</h2>
<p><strong>편상관계수</strong> partial correlation coeffiencient 는 두 확률변수의 상관관계를 계산할 때 두 변수에 모두 작용하는 제3의 변수가 있다면 왜곡된 상관계수를 산출할 수 있습니다. 이때 제3의 변수를 <strong>교란변수</strong> confounding variable 라고 합니다. 즉 교란변수가 양쪽 두 변수에 허위상관관계를 만들어서 실제 관계 정도와 달라질 수 있는 것이죠. 이럴 때 교란변수의 영향을 제거한 뒤에 계산한 상관계수를 말합니다. 영향을 통제(제거)하려는 제3의 변수를 <strong>통제변수</strong> control variable 라고 합니다.</p>
<p>예를 들면, 대학생들이 대학 교육의 결과로 소통 능력이 향상한다는 가설이 있다고 합시다. 가설을 검정하려고 학년(재학 기간)과 소통능력의 상관계수를 산출합니다. 그런데 나이가 늘수록 사회경험이 증가하니까, 나이도 소통능력의 향상에 영향을 미친다고 볼 수 있습니다. 그리고 학년이 올라갈수록 나이도 한 살씩 늘어갑니다. 따라서 소통능력의 향상에 미치는 나이의 영향을 통제해야만 순수하게 대학 교육의 효과를 측정할 수 있습니다. 이럴 때 학년과 소통능력의 상관계수에서 나이가 미치는 영향을 통제(제외)하고 계산한 상관계수가 편상관계수입니다.</p>
<p><span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span>의 상관계수에서 교란변수 <span class="math inline">\(Z\)</span>의 영향을 제외한 편상관계수 <span class="math inline">\(\rho _{XY\cdot Z}\)</span> 는 <span class="math inline">\(\epsilon_X\)</span>와 <span class="math inline">\(\epsilon_Y\)</span>의 상관계수와 동일합니다. <span class="math inline">\(\epsilon_X\)</span>는 <span class="math inline">\(Z\)</span>로 <span class="math inline">\(X\)</span>를 설명하고 남은 잔차이고 <span class="math inline">\(\epsilon_Y\)</span> 는 <span class="math inline">\(Z\)</span>로 <span class="math inline">\(Y\)</span>를 설명하고 남은 잔차입니다. 이것은 <span class="math inline">\(X=\alpha Z+\epsilon_X\)</span> 와 <span class="math inline">\(Y=\beta Z+\epsilon_Y\)</span>의 공식으로 표현합니다. 잔차의 개념은 바로 뒤의 회귀분석에서 자세히 나옵니다. 그래서 <span class="math inline">\(\rho _{XY\cdot Z} = Corr(\epsilon_X, \epsilon_Y)\)</span> 가 되고 이걸 풀어내면 나오는 아래의 공식을 편상관계수를 산출하는 데 사용합니다.</p>
<p><span class="math display">\[\rho_{XY \cdot Z} =\frac {\rho_{XY}-\rho_{XZ} \rho_{ZY}}{\sqrt {1-\rho _{XZ}^{2}} \sqrt {1-\rho_{ZY}^{2}}} \]</span></p>
<p>아래 <a href="#fig-partial-corr">Figure&nbsp;<span>12.4</span></a> 을 봅니다. 변수X와 변수Y 사이에 직접경로와 간접경로가 모두 존재한다고 가정하면 X와 Y의 상관관계는 그 둘을 모두 합친 것입니다. 따라서 상관계수 <span class="math inline">\(\rho_{XY}\)</span>는 직접경로 X<span class="math inline">\(\rightarrow\)</span>Y와 간접경로 X<span class="math inline">\(\rightarrow\)</span>Z<span class="math inline">\(\rightarrow\)</span>Y를 합친 것입니다. 편상관계수 <span class="math inline">\(\rho_{XY \cdot Z}\)</span>는 간접경로 X<span class="math inline">\(\rightarrow\)</span>Z<span class="math inline">\(\rightarrow\)</span>Y를 제외하고 직접경로 X<span class="math inline">\(\rightarrow\)</span>Y만을 계산한 것입니다.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-partial-corr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/partial-corr.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.4: X와 Y의 관계 경로와 편상관계수</figcaption>
</figure>
</div>
</div>
</div>
<p>편상관계수는 <code>ppcor</code> 패키지를 설치하고 <code>pcor()</code> 함수를 사용하여 계산합니다.</p>
</section>
<section id="공분산" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="공분산"><span class="header-section-number">12.3</span> 공분산</h2>
<p>확률변수 X와 확률변수 Y의 선형 연관성은 <strong>공분산</strong> covariance 으로 측정이 가능합니다.</p>
<p><span class="math display">\[ Cov(X,Y) = E[(X-\mu_X)(Y-\mu_Y)] = \frac{1}{N} \sum_{i=1}^{N}(X-\mu_X)(Y-\mu_Y)\]</span></p>
<p>공분산은 아래의 속성을 갖습니다.</p>
<ul>
<li>공분산이 양이면 두 변수는 같은 방향으로 증감한다.</li>
<li>공분산이 음이면 두 변수는 반대 방향으로 증감한다.</li>
<li>공분산이 0에 가까우면 선형적 상관관계가 작다.</li>
</ul>
</section>
<section id="단순회귀분석" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="단순회귀분석"><span class="header-section-number">12.4</span> 단순회귀분석</h2>
<p><strong>회귀분석</strong> regression analysis 은 종속변수와 독립변수 사이의 관계를 추정하는 통계적 과정을 말합니다. 회귀분석에서 종속변수는 오직 한 개이며 결과 또는 반응 변수라고도 합니다. 독립변수는 하나 또는 여러 개일 수도 있으며 예측 또는 설명 변수라고도 불립니다. 독립변수가 하나면 <strong>단순회귀분석</strong> simple regression analysis 이고 여러 개이면 <strong>다중회귀분석</strong> multiple regression analysis 입니다. 여기서는 <strong>선형 회귀분석</strong> linear regression 을 다루는데 그 중에서도 <strong>최소제곱법</strong> least square method 을 이용해서 모수 추정을 하는 기법을 배웁니다.</p>
<section id="단순회귀계수-산출" class="level3" data-number="12.4.1">
<h3 data-number="12.4.1" class="anchored" data-anchor-id="단순회귀계수-산출"><span class="header-section-number">12.4.1</span> 단순회귀계수 산출</h3>
<p>회귀분석은 <strong>선형 회귀모형</strong> linear regression model 을 만드는데, 두 가지 핵심 목적을 가집니다. 하나는 독립변수를 이용하여 종속변수를 예측하는 것이고 둘째 것은 독립변수가 종속변수에 영향을 준다는 인과관계를 검정하려는 것입니다. 인과관계의 검정은 회귀분석만으로는 검정이 안 되고 문헌조사를 통한 논리적인 근거를 연구자가 따로 제공해야 합니다.</p>
<p>단순회귀분석 모형은 아래와 같은 식으로 나타낼 수 있습니다.</p>
<p><span class="math display">\[ {\displaystyle Y_{i}=\beta _{0}+\beta _{1}X_{i}+\epsilon_{i}} \; , \; \epsilon \sim N(0,\sigma^2) \]</span></p>
<p>여기서 <span class="math inline">\(\beta _{0}\)</span>와 <span class="math inline">\(\beta_{1}\)</span>은 아직 모르는 모수(모 회귀계수)이고 <span class="math inline">\(x_{i}\)</span>는 독립변수, <span class="math inline">\(Y_{i}\)</span>는 종속변수입니다. <span class="math inline">\(e_{i}\)</span>는 <strong>오차항</strong> error term 이라고 하며 독립변수에 의해 설명되지 않는 종속변수의 잔여 부분을 말합니다. 오차항은 정규분포를 하는 확률변수입니다. <span class="math inline">\(\beta _{0}\)</span>와 <span class="math inline">\(\beta_{1}\)</span>은 회귀계수를 밑첨자 숫자로 구분했지만, 절편은 <span class="math inline">\(\alpha\)</span>로 기울기는 <span class="math inline">\(\beta\)</span>로 통상 문자를 달리해서 표시하는 방법을 사용합니다.</p>
<p>이러한 회귀모형을 만들려면 가정이 여러 개 필요합니다.</p>
<ul>
<li>잔차 <span class="math inline">\(\epsilon\)</span>는 평균이 0 인 정규분포를 따른다</li>
<li>잔차는 서로 독립적이다</li>
<li>잔차 <span class="math inline">\(\epsilon\)</span>는 모든 <span class="math inline">\(X\)</span> 값에서 동일한 분산을 갖는다</li>
<li>독립변수 <span class="math inline">\(X\)</span>는 측정오차가 없다</li>
</ul>
<p>추정값를 넣어서 회귀직선 방정식을 만들면 아래와 같습니다.</p>
<p><span class="math display">\[\displaystyle {\hat {Y}}_{i}={\hat {\beta }}_{0}+{\hat {\beta }}_{1}X_{i} \]</span></p>
<p><span class="math inline">\(Y\)</span>의 예측값과 관찰값의 차이가 <strong>잔차</strong> residual 또는 error 인데, 잔차 제곱의 합을 최소로 만드는 최소제곱법에 의해서 회귀계수를 구해야 합니다.</p>
<p>잔차는 표본에서 나타난 실제값이고 이론적 회귀모형 모델에서는 오차항입니다. 이때는 모델의 설명력 밖에 있는 (아직 밝혀지지 않은 다른) 요인들을 나타내는 통계적인 개념입니다.</p>
<p><span class="math display">\[ \sum_{i=1}^{n} (y_i-\hat y_i)^2 =  \sum_{i=1}^{n}\epsilon_i^2 = \sum_{i=1}^{n}(y_i-\hat \beta_0 - \hat \beta_1 x_i)^2 \]</span></p>
<p><span class="math inline">\(\beta_0\)</span>와 <span class="math inline">\(\beta_1\)</span>의 추정량인 <span class="math inline">\(\hat \beta_0\)</span>와 <span class="math inline">\(\hat \beta_1\)</span>을 구하는 공식은 아래와 같습니다. 위의 식인 2차방정식을 최소로 만드는 값은 미분해서 0 인 값이므로 아래 식을 만들 수 있습니다.</p>
<p><span class="math display">\[\displaystyle \hat \beta_1 = \frac{\sum_{i=1}^{n}(x_i-\bar x)(y_i-\bar y)}{\sum_{i=1}^{n}(x_i-\bar x)^2} = \frac{\sum_{i=1}^{n}x_i y_i-n \bar x \bar y}{\sum_{i=1}^{n}x_i^2-n\bar x^2} \; , \; \; \hat \beta_0 = \bar y-\hat \beta_1 \bar x\]</span></p>
<p>위의 값에서 산출한 회귀직선의 방정식은;</p>
<p><span class="math display">\[\displaystyle {\hat {Y}}_{i}={\hat {\beta }}_{0}+{\hat {\beta }}_{1}X_{i} \]</span></p>
<p>독립변수와 종속변수를 모두 <span class="math inline">\(z\)</span>로 표준화해서 단순회귀분석을 하면 단순회귀계수 <span class="math inline">\(\beta\)</span>는 두 변수의 피어슨 상관계수와 동일한 값을 갖습니다.</p>
</section>
<section id="anscombes-quartet" class="level3" data-number="12.4.2">
<h3 data-number="12.4.2" class="anchored" data-anchor-id="anscombes-quartet"><span class="header-section-number">12.4.2</span> Anscombe’s quartet</h3>
<p>1973년 통계학자 안스콤이 만든 데이타셋 4개. 동일한 기술 통계를 가지고 아주 비슷한 회귀직선을 갖지만 명백하게 다른 분포를 지닙니다. 단지 통계 결과만이 아니라 시각적 분포를 살펴야 한다는 점을 보여줍니다. 극단값을 주목해야 한다는 점도 있고요. 아래는 4개의 데이터셋이 동일한 속성을 가진 것을 보여주는데 특히 회귀식이 같다는 점을 주목해 주세요.</p>
<div id="tbl-sec-reg-ins1" class="anchored">
<table class="table">
<caption>Table&nbsp;12.1: 안스콤이 만든 네 쌍의 데이터</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">x1</th>
<th style="text-align: center;">y1</th>
<th style="text-align: center;">|</th>
<th style="text-align: center;">x2</th>
<th style="text-align: center;">y2</th>
<th style="text-align: center;">|</th>
<th style="text-align: center;">x3</th>
<th style="text-align: center;">y3</th>
<th style="text-align: center;">|</th>
<th style="text-align: center;">x4</th>
<th style="text-align: center;">y4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">10.0</td>
<td style="text-align: center;">8.04</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">10.0</td>
<td style="text-align: center;">9.14</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">10.0</td>
<td style="text-align: center;">7.46</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">6.58</td>
</tr>
<tr class="even">
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">6.95</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">8.14</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">6.77</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">5.76</td>
</tr>
<tr class="odd">
<td style="text-align: center;">13.0</td>
<td style="text-align: center;">7.58</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">13.0</td>
<td style="text-align: center;">8.74</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">13.0</td>
<td style="text-align: center;">12.74</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">7.71</td>
</tr>
<tr class="even">
<td style="text-align: center;">9.0</td>
<td style="text-align: center;">8.81</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">9.0</td>
<td style="text-align: center;">8.77</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">9.0</td>
<td style="text-align: center;">7.11</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">8.84</td>
</tr>
<tr class="odd">
<td style="text-align: center;">11.0</td>
<td style="text-align: center;">8.33</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">11.0</td>
<td style="text-align: center;">9.26</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">11.0</td>
<td style="text-align: center;">7.81</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">8.47</td>
</tr>
<tr class="even">
<td style="text-align: center;">14.0</td>
<td style="text-align: center;">9.96</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">14.0</td>
<td style="text-align: center;">8.10</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">14.0</td>
<td style="text-align: center;">8.84</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">7.04</td>
</tr>
<tr class="odd">
<td style="text-align: center;">6.0</td>
<td style="text-align: center;">7.24</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">6.0</td>
<td style="text-align: center;">6.13</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">6.0</td>
<td style="text-align: center;">6.08</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">5.25</td>
</tr>
<tr class="even">
<td style="text-align: center;">4.0</td>
<td style="text-align: center;">4.26</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">4.0</td>
<td style="text-align: center;">3.10</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">4.0</td>
<td style="text-align: center;">5.39</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">19.0</td>
<td style="text-align: center;">12.50</td>
</tr>
<tr class="odd">
<td style="text-align: center;">12.0</td>
<td style="text-align: center;">10.84</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">12.0</td>
<td style="text-align: center;">9.13</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">12.0</td>
<td style="text-align: center;">8.15</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">5.56</td>
</tr>
<tr class="even">
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">4.82</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">7.26</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">7.0</td>
<td style="text-align: center;">6.42</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">7.91</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">5.68</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">4.74</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">5.73</td>
<td style="text-align: center;">|</td>
<td style="text-align: center;">8.0</td>
<td style="text-align: center;">6.89</td>
</tr>
</tbody>
</table>
</div>
<p>아래는 안스콤의 데이터 네 쌍이 가진 거의 동일한 기술 통계를 표로 나타낸 것입니다. 완전히 일치하거나 적어도 소숫점 둘째 자리까지 동일할 정도로 유사합니다.</p>
<div id="tbl-sec-reg-ins2" class="anchored">
<table class="table">
<caption>Table&nbsp;12.2: 안스콤 4 쌍의 유사한 기술 통계 (평균, 분산, 상관계수, 회귀식)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">속성</th>
<th style="text-align: left;">값</th>
<th style="text-align: left;">정확도</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x의 평균</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">일치</td>
</tr>
<tr class="even">
<td style="text-align: left;">x의 분산 <span class="math inline">\(s_x^2\)</span></td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">일치</td>
</tr>
<tr class="odd">
<td style="text-align: left;">y의 평균</td>
<td style="text-align: left;">7.50</td>
<td style="text-align: left;">소수점 2자리까지</td>
</tr>
<tr class="even">
<td style="text-align: left;">y의 분산 <span class="math inline">\(s_y^2\)</span></td>
<td style="text-align: left;">4.125</td>
<td style="text-align: left;"><span class="math inline">\(\pm 0.003\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">x와 Y의 상관계수</td>
<td style="text-align: left;">0.816</td>
<td style="text-align: left;">소수점 3자리까지</td>
</tr>
<tr class="even">
<td style="text-align: left;">회귀식</td>
<td style="text-align: left;">y=3.00+0.500x</td>
<td style="text-align: left;">각 소수점 2와 3자리까지</td>
</tr>
<tr class="odd">
<td style="text-align: left;">회귀직선 <span class="math inline">\(R^2\)</span></td>
<td style="text-align: left;">0.67</td>
<td style="text-align: left;">소수점 2자리까지</td>
</tr>
</tbody>
</table>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span>) <span class="co"># 그래프 영역을 2x2로 분할, 여백과 크기를 조정</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"anscombe"</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for 루프로 그래프 4번 반복 생산</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {     </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot</span>(anscombe[,i], anscombe[,i<span class="sc">+</span><span class="dv">4</span>], <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">20</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">14</span>), <span class="at">ylab =</span><span class="fu">paste0</span>(<span class="st">"y"</span>, i))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">abline</span>(<span class="at">a=</span><span class="dv">3</span>, <span class="at">b=</span><span class="fl">0.5</span>, <span class="at">col=</span><span class="st">"red"</span>)  <span class="co"># 그래프에 선 넣기</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-anscombe-graph" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-regression_files/figure-html/fig-anscombe-graph-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.5: 안스콤의 네 쌍 데이터가 만든 각 산포도의 비교</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="단순회귀모형-적합성-검정" class="level3" data-number="12.4.3">
<h3 data-number="12.4.3" class="anchored" data-anchor-id="단순회귀모형-적합성-검정"><span class="header-section-number">12.4.3</span> 단순회귀모형 적합성 검정</h3>
<p>적합도 검정(goodness-of-fit test)은 계수를 구해 도출한 회귀식 <span class="math inline">\(Y = \beta_0 + \beta_1 X\)</span>이 표본의 실제값을 얼마나 잘 설명하는지를 확인하는 방법입니다. 추정한 회귀식의 설명력에 대한 척도를 <span class="math inline">\(R^2\)</span>(회귀선의 설명력, <strong>결정계수</strong>)으로 표현합니다.</p>
<p><span class="math inline">\(R^2\)</span>(결정계수) = <span class="math inline">\(\frac{SSR}{SST}\)</span> = <span class="math inline">\(\frac{회귀식으로 \; 설명된 \; 변동}{총변동}\)</span></p>
<p><span class="math inline">\(Y_i\)</span>는 실제 관찰값이고 <span class="math inline">\(\hat{Y_i}\)</span>는 그에 대응하는 회귀선이 예측한 값이고, <span class="math inline">\(\bar{Y}\)</span>는 <span class="math inline">\(Y\)</span> 관찰값의 평균입니다.</p>
<table class="table">
<caption>적합도 검정을 위한 <span class="math inline">\(R^2\)</span> 값</caption>
<thead>
<tr class="header">
<th style="text-align: center;">변동</th>
<th style="text-align: center;">계산</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">관찰한 모든 변동: 총제곱합(SST)</td>
<td style="text-align: center;"><span class="math inline">\(\sum{(Y_i-\bar{Y})^2}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">설명한 변동: 회귀제곱합(SSR)</td>
<td style="text-align: center;"><span class="math inline">\(\sum{(\hat{Y}_i-\bar{Y})^2}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">설명 못한 변동: 잔차 제곱합(SSE)</td>
<td style="text-align: center;"><span class="math inline">\(\sum{(Y_i-\hat{Y}_i)^2}\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(SST = SSE + SSR \rightarrow \frac{SSR}{SST}=1-\frac{SSE}{SST}=R^2\)</span></p>
<div id="fig-exp-var-rear" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/explained-variance-regr.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;12.6: 설명한 변동</figcaption>
</figure>
</div>
</section>
<section id="분산분석표" class="level3" data-number="12.4.4">
<h3 data-number="12.4.4" class="anchored" data-anchor-id="분산분석표"><span class="header-section-number">12.4.4</span> 분산분석표</h3>
<p><strong>분산분석표</strong> analysis of variance table 는 제곱합 <span class="math inline">\(SS\)</span>; sum of squares 과 자유도, 제곱평균<span class="math inline">\(MS\)</span>; mean square, <span class="math inline">\(F\)</span>값 등을 표로 나타낸 것입니다. 각 요소들의 관계를 한 눈에 살필 수 있습니다.</p>
<div id="tbl-sec-reg-anv-tbl1" class="anchored">
<table class="table">
<caption>Table&nbsp;12.3: 단순회귀 분산분석표</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">요인</th>
<th style="text-align: center;">자유도</th>
<th style="text-align: center;">제곱합</th>
<th style="text-align: center;">제곱평균</th>
<th style="text-align: center;"><span class="math inline">\(F\)</span></th>
<th style="text-align: center;"><span class="math inline">\(p\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">회귀</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(SSR=\sum(\hat Y_i-\bar Y)^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MSR=\frac{SSR}{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{MSR}{MSE}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">잔차</td>
<td style="text-align: center;"><span class="math inline">\(n-2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SSE=\sum(Y_i-\hat Y_i)^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MSE=\frac{SSE}{n-2}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">계</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SST=\sum(Y_i-\bar Y)^2\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<p><span class="math inline">\(MSE\)</span>는 오차 분산 <span class="math inline">\(\sigma_{\epsilon}^{2}\)</span> 의 불편 추정량 unbiased estimator 입니다.</p>
<p>여기서 나오는 <span class="math inline">\(F\)</span>값과 그에 대응하는 <span class="math inline">\(p\)</span>값은 회귀모형의 유의성 검정에 사용합니다.</p>
</section>
<section id="단순회귀모형의-유의성-검토" class="level3" data-number="12.4.5">
<h3 data-number="12.4.5" class="anchored" data-anchor-id="단순회귀모형의-유의성-검토"><span class="header-section-number">12.4.5</span> 단순회귀모형의 유의성 검토</h3>
<p>회귀모형의 유의성은 독립변수 <span class="math inline">\(X\)</span>가 종속변수 <span class="math inline">\(Y\)</span>에 정말로 영향을 미치는지 검정하는 겁니다. 유의성을 검토하는 절차는 아래와 같습니다.</p>
<ol type="1">
<li>가설을 세운다 <br> <span class="math inline">\(H_0: \beta = 0\)</span> <br> <span class="math inline">\(H_A: \beta \ne 0\)</span> <br></li>
<li>유의수준을 결정한다</li>
<li>검정통계량을 계산한다 <span class="math display">\[ F_0= \frac{MSR}{MSE} \gt F_{\alpha , (1,n-2)} \]</span></li>
<li>임곗값과 비교하여 결정한다</li>
</ol>
</section>
<section id="단순회귀-추정의-표준오차" class="level3" data-number="12.4.6">
<h3 data-number="12.4.6" class="anchored" data-anchor-id="단순회귀-추정의-표준오차"><span class="header-section-number">12.4.6</span> 단순회귀 추정의 표준오차</h3>
<p>잔차가 적을수록 독립변수 <span class="math inline">\(X\)</span>가 종속변수 <span class="math inline">\(Y\)</span>를 잘 설명하는 것이므로 잔차의 표준편차를 <strong>추정의 표준오차</strong>라고도 부릅니다. 계산 공식은 아래와 같습니다.</p>
<p><span class="math display">\[ s = \sqrt{\frac{\sum(Y_i-\hat Y_i)^2}{n-2}} = \sqrt{\frac{\sum e_i^2}{n-2}} = \sqrt{\frac{SSE}{n-2}} = \sqrt{MSE} \]</span></p>
<p>추정의 표준오차가 적을수록 회귀식이 잘 작동하는 것이지만 <span class="math inline">\(s\)</span>는 표준화가 되지 않아서 <span class="math inline">\(Y\)</span> 단위에 따라 달라져서 다른 회귀분석과 비교하기 어려운 단점이 있습니다. 그래서 결정계수를 이용합니다.</p>
</section>
<section id="결정계수" class="level3" data-number="12.4.7">
<h3 data-number="12.4.7" class="anchored" data-anchor-id="결정계수"><span class="header-section-number">12.4.7</span> 결정계수</h3>
<p><strong>결정계수</strong> coefficient of determination 는 총제곱합 <span class="math inline">\(SST\)</span> 중에서 회귀직선이 설명하는 제곱합 <span class="math inline">\(SSR\)</span>의 비율로 나타냅니다. 실제로는 계산하기 편하게 <span class="math inline">\(SSE\)</span>를 이용하여 산출합니다. 결정계수는 회귀 모델이 변동을 얼마나 설명하는지에 대한 설명력을 나타냅니다.</p>
<p><span class="math display">\[ R^2=\frac{SSR}{SST} = 1 - \frac{SSE}{SST}   \]</span></p>
</section>
<section id="회귀계수의-신뢰구간" class="level3" data-number="12.4.8">
<h3 data-number="12.4.8" class="anchored" data-anchor-id="회귀계수의-신뢰구간"><span class="header-section-number">12.4.8</span> 회귀계수의 신뢰구간</h3>
<section id="beta의-신뢰구간-추정" class="level4" data-number="12.4.8.1">
<h4 data-number="12.4.8.1" class="anchored" data-anchor-id="beta의-신뢰구간-추정"><span class="header-section-number">12.4.8.1</span> <span class="math inline">\(\beta\)</span>의 신뢰구간 추정</h4>
<p>회귀계수 <span class="math inline">\(\beta\)</span>의 표집분포는 <span class="math inline">\(n-2\)</span>의 자유도와 표준오차 <span class="math inline">\(S_b\)</span>를 가진 <span class="math inline">\(t\)</span> 분포를 따르므로 그 신뢰구간은 아래와 같습니다. 이것은 앞서 배운 평균의 신뢰구간과 오차범위 계산 방법이 동일합니다.</p>
<p><span class="math display">\[ b-t_{n-2,\alpha / 2} S_b \le \beta \le b + t_{n-2,\alpha / 2} S_b\]</span></p>
<p>여기서</p>
<p><span class="math display">\[ S_b = \sqrt{\frac{MSE}{\sum(X_i-\bar X)^2}} \; ,  \; \; \; MSE = \frac{\sum(Y_i-\hat{Y}_i)^2}{n-2}   \]</span></p>
</section>
<section id="alpha의-신뢰구간-추정" class="level4" data-number="12.4.8.2">
<h4 data-number="12.4.8.2" class="anchored" data-anchor-id="alpha의-신뢰구간-추정"><span class="header-section-number">12.4.8.2</span> <span class="math inline">\(\alpha\)</span>의 신뢰구간 추정</h4>
<p>회귀직선의 절편인 <span class="math inline">\(\alpha\)</span>는 잘 사용하지 않지만 <span class="math inline">\(\beta\)</span>가 0인 경우에 가끔 추정하기도 합니다. <span class="math inline">\(\alpha\)</span>의 점추정량 <span class="math inline">\(a\)</span>는</p>
<p><span class="math display">\[  a = \bar Y - b \bar X  \]</span> <span class="math inline">\(a\)</span>의 표집분포는 정규분포를 하며 기대값과 분산은 아래와 같습니다.</p>
<p><span class="math display">\[ E(a)=\alpha \; , \; \;    S_a = \sqrt{MSE \frac{\sum X_i^2}{n \sum(X_i-\bar X)^2}} \; ,  \; \; \; MSE = \frac{\sum(Y_i-\hat{Y}_i)^2}{n-2}     \]</span></p>
<p>그래서 <span class="math inline">\(\alpha\)</span>의 신뢰구간은</p>
<p><span class="math display">\[ a-t_{n-2,\alpha / 2} S_a \le \alpha \le a + t_{n-2,\alpha / 2} S_a \]</span></p>
</section>
<section id="ehat-y_h의-신뢰구간-추정" class="level4" data-number="12.4.8.3">
<h4 data-number="12.4.8.3" class="anchored" data-anchor-id="ehat-y_h의-신뢰구간-추정"><span class="header-section-number">12.4.8.3</span> <span class="math inline">\(E(\hat Y_h)\)</span>의 신뢰구간 추정</h4>
<p><span class="math inline">\(X_h\)</span>로 예측하는 <span class="math inline">\(Y\)</span> 값의 평균을 <span class="math inline">\(E(\hat Y_h)\)</span>라고 할 때 <span class="math inline">\(\hat Y_h\)</span>는 그것의 점추정량입니다.</p>
<p><span class="math display">\[ \hat Y_h = a+bX_h \]</span></p>
<p><span class="math inline">\(\hat Y_h\)</span>의 표집분포는 정규분포이며 기대값과 분산은 아래와 같습니다.</p>
<p><span class="math display">\[ E(\hat Y_h)= E(Y_h)\; , \; \; \sigma_{\hat Y_h}^2 =  \sigma^2 \left( \frac{1}{n}+\frac{(X_h-\bar X)^2}{\sum_{i=1}^{n} (X_i-\bar X)^2} \right) \]</span></p>
<p>우리는 <span class="math inline">\(\sigma^2\)</span>를 모르는 경우가 많으므로 <span class="math inline">\(\hat Y_h\)</span> 분산의 추정치인 <span class="math inline">\(S_{\hat Y_h}^2\)</span>를 대신 사용합니다.</p>
<p><span class="math display">\[ S_{\hat Y_h}^2 =  MSE \left( \frac{1}{n}+\frac{(X_h-\bar X)^2}{\sum_{i=1}^{n} (X_i-\bar X)^2} \right) \]</span></p>
<p>따라서 신뢰구간은</p>
<p><span class="math display">\[ \hat Y_h-t_{n-2,\alpha / 2} S_{\hat Y_h} \le E(\hat Y_h) \le \hat Y_h + t_{n-2,\alpha / 2} S_{\hat Y_h} \]</span></p>
</section>
</section>
</section>
<section id="단순회귀모형의-검토" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="단순회귀모형의-검토"><span class="header-section-number">12.5</span> 단순회귀모형의 검토</h2>
<section id="잔차의-검토" class="level3" data-number="12.5.1">
<h3 data-number="12.5.1" class="anchored" data-anchor-id="잔차의-검토"><span class="header-section-number">12.5.1</span> 잔차의 검토</h3>
<p>회귀모형에서는 오차항에 대한 가정이 여럿입니다. 선형성, 정규성, 독립성, 등분산성 등인데 이것을 충족하는지 잔차를 통해서 검토합니다. 잔차는 통상 표준화를 해서 검토하는데 표준화한 잔차를 영어로는 studentized residuals 라고 합니다. 아래의 <span class="math inline">\(d_i\)</span>가 표준화한 잔차입니다.</p>
<p><span class="math display">\[ d_i = \frac{e_i}{\sqrt{MSE}} \]</span></p>
</section>
<section id="선형성-검토" class="level3" data-number="12.5.2">
<h3 data-number="12.5.2" class="anchored" data-anchor-id="선형성-검토"><span class="header-section-number">12.5.2</span> 선형성 검토</h3>
<p><span class="math inline">\(x\)</span>에 대해서 산점도를 그렸을 때 0을 중심으로 무작위하게 나타나야 합니다. 아래의 잔차 산포도는 잔차가 0을 중심으로 고루 분포되어 있습니다.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">301</span>)   <span class="co"># 0부터 1까지 501개 등간 숫자 생성</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">301</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.3</span>)                <span class="co"># 평균 0, 표준편차 0.3인 정규분포 난수를 501개 생성</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 그림 주위의 여백 조정. par; parameter. mar; margin (상, 우, 하, 좌)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.03</span>, <span class="fl">1.02</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.1</span>, <span class="fl">2.1</span>), <span class="at">axes=</span>F, <span class="at">xlab =</span> <span class="st">""</span>,  <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># pch; point character. 20; 꽉차고 작은 둥근 점. axes=F; 축 눈금이 없다</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">v=</span><span class="sc">-</span><span class="fl">0.04</span>, <span class="at">col =</span> <span class="st">"black"</span>)  <span class="co"># y 축을 대신할 선을 그린다. v; vertical line. (h는 수평선)</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.05</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="st">"x"</span>)                <span class="co"># 그래프 안에 좌표로 텍스트를 넣을 위치를 표시</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="fl">1.1</span>, <span class="st">"e"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="st">"0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-resi-linear-test1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-regression_files/figure-html/fig-resi-linear-test1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.7: 잔차의 선형성 검토</figcaption>
</figure>
</div>
</div>
</div>
<p>위의 그래프는 잔차만을 그린 것이지만 원래 그래프 상에서 그대로 나타내면 아래와 같습니다. 윗그림과 잔차는 동일합니다.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">301</span>)   <span class="co"># 0부터 1까지 501개 등간 숫자 생성</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">301</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.3</span>)                <span class="co"># 평균 0, 표준편차 0.3인 정규분포 난수를 501개 생성</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span>y       <span class="co"># y=1+3*x+y  맨뒤 y는 잔차</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 그림 주위의 여백 조정. par; parameter. mar; margin (상, 우, 하, 좌)</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y1, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">axes=</span>F, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.03</span>, <span class="fl">1.02</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">xlab =</span> <span class="st">"x"</span>,  <span class="at">ylab =</span> <span class="st">"y"</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># pch; point character. 20; 꽉차고 작은 둥근 점. axes=F; 축 눈금이 없다</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">v=</span><span class="sc">-</span><span class="fl">0.04</span>, <span class="at">col =</span> <span class="st">"black"</span>)  <span class="co"># y 축을 대신할 선을 그린다. v; vertical line. (h는 수평선)</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">2</span>) </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.05</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="st">"x"</span>)                <span class="co"># 그래프 안에 좌표로 텍스트를 넣을 위치를 표시</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="fl">1.1</span>, <span class="st">"e"</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="st">"0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-resi-linear-test2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-regression_files/figure-html/fig-resi-linear-test2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.8: 잔차의 선형성 검토 (산포도)</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">301</span>)   <span class="co"># 0부터 1까지 501개 등간 숫자 생성</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">301</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.3</span>)                <span class="co"># 평균 0, 표준편차 0.3인 정규분포 난수를 501개 생성</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">2.3</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>x <span class="sc">+</span>y       <span class="co"># y=1+0.5*x+y  맨뒤 y는 잔차</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 그림 주위의 여백 조정. par; parameter. mar; margin (상, 우, 하, 좌)</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y1, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">axes=</span>F, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.03</span>, <span class="fl">1.02</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">6</span>), <span class="at">xlab =</span> <span class="st">"x"</span>,  <span class="at">ylab =</span> <span class="st">"y"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># pch; point character. 20; 꽉차고 작은 둥근 점. axes=F; 축 눈금이 없다</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">v=</span><span class="sc">-</span><span class="fl">0.04</span>, <span class="at">col =</span> <span class="st">"black"</span>)  <span class="co"># y 축을 대신할 선을 그린다. v; vertical line. (h는 수평선)</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fl">2.3</span>,<span class="dv">3</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">2</span>) </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, y, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">col=</span><span class="st">"purple"</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.05</span>, <span class="sc">-</span><span class="fl">0.15</span>, <span class="st">"x"</span>)                <span class="co"># 그래프 안에 좌표로 텍스트를 넣을 위치를 표시</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="fl">0.8</span>, <span class="st">"e"</span>, <span class="at">col=</span><span class="st">"purple"</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="st">"0"</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="dv">6</span>, <span class="st">"y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-resi-linear-test3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-regression_files/figure-html/fig-resi-linear-test3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.9: 잔차의 선형성 검토: 비교</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="정규성-검토" class="level3" data-number="12.5.3">
<h3 data-number="12.5.3" class="anchored" data-anchor-id="정규성-검토"><span class="header-section-number">12.5.3</span> 정규성 검토</h3>
<p>오차항의 분포가 정규분포를 이루어야 선형회귀 모형을 적용할 수 있습니다. <a href="#fig-resi-linear-test1">Figure&nbsp;<span>12.7</span></a> 처럼 x값에 따라 옆으로 퍼져 있는 잔차를 X에 상관하지 않고 잔차 자체의 크기 순서로 늘어놓으면, 빈도 분포가 아래처럼 정규분포와 유사한 형태를 이루어야 합니다. (높이를 해당 잔차의 빈도로 해석해주세요.)</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lx <span class="ot">&lt;-</span> <span class="dv">41</span>                        <span class="co"># x의 갯수 (간격)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out=</span>lx)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(s, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">2</span>)       </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>lx) {</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> p[i] <span class="sc">%/%</span> <span class="fl">0.02</span>  <span class="co"># 나눈 몫</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(x, <span class="fu">rep</span>(s[i], <span class="at">times=</span>k) )   <span class="co"># y 갯수만큼 x를 생성</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(y, <span class="fu">runif</span>(k)<span class="sc">*</span>p[i] )        <span class="co"># y를 상대도수 갯수만큼 랜덤하게 생성</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){        <span class="co"># x 값을 좌우로 약간씩 변형해서 그래프를 보기 좋게</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> x[i] <span class="sc">+</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">*</span><span class="fl">0.1</span>   <span class="co"># runif(1) ; 0과 1 사이의 숫자를 1개 생성</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 그림 주위의 여백 조정. par; parameter. mar; margin (상, 우, 하, 좌)</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (x,y, <span class="at">pch=</span><span class="dv">20</span>, <span class="at">axes=</span>F, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.007</span>, <span class="fl">0.2</span>), <span class="at">xlab =</span> <span class="st">""</span>,  <span class="at">ylab =</span> <span class="st">""</span>)    <span class="co"># axes=F; 축 없애기</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span> (<span class="dv">0</span>,<span class="dv">0</span>)                    <span class="co"># x 축 그리기</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(s,p,<span class="at">type=</span><span class="st">"l"</span>)             <span class="co"># 정규분포 곡선 넣기</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">4</span>, <span class="sc">-</span><span class="fl">0.005</span>, <span class="st">"e"</span>)           <span class="co"># 그래프 안에 좌표로 텍스트를 넣을 위치를 표시</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.005</span>, <span class="st">"0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-resi-normal-test" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-regression_files/figure-html/fig-resi-normal-test-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.10: 잔차의 정규성 검토</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="등분산성-검토" class="level3" data-number="12.5.4">
<h3 data-number="12.5.4" class="anchored" data-anchor-id="등분산성-검토"><span class="header-section-number">12.5.4</span> 등분산성 검토</h3>
<p>잔차는 <span class="math inline">\(\hat Y_i\)</span>에 대해서 <span class="math inline">\(\epsilon_i\)</span>의 분포가 동일한 분산을 가져야 한다는 가정을 충족해야 합니다.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">+</span> <span class="dv">1</span>) <span class="co"># 그래프 영역을 1x2로 분할, 여백과 크기를 조정</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>)   <span class="co"># 0부터 1까지 101개 등간 숫자 생성</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">101</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.3</span>)              <span class="co"># 평균 0, 표준편차 0.3인 정규분포 난수를 501개 생성</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 그림 주위의 여백 조정. par; parameter. mar; margin (상, 우, 하, 좌)</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.04</span>, <span class="fl">1.02</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>), <span class="at">axes=</span>F, <span class="at">xlab =</span> <span class="st">""</span>,  <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># pch; point character. 20; 꽉차고 작은 둥근 점. axes=F; 축 눈금이 없다</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">v=</span><span class="sc">-</span><span class="fl">0.04</span>, <span class="at">col =</span> <span class="st">"black"</span>)  <span class="co"># y 축을 대신할 선을 그린다. v; vertical line. (h는 수평선)</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.05</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="st">"Y"</span>)                <span class="co"># 그래프 안에 좌표로 텍스트를 넣을 위치를 표시</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="fl">1.3</span>, <span class="st">"e"</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">h =</span> <span class="fl">0.6</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">h =</span> <span class="sc">-</span><span class="fl">0.6</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>)   <span class="co"># 0부터 1까지 501개 등간 숫자 생성</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">101</span>, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.3</span>)                <span class="co"># 평균 0, 표준편차 0.3인 정규분포 난수를 501개 생성</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="dv">101</span>) {</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  y1[i] <span class="ot">&lt;-</span> y1[i]<span class="sc">/</span><span class="dv">4</span> <span class="sc">+</span> y[i]<span class="sc">*</span>(i<span class="sc">/</span><span class="dv">50</span>)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 그림 주위의 여백 조정. par; parameter. mar; margin (상, 우, 하, 좌)</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, y1, <span class="at">type =</span> <span class="st">"p"</span>, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.04</span>, <span class="fl">1.02</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.3</span>, <span class="fl">1.3</span>), <span class="at">axes=</span>F, <span class="at">xlab =</span> <span class="st">""</span>,  <span class="at">ylab =</span> <span class="st">""</span>)</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a><span class="co"># pch; point character. 20; 꽉차고 작은 둥근 점. axes=F; 축 눈금이 없다</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">0</span>, <span class="at">v=</span><span class="sc">-</span><span class="fl">0.04</span>, <span class="at">col =</span> <span class="st">"black"</span>)  <span class="co"># y 축을 대신할 선을 그린다. v; vertical line. (h는 수평선)</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.05</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="st">"Y"</span>)                <span class="co"># 그래프 안에 좌표로 텍스트를 넣을 위치를 표시</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="fl">0.06</span>, <span class="fl">1.3</span>, <span class="st">"e"</span>)</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-resi-equal-var-test" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-regression_files/figure-html/fig-resi-equal-var-test-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.11: 잔차의 등분산성 검토</figcaption>
</figure>
</div>
</div>
</div>
<p>왼쪽은 <span class="math inline">\(\hat Y_i\)</span>에 대해서 <span class="math inline">\(e_i\)</span>가 등분산이지만, 오른쪽은 <span class="math inline">\(\hat Y_i\)</span>값이 커지면서 <span class="math inline">\(e_i\)</span>의 분산도 커지므로 등분산 가정을 충족하지 못합니다. 몸무게와 키의 관계를 회귀분석할 때, 몸무게가 클수록 키가 커지니까 오차의 분산도 증가하는 경향을 보이는데 그게 오른쪽 그래프의 경우와 유사합니다.</p>
</section>
<section id="독립성-검토" class="level3" data-number="12.5.5">
<h3 data-number="12.5.5" class="anchored" data-anchor-id="독립성-검토"><span class="header-section-number">12.5.5</span> 독립성 검토</h3>
<p>잔차들이 서로 독립적이어야 선형 회귀모델이 가능합니다. 무언가 서로 연관이 있어 보이는지 산포도로 확인해봅니다. 만일 잔차들이 <strong>자기상관</strong> autocorrelation 이 있다면, 즉 어떤 식으로든 서로 연관이 있다면 선형 회귀모델의 가정은 충족하지 않습니다.</p>
<p>잔차 <span class="math inline">\(e_i\)</span>가 있을 때, 자기 앞의 잔차가 그 전 것보다 증가했고 자신도 증가했는데 자기 뒤의 잔차도 증가한다면, 그건 자기상관성의 가능성이 있는 겁니다. 감소하는 경우도 마찬가지입니다. 그런 경우가 많다면 독립성의 가정은 성립하지 않고 따라서 선형 회귀분석을 사용하지 못합니다.</p>
<p>자기상관은 더빈-왓슨 Durbin-Watson 검정통계량 <span class="math inline">\(d\)</span>을 사용해서 검정할 수 있습니다.</p>
<p><span class="math display">\[ d=\frac{\sum_{t=2}^{n}(e_t-e_{t-1})^2}{\sum_{t=1}^{n} e_t^2}, \; \; e_t=y_t-\hat y_t  \]</span></p>
<p>더빈-왓슨의 <span class="math inline">\(d\)</span>는 0 부터 4 의 값을 가집니다. 2 보다 작으면 양의 자기상관이고, 2 보다 크면 음의 자기상관입니다. 2에 가까울수록 자기상관이 없습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DW 계수 계산</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> 데이터_이름)            <span class="co"># 회귀 모형</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> <span class="fu">residuals</span>(result)                   <span class="co"># 잔차 추출</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>dw_coefficient <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diff</span>(residuals)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>(residuals<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># DW 계수 계산</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>dw_coefficient</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.4 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>앞서 나왔던 옷가게 손님의 키와 무게의 상관계수 계산 데이터를 이용해서 단순회귀식을 계산해봅시다.</p>
</blockquote>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>키 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">162</span>, <span class="dv">158</span>, <span class="dv">160</span>, <span class="dv">168</span>, <span class="dv">150</span>, <span class="dv">154</span>, <span class="dv">160</span>, <span class="dv">166</span>, <span class="dv">170</span>, <span class="dv">146</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>무게 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">52</span>, <span class="dv">60</span>, <span class="dv">58</span>, <span class="dv">50</span>, <span class="dv">67</span>, <span class="dv">56</span>, <span class="dv">66</span>, <span class="dv">72</span>, <span class="dv">51</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(무게 <span class="sc">~</span> 키)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = 무게 ~ 키)

Coefficients:
(Intercept)           키  
   -37.0470       0.6007  </code></pre>
</div>
</div>
<p><strong>답:</strong> 회귀식: 무게 = -37.047 + 0.6 * 키 (<span class="math inline">\(\alpha=-37.047, \; \beta=0.6\)</span>)</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.5 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>mtcars 데이터셋을 사용하여 단순회귀분석을 해봅시다. 마력 hp가 연료효율 mpg에 주는 영향을 분석합니다.</p>
</blockquote>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>result.car <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> mtcars)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result.car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.7121 -2.1122 -0.8854  1.5819  8.2360 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 30.09886    1.63392  18.421  &lt; 2e-16 ***
hp          -0.06823    0.01012  -6.742 1.79e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.863 on 30 degrees of freedom
Multiple R-squared:  0.6024,    Adjusted R-squared:  0.5892 
F-statistic: 45.46 on 1 and 30 DF,  p-value: 1.788e-07</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 회귀계수의 출력 (y절편과 기울기)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (앞의 코드청크를 실행해서 result.car가 형성되어 있어야 한다)</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(result.car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          hp 
30.09886054 -0.06822828 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 산포도에 회귀선을 추가</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(hp, mpg)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(result.car)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(result.car)[<span class="dv">2</span>]),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-sim-lm-mtcars" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="linear-regression_files/figure-html/fig-sim-lm-mtcars-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;12.12: <strong>?(caption)</strong></figcaption>
</figure>
</div>
</div>
</div>
<p>위의 결과인 <code>result.car</code>를 바탕으로 앞에서 나온 것들의 값을 구한다면,</p>
<ul>
<li>회귀계수:
<ul>
<li>절편 = 30.09886, (p &lt; 0.000)</li>
<li>회귀계수 = -0.06823 (p &lt; 0.000)</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>Coefficients:</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>            Estimate   Std. Error  t value    Pr(&gt;|t|)    </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>(Intercept) 30.09886     1.63392    18.421    &lt; 2e-16 *** </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>hp          -0.06823     0.01012  -6.742     1.79e-07 ***</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>회귀계수: $\alpha=$ `r result.car$coefficients[1]`, $\beta=$ `r result.car$coefficients[[2]`</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>회귀계수의 신뢰구간
<ul>
<li>절편: 30.09886 <span class="math inline">\(\pm\)</span> 1.63392 * 18.421</li>
<li>회귀계수: -0.06823 <span class="math inline">\(\pm\)</span> -6.742 * 0.01012</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Std. Error   t value  </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>1.63392       18.421 </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>0.01012       -6.742 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>유의성 검토:
<ul>
<li>F = 45.46 (자유도 1, 30), p &lt; 0.000</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>F-statistic: 45.46 on 1 and 30 DF,  p-value: 1.788e-07</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>추정의 표준오차 ( <a href="#fig-resi-linear-test1">Figure&nbsp;<span>12.7</span></a> 의 잔차의 표준편차를 말합니다.)
<ul>
<li>추정의 표준오차: 3.863</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>Residual standard error: 3.863</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math inline">\(s= \sqrt{MSE} = \sqrt{14.92}\)</span> = 3.862642 (MSE 14.92는 아래분산분석표에 있다.)</p>
<ul>
<li>결정계수:
<ul>
<li>결정계수 <span class="math inline">\(R^2\)</span> =0.6024, 조정결정계수 <span class="math inline">\(R^2\)</span> = 0.5892</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Multiple R-squared:  0.6024,    Adjusted R-squared:  0.5892</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>분산분석표: <code>anova</code> 함수를 사용한다</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>분산분석표 <span class="ot">&lt;-</span> <span class="fu">anova</span>(result.car)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>분산분석표</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: mpg
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
hp         1 678.37  678.37   45.46 1.788e-07 ***
Residuals 30 447.67   14.92                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">요인</th>
<th style="text-align: center;">자유도</th>
<th style="text-align: center;">제곱합</th>
<th style="text-align: center;">제곱평균</th>
<th style="text-align: center;"><span class="math inline">\(F\)</span></th>
<th style="text-align: center;"><span class="math inline">\(p\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">회귀</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">678.37</td>
<td style="text-align: center;">678.37</td>
<td style="text-align: center;">45.46</td>
<td style="text-align: center;">1.788e-07</td>
</tr>
<tr class="even">
<td style="text-align: center;">잔차</td>
<td style="text-align: center;">30</td>
<td style="text-align: center;">447.67</td>
<td style="text-align: center;">14.92</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">계</td>
<td style="text-align: center;">31</td>
<td style="text-align: center;">1126.04</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<ul>
<li>참고</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">요인</th>
<th style="text-align: center;">자유도</th>
<th style="text-align: center;">제곱합</th>
<th style="text-align: center;">제곱평균</th>
<th style="text-align: center;"><span class="math inline">\(F\)</span></th>
<th style="text-align: center;"><span class="math inline">\(p\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">회귀</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(SSR=\sum(\hat Y_i-\bar Y)^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MSR=\frac{SSR}{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{MSR}{MSE}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">잔차</td>
<td style="text-align: center;"><span class="math inline">\(n-2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SSE=\sum(Y_i-\hat Y_i)^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MSE=\frac{SSE}{n-2}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">계</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SST=\sum(Y_i-\bar Y)^2\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<ul>
<li>앞 <a href="data-transform.html"><span>5</span></a> 장의 <a href="data-transform.html#sec-tra-lm">선형회귀분석모델</a> 부분을 참고해 보세요.</li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.6 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>위의 결과에서 마력 hp가 200일 때, 연료효율 mpg는 얼마로 예측할 수 있을까요?</p>
</blockquote>
</div>
<p><strong>답:</strong></p>
<p>16.45286, 위의 회귀식에 대입하여 계산 mpg= 30.09886 + (- 0.06823)* hp = 16.45286</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.7 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>hp가 400일 때, mpg는 얼마로 예측할 수 있을까요?</p>
</blockquote>
</div>
<p><strong>답:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(mtcars<span class="sc">$</span>hp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  52 335</code></pre>
</div>
</div>
<p>독립변수인 hp의 변수값 범위가 52-335이므로 400은 여기서 벗어난다. 회귀분석에서 기존 데이터의 범위를 벗어난 예측 extrapolation 은 정확도와 신뢰도가 떨어지므로 바람직하지 않다. 부득이 하지 않다면 하지 않는 것이 좋다.</p>
</section>
</section>
<section id="다중회귀분석" class="level2" data-number="12.6">
<h2 data-number="12.6" class="anchored" data-anchor-id="다중회귀분석"><span class="header-section-number">12.6</span> 다중회귀분석</h2>
<section id="다중회귀-회귀계수" class="level3" data-number="12.6.1">
<h3 data-number="12.6.1" class="anchored" data-anchor-id="다중회귀-회귀계수"><span class="header-section-number">12.6.1</span> 다중회귀 회귀계수</h3>
<p>단순회귀분석은 종속변수와 독립변수가 각각 하나씩 있습니다. 다중회귀분석은 종속변수는 여전히 하나지만 독립변수는 여러 개가 있습니다. 그러나 단순회귀분석에서 다룬 개념과 이론들은 여전히 다중회귀분석에도 유사하게 적용이 됩니다.</p>
<p>다중회귀모형도 아래 식처럼 표현합니다. <span class="math inline">\(Y_{i}\)</span>는 <span class="math inline">\(Y\)</span>의 <span class="math inline">\(i\)</span>번째 관찰값이고 <span class="math inline">\(X_1\)</span>과 <span class="math inline">\(X_2\)</span>는 각각 별도의 독립변수이고 <span class="math inline">\(\beta\)</span>와 <span class="math inline">\(\gamma\)</span>는 거기에 대응하는 회귀계수입니다.</p>
<p><span class="math display">\[ {\displaystyle Y_{i}=\alpha+\beta X_{1}+\gamma X_{2}+\epsilon_{i}} \; , \epsilon \sim N(0,\sigma^2) \]</span></p>
<p>종속변수 <span class="math inline">\(Y\)</span>의 기댓값은;</p>
<p><span class="math display">\[ E(Y_i)= \alpha+\beta X_{1}+\gamma X_{2} \]</span></p>
<p><span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span>의 추정값을 <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>라고 하면 추정회귀방정식은</p>
<p><span class="math display">\[\displaystyle {\hat {Y}}_{i}=\alpha+\beta X_1+\gamma X_2 \]</span></p>
<p>위의 방정식을 가지고 최소제곱법으로 <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>를 각각 구합니다.</p>
</section>
<section id="다중회귀-분산분석표" class="level3" data-number="12.6.2">
<h3 data-number="12.6.2" class="anchored" data-anchor-id="다중회귀-분산분석표"><span class="header-section-number">12.6.2</span> 다중회귀 분산분석표</h3>
<p>여기서도 <strong>분산분석표</strong> analysis of variance table 는 제곱합 <span class="math inline">\(SS\)</span>; sum of squares 과 자유도, 제곱평균<span class="math inline">\(MS\)</span>; mean square, <span class="math inline">\(F\)</span>값 등을 표로 나타낸 것입니다. 각 요소들의 관계를 한 눈에 살필 수 있습니다. <span class="math inline">\(K\)</span>는 독립변수의 수입니다.</p>
<table class="table">
<caption>다중회귀분산분석표</caption>
<colgroup>
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 33%">
<col style="width: 23%">
<col style="width: 21%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">요인</th>
<th style="text-align: center;">자유도</th>
<th style="text-align: center;">제곱합</th>
<th style="text-align: center;">제곱평균</th>
<th style="text-align: center;"><span class="math inline">\(F\)</span></th>
<th style="text-align: center;"><span class="math inline">\(p\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">회귀</td>
<td style="text-align: center;"><span class="math inline">\(k\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SSR=\sum(\hat Y_i-\bar Y)^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MSR=\frac{SSR}{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{MSR}{MSE}\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">잔차</td>
<td style="text-align: center;"><span class="math inline">\(n-1-k\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SSE=\sum(Y_i-\hat Y_i)^2\)</span></td>
<td style="text-align: center;"><span class="math inline">\(MSE=\frac{SSE}{n-2}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">계</td>
<td style="text-align: center;"><span class="math inline">\(n-1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(SST=\sum(Y_i-\bar Y)^2\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(MSE\)</span>는 오차 분산 <span class="math inline">\(\sigma_{\epsilon}^{2}\)</span> 의 불편 추정량 unbiased estimator 입니다.</p>
<p>여기서 나오는 <span class="math inline">\(F\)</span>값과 그에 대응하는 <span class="math inline">\(p\)</span>값은 회귀모형의 유의성 검정에 사용합니다.</p>
<ul>
<li><code>knitr::kable</code> 함수를 이용해서 분산분석표를 직접 그려봅시다.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>다중회귀.결과 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Sepal.Length <span class="sc">~</span> Sepal.Width <span class="sc">+</span> Petal.Length, <span class="at">data =</span> iris, )</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>다중회귀.표 <span class="ot">&lt;-</span> <span class="fu">anova</span>(다중회귀.결과)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(다중회귀.표, <span class="at">align =</span> <span class="st">'c'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-aov-tab-mulreg" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;12.4: 분산분석표 Sepal.Length에 대한 다중회귀분석</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: center;">Df</th>
<th style="text-align: center;">Sum Sq</th>
<th style="text-align: center;">Mean Sq</th>
<th style="text-align: center;">F value</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sepal.Width</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1.412238</td>
<td style="text-align: center;">1.412238</td>
<td style="text-align: center;">12.71369</td>
<td style="text-align: center;">0.0004902</td>
</tr>
<tr class="even">
<td style="text-align: left;">Petal.Length</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">84.427332</td>
<td style="text-align: center;">84.427332</td>
<td style="text-align: center;">760.05861</td>
<td style="text-align: center;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Residuals</td>
<td style="text-align: center;">147</td>
<td style="text-align: center;">16.328764</td>
<td style="text-align: center;">0.111080</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="다중회귀-결정계수" class="level3" data-number="12.6.3">
<h3 data-number="12.6.3" class="anchored" data-anchor-id="다중회귀-결정계수"><span class="header-section-number">12.6.3</span> 다중회귀 결정계수</h3>
<p>결정계수는 회귀식이 독립변수와 종속변수 간의 관계를 잘 설명하는 정도를 보여주는 척도입니다. 다중회귀모형의 결정계수는 아래의 공식으로 얻어집니다. 단순회귀모형과 동일합니다.</p>
<p><span class="math display">\[ R^2=\frac{SSR}{SST} = 1 - \frac{SSE}{SST}\]</span></p>
<p>결정계수의 제곱근을 상관계수라고 합니다. 상관계수 <span class="math inline">\(R=\sqrt{R^2}\)</span></p>
<p>단순회귀모형과 달리 다중회귀모형의 결정계수는 문제가 있습니다. 독립변수의 수가 늘어날수록 <span class="math inline">\(SSE\)</span>는 감소하는데 <span class="math inline">\(SST\)</span>는 그대로 있으므로, 독립변수의 수가 결정계수의 값을 증가시키기 때문입니다. 독립변수의 수가 많아지면 모형도 복잡해지고 효율성도 감소하며, 무엇보다도 독립변수 사이의 상관관계가 높아지게 되어 회귀계수의 해석이 어려워집니다. 독립변수 사이의 상관관계는 다중공선성 문제라고 하여 회귀분석에서 가능하다면 피해야 하므로 독립변수의 수가 많아지는 게 꼭 좋은 일은 아닙니다. 그래서 독립변수의 수를 고려해서 결정계수를 다소 조정한 것이 <strong>조정결정계수</strong> adjusted coefficient of multiple determination 입니다. 조정결정계수의 공식은 아래와 같습니다.</p>
<p><span class="math display">\[ R^2=1-\frac{n-1}{n-k-1}(\frac{SSE}{SST})  \]</span></p>
<p>독립변수가 하나 늘어나면 <span class="math inline">\(k\)</span>가 1 증가하므로 분모가 증가합니다. 따라서 <span class="math inline">\(SSE\)</span>가 상응하는 만큼 줄어들지 충분히 줄어즐지 않는다면 <span class="math inline">\(R^2\)</span>은 작아집니다. 독립변수를 추가해도 추가 설명력이 약하다면 조정결정계수는 오히려 감소하므로 다중회귀모형에서 독립변수를 추가할 때 조정결정계수를 잘 살펴서 판단하는 것이 좋습니다.</p>
</section>
<section id="다중회귀-유의성-검정" class="level3" data-number="12.6.4">
<h3 data-number="12.6.4" class="anchored" data-anchor-id="다중회귀-유의성-검정"><span class="header-section-number">12.6.4</span> 다중회귀 유의성 검정</h3>
<p>회귀모형의 유의성은 독립변수가 종속변수에 정말로 영향을 미치는지 검정하는 겁니다. 유의성을 검토하는 절차는 아래와 같습니다.</p>
<ol type="1">
<li>가설을 세운다 <br> <span class="math inline">\(H_0: \beta_1 = \beta_2 = \cdots =\beta_k = 0\)</span> 모든 회귀계수는 0이다. <br> <span class="math inline">\(H_A: \beta_j \ne 0\)</span> 회귀계수 중에 적어도 하나는 0이 아니다. <br></li>
<li>유의수준을 결정한다</li>
<li>검정통계량을 계산한다 <span class="math display">\[ F_0= \frac{MSR}{MSE} \gt F_{\alpha , (1,n-2)} \]</span></li>
<li>임곗값과 비교하여 결정한다</li>
</ol>
<p>다중회귀모형이 유용한가는 유의성 검정만으로 결정하는 것이 아니라 결정계수, 추정의 표준오차 등을 복합적으로 살핀 후에 결정하는 것이 바람직합니다.</p>
</section>
<section id="다공선성" class="level3" data-number="12.6.5">
<h3 data-number="12.6.5" class="anchored" data-anchor-id="다공선성"><span class="header-section-number">12.6.5</span> 다공선성</h3>
<p>다중회귀모형에서 독립변수 또는 설명변수가 여러 개일 때 다공선성의 문제가 발생하기 쉽습니다. <strong>다중공선성</strong> multicollinearity 은 독립변수 사이에 높은 상관관계가 있을 때 모형의 추정에 나쁜 영향을 주는 문제를 말합니다. 따라서 다중회귀모형을 수립할 때 독립변수의 추가는 가능한 한 적은 것이 바람직하며 신중하게 판단해야 합니다. 다음의 경우에 다중공선성이 발생하기 쉽습니다.</p>
<ul>
<li>독립변수들 사이의 상관관계가 높게 나타났을 때</li>
<li>중요하게 생각했던 독립변수의 회귀계수가 유의미하게 나타나지 않았을 때</li>
<li>추정한 회귀게수의 부호가 이론이나 과거 경험에서 예상했던 것과 반대일 때</li>
<li>독립변수를 추가하거나 제거했을 때 다른 회귀계수들에게 큰 변화가 있을 때</li>
<li>다중공선성을 측정하는 분산팽창인자 VIF 의 값이 기준을 넘었을 때</li>
</ul>
<p>독립변수를 선택할 때 결정계수와 조정결정계수의 증가는 높은 것이 좋고, 평균제곱오차와 멜로우 C 는 낮은 것이 좋습니다.</p>
<p><span class="math display">\[MSE_k=\frac{SSE_l}{n-k-1}\]</span> <span class="math display">\[C_p=\frac{1}{\hat \sigma^2}SSE_p-n+2(p+1) \]</span></p>
<p>독립변수의 선택 방법은 아래와 같습니다.</p>
<ol type="1">
<li><strong>전진선택</strong>: 후보 독립변수 중에서 가장 기여가 높은 순서로 하나씩 선택하며 더 이상 선택이 없을 때 멈춘다.</li>
<li><strong>후진소거</strong>: 후보 독립변수를 모두 포함하는 회귀모형에서 출발해서 기여가 낮은 순서로 하나씩 제거한다. 더 이상 제거가 없을 때 멈춘다.</li>
<li><strong>단계적 회귀</strong>: 전진선택과 후진소거를 혼합한 것으로 가장 기여가 높은 순서로 추가하지만 이미 선정했어도 기여가 기준 이하로 내려가면 제거한다.</li>
<li><strong>모든 가능한 회귀</strong>: 가능한 모든 모형을 검토해서 최적의 모형을 찾는다. 독립변수가 <span class="math inline">\(k\)</span>개라면 <span class="math inline">\(2^k\)</span>번 실행하여 검토한다. 할 수 있다면 최선이다.</li>
</ol>
<p>앞 <a href="data-transform.html"><span>5</span></a> 장의 <a href="data-transform.html#sec-tra-lm">선형회귀분석모델</a> 부분을 잠깐 다시보기 해보세요.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.8 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>mtcars 데이터셋을 사용하여 다중회귀분석을 해봅시다. 마력 hp와 무게 wt가 연료효율 mpg에 주는 영향을 봅니다.</p>
</blockquote>
<ol type="1">
<li>회귀식을 구하세요.</li>
<li>이 회귀식이 의미가 있을까요?</li>
<li>각 독립변수 hp와 wt가 종속변수 mpg에 영향을 줄까요?</li>
</ol>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>result2.car <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result2.car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 37.22727    1.59879  23.285  &lt; 2e-16 ***
hp          -0.03177    0.00903  -3.519  0.00145 ** 
wt          -3.87783    0.63273  -6.129 1.12e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.593 on 29 degrees of freedom
Multiple R-squared:  0.8268,    Adjusted R-squared:  0.8148 
F-statistic: 69.21 on 2 and 29 DF,  p-value: 9.109e-12</code></pre>
</div>
</div>
<p><strong>답:</strong></p>
<ol type="1">
<li><p>회귀식: mpg = 37.22727 + (-0.03177) * hp + (-3.87783) * wt</p></li>
<li><p>이 회귀식 모델의 F값은 69.21 이고 이때 p=0.000 &lt; 0.05 이므로 의미가 있다.</p></li>
<li><p>hp의 회귀계수가 -0.03177 이고 그에 해당하는 t 값은 -3.519, p값은 0.00145다. p값이 0.025(<span class="math inline">\(\alpha=0.05\)</span> ; 양측검정)보다 적으므로 hp의 회귀계수가 0이라는 귀무가설을 기각한다. <br> 따라서 hp의 회귀계수가 0이 아니라는 대립가설을 채택한다. hp의 mpg에 대한 영향은 통계적으로 유의미하다.</p></li>
</ol>
<p>또한 wt의 회귀계수가 -3.87783 이고 그에 해당하는 t 값은 -6.129, p값은 0.000이다. p값이 0.025(<span class="math inline">\(\alpha=0.05\)</span> ; 양측검정)보다 적으므로 wt의 회귀계수가 0이라는 귀무가설을 기각한다. <br> 따라서 wt의 회귀계수가 0이 아니라는 대립가설을 채택한다. wt의 mpg에 대한 영향은 통계적으로 유의미하다.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
결과에 나타난 용어의 의미
</div>
</div>
<div class="callout-body-container callout-body">
<p>위 회귀분석 결과의 <code>Coefficients:</code>에서 나타난 용어 <code>estimate</code>와 <code>Std. error</code>, <code>t value</code>를 주목해주세요. 그것들을 이용해서 <code>confidence interval</code>을 계산할 줄 알아야 합니다. 이 용어들은 <a href="inference-hypothesis.html"><span>9</span></a> 장의 <a href="inference-hypothesis.html#sec-hyp-p-estimate">점 추정</a>과 <a href="inference-hypothesis.html#sec-hyp-conf-interval">구간 추정</a>에서 배웠습니다. 거기에 가서 다시 한 번 읽어보세요.</p>
</div>
</div>
<p>회귀계수의 구간 추정은 <code>confint(결과_변수)</code> 함수를 사용할 수 있지만 신뢰수준을 달리 줄 수 있으므로 직접 계산할 수도 있어야 합니다.</p>
</section>
<section id="교호작용" class="level3" data-number="12.6.6">
<h3 data-number="12.6.6" class="anchored" data-anchor-id="교호작용"><span class="header-section-number">12.6.6</span> 교호작용</h3>
<p>교호작용은 독립변수가 상호작용을 하며 종속변수에 미치는 영향을 말합니다. 예를 들어, 독립변수 hp와 wt, 종속변수 mpg가 있다고 합시다. hp가 10마력일 때 wt가 mpg에 5만큼 영향을 주고 (즉 wt 회귀계수가 5), hp가 20마력일 때도 여전히 wt가 5만큼 영향을 준다면 (즉 여전히 wt 회귀계수가 5) 교호작용 효과가 없는 것입니다.</p>
<p>그러나 hp가 10마력일 때는 wt가 mpg에 5만큼 영향을 주지만, hp가 20마력일 때는 wt가 10만큼 영향을 준다면 교호작용 효과가 있는 것입니다. 즉 hp가 늘어날수록 wt가 mpg에 주는 영향이 늘어나거나 줄어들면 교호작용 효과가 있는 것이고, hp의 크기에 관계없이 wt가 mpg에 주는 영향이 같다면 교호작용이 없는 것입니다.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 12.9 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>위의 회귀분석을 교호작용을 넣어서 회귀분석을 합니다.</p>
</blockquote>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>result3.car <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt <span class="sc">+</span> hp<span class="sc">:</span>wt, <span class="at">data =</span> mtcars)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lm(mpg ~ hp*wt, data = mtcars)도 위와 동일한 코딩</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result3.car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt + hp:wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0632 -1.6491 -0.7362  1.4211  4.5513 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 49.80842    3.60516  13.816 5.01e-14 ***
hp          -0.12010    0.02470  -4.863 4.04e-05 ***
wt          -8.21662    1.26971  -6.471 5.20e-07 ***
hp:wt        0.02785    0.00742   3.753 0.000811 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.153 on 28 degrees of freedom
Multiple R-squared:  0.8848,    Adjusted R-squared:  0.8724 
F-statistic: 71.66 on 3 and 28 DF,  p-value: 2.981e-13</code></pre>
</div>
</div>
<p><strong>답:</strong></p>
<p>hp와 wt가 각각 종속변수 mpg에 통계적으로 유의미한 효과를 줍니다. 교호작용 효과도 통계적으로 유의미하게 나타나서 hp와 wt의 효과의 크기인 회귀계수가 (교호작용 포함 전과) 달라졌습니다.</p>
<p>교호작용의 호귀계수는 0.02785이고 그에 해당하는 t값이 3.753, p값이 0.000811입니다. p&lt;0.025(<span class="math inline">\(\alpha=0.05\)</span> 양측검정)이므로 교호작용의 회귀계수가 0이라는 귀무가설을 기각합니다. 따라서 교호작용의 회귀계수가 0이 아니라는 대립가설을 채택합니다. hp와 wt의 교호작용이 mpg에 대한 영향은 통계적으로 유의미합니다.</p>
<div id="exr-sec-reg-exr-cor-re" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 12.1 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p><code>airquality</code> 데이터에서 <code>Ozone</code>를 종속변수로 하고 <code>Solar.R</code>, <code>Wind</code>, <code>Temp</code>를 독립변수로 하여 회귀분석을 하세요. 변수 간의 산포도와 상관계수를 참고하세요.</p>
</blockquote>
</div>
<p><a href="solutions.html#sec-sol-reg-exr-cor-re">해답 보기</a></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./variance-analysis.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">분산분석</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./solutions.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">해답</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>