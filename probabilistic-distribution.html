<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="For the class: Statistics and Analysis with R &amp; Quarto">

<title>통계와 분석 - 8&nbsp; 확률분포와 표집분포</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./inference-hypothesis.html" rel="next">
<link href="./exploratoy-analysis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./probabilistic-distribution.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">확률분포와 표집분포</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">통계와 분석</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">안내</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">강의 소개</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">통계의 기초 개념</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R 기본</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./write-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quarto 사용하기</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">데이터의 변환, 요약, 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">기술통계</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exploratoy-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">탐색적 데이터 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probabilistic-distribution.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">확률분포와 표집분포</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-hypothesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">추정과 가설 검정</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./categorical-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">범주형 자료분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variance-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">분산분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">선형 회귀분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">해답</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">참고문헌</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#확률" id="toc-확률" class="nav-link active" data-scroll-target="#확률"><span class="header-section-number">8.1</span> 확률</a></li>
  <li><a href="#확률변수" id="toc-확률변수" class="nav-link" data-scroll-target="#확률변수"><span class="header-section-number">8.2</span> 확률변수</a></li>
  <li><a href="#이항확률분포" id="toc-이항확률분포" class="nav-link" data-scroll-target="#이항확률분포"><span class="header-section-number">8.3</span> 이항확률분포</a></li>
  <li><a href="#확률함수와-확률분포" id="toc-확률함수와-확률분포" class="nav-link" data-scroll-target="#확률함수와-확률분포"><span class="header-section-number">8.4</span> 확률함수와 확률분포</a></li>
  <li><a href="#확률분포의-종류" id="toc-확률분포의-종류" class="nav-link" data-scroll-target="#확률분포의-종류"><span class="header-section-number">8.5</span> 확률분포의 종류</a></li>
  <li><a href="#정규분포" id="toc-정규분포" class="nav-link" data-scroll-target="#정규분포"><span class="header-section-number">8.6</span> 정규분포</a></li>
  <li><a href="#t-분포" id="toc-t-분포" class="nav-link" data-scroll-target="#t-분포"><span class="header-section-number">8.7</span> t 분포</a></li>
  <li><a href="#카이제곱-분포" id="toc-카이제곱-분포" class="nav-link" data-scroll-target="#카이제곱-분포"><span class="header-section-number">8.8</span> 카이제곱 분포</a></li>
  <li><a href="#f-분포" id="toc-f-분포" class="nav-link" data-scroll-target="#f-분포"><span class="header-section-number">8.9</span> F 분포</a></li>
  <li><a href="#각-분포에-대한-r-함수" id="toc-각-분포에-대한-r-함수" class="nav-link" data-scroll-target="#각-분포에-대한-r-함수"><span class="header-section-number">8.10</span> 각 분포에 대한 R 함수</a></li>
  <li><a href="#표집분포" id="toc-표집분포" class="nav-link" data-scroll-target="#표집분포"><span class="header-section-number">8.11</span> 표집분포</a>
  <ul class="collapse">
  <li><a href="#중심극한-정리" id="toc-중심극한-정리" class="nav-link" data-scroll-target="#중심극한-정리"><span class="header-section-number">8.11.1</span> 중심극한 정리</a></li>
  </ul></li>
  <li><a href="#평균의-표집분포-한-모집단" id="toc-평균의-표집분포-한-모집단" class="nav-link" data-scroll-target="#평균의-표집분포-한-모집단"><span class="header-section-number">8.12</span> 평균의 표집분포; 한 모집단</a></li>
  <li><a href="#평균-차이의-표집분포-두-모집단" id="toc-평균-차이의-표집분포-두-모집단" class="nav-link" data-scroll-target="#평균-차이의-표집분포-두-모집단"><span class="header-section-number">8.13</span> 평균 차이의 표집분포; 두 모집단</a></li>
  <li><a href="#분산의-표집분포-한-모집단" id="toc-분산의-표집분포-한-모집단" class="nav-link" data-scroll-target="#분산의-표집분포-한-모집단"><span class="header-section-number">8.14</span> 분산의 표집분포; 한 모집단</a>
  <ul class="collapse">
  <li><a href="#분산의-표집분포-두-모집단" id="toc-분산의-표집분포-두-모집단" class="nav-link" data-scroll-target="#분산의-표집분포-두-모집단"><span class="header-section-number">8.14.1</span> 분산의 표집분포; 두 모집단</a></li>
  </ul></li>
  <li><a href="#sec-pro-n-1" id="toc-sec-pro-n-1" class="nav-link" data-scroll-target="#sec-pro-n-1">왜 n이 아니고 n-1인가?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-pro" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">확률분포와 표집분포</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="확률" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="확률"><span class="header-section-number">8.1</span> 확률</h2>
<p><strong>확률</strong> probability 은 어떤 <strong>사건</strong> event 이 일어날 가능성을 말합니다. 동전을 던져 앞면이 나올 가능성, 주사위를 두 번 던져서 합이 10이 되는 가능성, 통계시험을 80점 이상 받을 가능성 등등이 확률입니다. 확률은 0부터 1 사이의 숫자나 0%부터 100% 사이의 퍼센트로 나타냅니다.</p>
<p>통계에서 <strong>확률 공간</strong> probability space 은 무작위 과정 random process 또는 ‘실험’ experience’ 을 통해 모델을 규정하는 수학적 개념입니다. 확률 공간은 반드시 세 개의 요소를 가집니다. (여기서 말하는 ’실험’과 ’표본’은 우리가 통상 사용하는 것과 좀 다릅니다. 확률론에서 정의한 용어니까, 사회과학적 용어와 약간 다릅니다.)</p>
<ul>
<li><strong>표본 공간</strong> sample space, <span class="math inline">\(\Omega\)</span>, 실험이나 실행에서 모든 가능한 결과들 outcomes 의 집합이다.</li>
<li><strong>사건 공간</strong> event space, <span class="math inline">\({\mathcal F}\)</span>, 사건들의 집합, 사건은 결과의 한 하위집합 subset 에 속해 있다.</li>
<li><strong>확률 함수</strong> probability function, <span class="math inline">\(P\)</span>, 사건 공간이 포함한 각 개별 사건들에게 확률을 부여한다.</li>
</ul>
<p>이 세 가지 요소를 통해 우리는 아래처럼 ’실험’의 확률을 예측합니다.</p>
<blockquote class="blockquote">
<p>만일 ’실험’을 실행했는데 실행의 결과가 사건공간에 속한다면, 그 사건은 발생한 것이다. 이 과정을 아주 많이 반복한다면 확률 함수 <span class="math inline">\(P\)</span>가 부여한 확률대로 사건이 발생하는 경향을 보인다.</p>
</blockquote>
<p>어려워보이지만 사실 쉬운 설명입니다. 예를 들어 봅시다. 주사위를 던지는 ’실험’에서 표본공간은 {1, 2, 3, 4, 5, 6}입니다. 모든 가능한 결과를 포함하니까요. 우리가 원하는 게 2 이하 숫자가 나오는 것이면 사건공간은 {1, 2}입니다. 그리고 {1, 2}는 {1, 2, 3, 4, 5, 6}의 집합에 속하는 하위집합입니다. 주사위를 던지면 결과가 나옵니다. 즉, 여섯 숫자 중 하나가 나옵니다. 만일 1이나 2가 나오면 우리가 원하는 사건이 일어난 것입니다. 이걸 아주 많이 반복하면, 우리가 원하는 사건의 확률은 결국 <span class="math inline">\((\frac{1}{6}+\frac{1}{6})=\frac{1}{3}\)</span> 가 된다는 겁니다. 여기서 <span class="math inline">\(\frac{1}{6}\)</span> 이 주사위 개별 숫자가 가지는 확률함수입니다.</p>
<p><span style="color:red">학률, 확률공간, 표본공간, 사건공간, 확률함수</span></p>
<div id="exr-sec-pro-exr1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.1 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<ol type="1">
<li>주사위를 굴렸을 때 표본 공간은 무엇입니까?</li>
<li>주사위 숫자가 2와 같거나 적게 나올 사건 공간은 무엇입니까?</li>
<li>주사위 숫자가 <span class="math inline">\(x\)</span>와 같거나 적게 나올 사건의 확률 함수 <span class="math inline">\(f(x)\)</span>를 작성하세요. 즉 <span class="math inline">\(P(X \le x)=f(x)\)</span></li>
</ol>
</blockquote>
</div>
<p><a href="solutions.html#sec-sol-pro-exr1">해답 가기</a></p>
</section>
<section id="확률변수" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="확률변수"><span class="header-section-number">8.2</span> 확률변수</h2>
<p>확률변수는 무작위적 변수라는 이름이 더 잘 어울리며 모든 측정값이 무작위적 특성을 갖는다고 설명했습니다. ( <a href="basic-concepts.html"><span>2</span></a> 장의 <a href="basic-concepts.html#sec-sta-pro-var">확률변수</a> 참고) 그런데 앞으로 <strong>변수값</strong>이란 용어가 등장하므로 혼동하지 않기 바랍니다. 측정값은 동일한 확률은 갖지만 변수값은 동일한 확률이 아닌데 확률변수라면 둘다 무작위적 확률을 가지는 겁니다.</p>
<p>예를 들어, 한국대 미디어학과 {철수, 영희, 복길, 희동, 경희} 5명 있고 각각의 키는 {160, 165, 170, 170, 175} 라고 합시다. 그러면 측정값이 다섯 개가 있는 겁니다. 모든 사람마다 키를 측정했으니까 사람 수만큼 측정값이 나오겠지요. 이 중에 한 사람을 무작위로 뽑는다면 모두가 동일한 확률을 가지므로 한 학생마다 선택 가능성이 <span class="math inline">\(\frac{1}{5}=0.2\)</span>의 확률이 되고 마찬가지로 측정값이 뽑힐 확률도 0.2가 됩니다. 그런데 170cm인 측정값은 둘이지만 변수값으로 따지면 동일하므로 변수값 170cm가 선택될 확률은 <span class="math inline">\(0.2+0.2=0.4\)</span> 가 됩니다. 각각의 측정값의 선택 가능성은 동일하고 특정한 변수값이 뽑힐 가능성은 해당 측정값의 빈도 수에 따라서 다르지만, 둘 다 확률은 무작위적입니다.</p>
<p>측정값 <span class="math inline">\(x_i\)</span> 은 <span class="math inline">\(i\)</span>번째 사람이 갖는 값이고 모두 동일한 선택 확률을 갖습니다. 변수값 <span class="math inline">\(x\)</span>는 사람(사례, 관찰)과 연관이 없는 그저 척도의 크기만을 나타내는 숫자입니다. 해당 변수값을 측정값으로 갖는 사람이 몇 명이냐 하는 빈도에 따라서 확률이 결정됩니다. 그래서 측정값의 확률을 알고 해당 빈도를 알면 변수값의 확률도 결정됩니다.</p>
<p>아래의 그래프는 25명의 사람의 키를 측정한 것입니다. 따라서 측정값의 수, 즉 빈도는 25입니다. 변수값 166cm의 빈도가 1, 변수값 168cm의 빈도가 3, 변수값 170cm의 빈도가 5 등등입니다. 이것이 확률변수라면 모든 측정값의 선택 확률이 동일하므로 어떤 사람이 뽑혀서 키가 측정될 확률은 <span class="math inline">\(\frac{1}{25}\)</span>입니다. 따라서 168cm의 변수값이 뽑힐 확률은 그래프의 빈도가 3이므로 <span class="math inline">\(\frac{3}{25}\)</span>입니다. 170cm의 변수값이 선택될 확률은 <span class="math inline">\(\frac{5}{25}\)</span>입니다. 개별 측정값의 확률이 결정되면 빈도에 따라 특정 변수값의 확률이 결정됩니다. 이것이 확률변수이고 이것이 확률분포입니다. 확률분포는 상대빈도가 확률을 나타냅니다 (왜냐하면 각 개체의 확률이 동일하니까.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>키 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">170</span>, <span class="dv">166</span><span class="sc">:</span><span class="dv">174</span>, <span class="dv">167</span><span class="sc">:</span><span class="dv">173</span>, <span class="dv">168</span><span class="sc">:</span><span class="dv">172</span>, <span class="dv">169</span><span class="sc">:</span><span class="dv">171</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>키 <span class="ot">&lt;-</span> 키 <span class="sc">+</span> <span class="fl">0.1</span>  <span class="co"># 그래프 모양을 예쁘게 하려고 0.1을 더하다. </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># freq=FALSE는 상대빈도를 사용하는 옵션</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(키, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">main=</span><span class="st">"키의 상대빈도"</span>, <span class="at">xlab=</span><span class="st">"키, x 값"</span>, <span class="at">ylab=</span><span class="st">"상대빈도"</span>, <span class="at">col=</span><span class="st">"magenta"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">166</span>,<span class="dv">176</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.22</span>), <span class="at">labels =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x1, y1, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"green"</span>) <span class="co"># 각 측정값을 나타낸다</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="probabilistic-distribution_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><span style="color:red">측정값, 변수값</span></p>
</section>
<section id="이항확률분포" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="이항확률분포"><span class="header-section-number">8.3</span> 이항확률분포</h2>
<p>동전을 던졌을 때, 앞면이 나타나거나 뒷면이 나타나는 단 두개의 결과만 존재합니다. (아, 물론 옆면으로 우뚝 서는 기적의 사건은 제외합니다.) 앞면이 나타는 확률은 0.5, 뒷면도 0.5입니다. 동전을 한 번 던졌을 때 앞면이 나타나는 횟수가 0이면 확률은 0.5, 횟수가 1이면 0.5입니다. 동전을 두 번 던졌을 때, (뒷,뒷) (뒷,앞) (앞,뒷) (앞,앞) 등 네 경우가 있습니다. 네 경우 모두 확률은 <span class="math inline">\(\frac{1}{2} \times \frac{1}{2}=\frac{1}{4}\)</span> 입니다. 앞면이 나타나는 횟수는 각각 0, 1, 1, 2가 됩니다. 따라서 변수값(앞면 횟수)에 따라 정리하면 0은 빈도가 1, 1은 빈도가 2, 2는 빈도가 1이 됩니다. 확률은 각각 <span class="math inline">\(\frac{1}{4}\)</span>, <span class="math inline">\(\frac{1}{4} + \frac{1}{4} = \frac{1}{2}\)</span>, <span class="math inline">\(\frac{1}{4}\)</span> 입니다.</p>
<p>이렇게 앞면이 나타나는 횟수의 빈도와 확률에 따른 분포를 <strong>이항분포</strong>라고 합니다. 동전을 던져 나오는 결과가 무작위적이고 그 결과에 따라 앞면 횟수의 확률이 결정됩니다. 따라서 앞면이 나오는 횟수로 만들어지는 변수는 확률변수가 되고 그것의 분포인 이항분포는 확률분포가 되는 것입니다.</p>
<p>동전 던지기처럼 단 두 개의 사건만 무작위적으로 일어나는 것을 <strong>베르누이 시행</strong> bernoulli trial 이라고 합니다. 베르누이 시행은 ’무작위적 실험’이므로 언제나 ’성공’과 ’실패’의 확률은 일정합니다. 두 사건만 존재하므로 ’성공’의 확률을 <span class="math inline">\(p\)</span>라고 하면 ’실패”의 확률은 <span class="math inline">\(1-p\)</span>입니다. 동전 실험이라면, 던졌을 때 앞면이 나올 확률이 <span class="math inline">\(p\)</span>라고 하면 뒷면의 확률은 <span class="math inline">\(1-p\)</span>가 됩니다. 베르누이 시행을 여러 번 했을 때 성공의 횟수를 빈도로 나타낸 분포를 <strong>이항분포</strong> binominal distribution 라고 합니다. 베르누이 시행의 횟수를 <span class="math inline">\(n\)</span>, ’성공의 빈도를 <span class="math inline">\(x\)</span>, 성공의 확률을 <span class="math inline">\(p\)</span>라고 할 때, 아래의 함수는 <span class="math inline">\(x\)</span>의 확률(상대빈도)을 나타냅니다. <span class="math inline">\(n\)</span> 번 시행하면 <span class="math inline">\(x\)</span>는 0부터 <span class="math inline">\(n\)</span>까지 존재하므로 그것을 모두 대입한 결과값을 그래프로 그리면 이항분포가 됩니다.</p>
<ul>
<li>이항분포의 확률함수</li>
</ul>
<p><span class="math display">\[f(x) = \binom{n}{x} p^{x} (1-p)^{n-x}\]</span></p>
<p>이항분포는 위의 이항분포 확률함수에 따라 분포를 아니까 이론적으로 평균과 표준편차 등을 계산할 수 있습니다.</p>
<p><span class="math display">\[평균: \; \mu=E(x)=np, \; \; 표준편차: \; \sigma=\sqrt{np(1-p)}\]</span></p>
<p>이항분포의 계산은 <code>dbinom(x,n,p)</code>함수로 가능하고, 직접 하려면 조합을 계산하는 <code>choose</code> 함수를 이용하여 <code>choose(n,x) * p^x * (1-p)^(n-x)</code>로 가능합니다.</p>
<p><span style="color:red">베르누이 시행, 이항분포, 확률변수, 확률분포</span></p>
<div id="exr-sec-pro-exr2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.2 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<ol type="1">
<li>동전을 12번 던졌을 때 앞면이 7번 나올 확률은 얼마일까요?</li>
<li>동전을 12번 던졌을 때 앞면이 나오는 갯수를 X라고 하면 X의 평균과 표준편차는 얼마일까요?</li>
</ol>
</blockquote>
</div>
<p><a href="solutions.html#sec-sol-pro-exr2">해답 가기</a></p>
</section>
<section id="확률함수와-확률분포" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="확률함수와-확률분포"><span class="header-section-number">8.4</span> 확률함수와 확률분포</h2>
<p>확률함수는 확률변수의 변수값을 대입하여 결과값을 확률(상대빈도)로 나타내는 함수입니다. 바로 앞에서 배운 이항분포의 함수가 바로 확률함수입니다. 확률함수의 결과값들로 이루어진 분포가 확률분포입니다. 따라서 확률분포는 확률변수의 변수값과 그 변수값의 확률(상대도수)로 구성된 분포입니다. 확률분포에서 그래프 안의 면적, 즉 확률함수로 그린 선과 밑면 사이의 면적이 확률입니다.</p>
<p>이산변수가 확률변수일 때 <strong>이산 확률분포</strong> discrete probability distribution 를 이룹니다. 앞의 이항분포는 변수값이 정수이므로 이산 확률분포를 가집니다. 이산 확률함수를 <strong>확률질량함수</strong> probability mass function 라고도 부릅니다. 확률분포에서 그래프 안의 면적이 확률입니다.</p>
<p>이항분포를 예로 들어 봅시다. 동전을 2번 던져서 앞면이 나오는 횟수를 변수라고 할 때, 변수값은 0, 1, 2, 세 가지가 있습니다. 확률은 각각 <span class="math inline">\(\frac{1}{4}\)</span>, <span class="math inline">\(\frac{1}{2}\)</span>, <span class="math inline">\(\frac{1}{4}\)</span>입니다. 변수값이 정수이고 정수는 1씩 늘어나니까 밑변의 길이는 1입니다. 면적은 ’밑변x높이’니까 변수값 0의 면적이자 확률은 1x<span class="math inline">\(\frac{1}{4}\)</span>이고 변수값 1의 면적이자 확률은 1x<span class="math inline">\(\frac{1}{2}\)</span>이 됩니다. 그래프의 면적을 다 합하면 확률의 특성상 1이 되겠지요. 변수값이 정수면 밑변이 1이므로 1을 곱해도 마찬가지니까 높이인 상대도수가 그대로 확률이 되는 겁니다.</p>
<p>연속변수가 확률변수일 때 <strong>연속 확률분포</strong> continuous probability distribution 를 이룹니다. 연속 확률함수는 <strong>확률밀도함수</strong> probability density funcition 라고도 부르는데 사실 연속확률함수는 잘 안 쓰고 확률밀도함수라는 용어를 거의 사용합니다. 그리고 연속확률분포는 그냥 확률분포라는 용어를 사용합니다. 그러니 여러분도 확률밀도함수와 확률분포라는 용어의 의미에 주목해야합니다.</p>
<p>연속확률분포도 확률분포이므로 역시 그래프의 면적이 확률을 의미합니다. 그런데 이번에는 문제가 있습니다. 연속변수는 정수가 아니고 실수라서 무한한 수의 변수값이 존재합니다. 170cm가 5명, 171cm가 4명, 이렇게 되지 않고 170.1cm가 1명, 173.578cm가 1명, 173.785247cm가 1명, 이렇게 무한한 변수값에 대응해서 한 명씩 존재하게 됩니다. 즉 밑변의 길이가 <span class="math inline">\(\frac{1}{\infty}\)</span>이어서 0라고 봐야합니다. 그래서 밑변x높이는 0이 나옵니다. 따라서 확률을 구하고 싶어서 변수값을 말할 때 구간을 명시해야합니다. 170cm-173cm 사이의 변수값에 해당하는 확률(상대도수), 이렇게 해야합니다. 바로 확률밀도함수를 그 구간으로 적분한 결과값이지요.</p>
<p>왜 이름이 확률밀도함수인지 궁금하지 않아요? 왜 이산변수는 ‘질량’이고 연속변수는 ’밀도’인지도 궁금하지 않나요? 비유해서 말하자면, 질량은 밑변이 있고 밀도는 밑면이 없는 것입니다. 중력을 예로 듭니다. 지구의 중력가속도는 9.8<span class="math inline">\(m/s^{2}\)</span>입니다. 그럼 나를 당기는 힘이 9.8<span class="math inline">\(m/s^{2}\)</span> 인가요? 아닙니다. 중력은 질량에 비례하므로 질량이 있어야 ’질량x중력가속도’ 해서 당기는 힘을 계산합니다. 따라서 “나는 70kg인데 지구가 나를 당기는 힘이 얼마인가요?” 이렇게 물으면 답이 나옵니다.</p>
<p>그러나 “나의 밀도가 0.9인데 나를 당기는 힘이 얼마인가요?” 이것은 답이 없습니다. 질량은 ’밀도x부피’로 계산하니까 부피를 알아야 질량이 나옵니다. 밀도가 0.9일 때 부피가 10<span class="math inline">\(l\)</span>면 질량은 9kg, 부피가 100<span class="math inline">\(l\)</span>이면 질량은 90kg입니다. 부피가 100<span class="math inline">\(l\)</span>일 때는 부피가 10<span class="math inline">\(l\)</span>일 때보다 중력은 10배로 작용합니다. 그래서 어린아이가 내 배 위에 올라도 버티지만 뚱뚱한 어른이 올라가면 버티지 못합니다. 확률질량함수는 변수값을 가지고 확률을 계산할 수 있고, 확률밀도함수는 변수값의 ’구간’을 정해줘야 확률을 구할 수 있습니다.</p>
<p>확률분포는 확률밀도함수로 표시될 수 있습니다다. X가 연속확률변수고 아래의 조건을 충족할 때 <span class="math inline">\(f(x)\)</span>를 X의 확률밀도함수라 합니다.</p>
<p><span class="math display">\[ 1.\; P(X=x)=0 \]</span></p>
<p>연속확률변수 <span class="math inline">\(X\)</span>가 특정한 변수값 <span class="math inline">\(x\)</span>가 될 확률은 0입니다. (즉 밑변이 없습니다) 연속확률변수는 연속한 살수값을 가지므로 취할 수 있는 값이 무한히 많아서 그 중에 특정한 하나의 값을 가질 가능성은 없다고 봐야합니다. 따라서 구간으로 확률을 구해야 합니다.</p>
<p><span class="math display">\[ 2.\; 모든 \; X에 \; 대하여 \; f(x) \ge 0 \]</span></p>
<p>확률밀도함수는 항상 0이거나 양수 값을 갖습니다</p>
<p><span class="math display">\[ 3.\; \int_{-\infty}^{\infty} f(x) \; dx=1 \]</span></p>
<p>확률밀도함수를 적분하면 전체 면적은 1입니다.</p>
<p><span class="math display">\[ 4.\; \mathrm{P}( a\le X \le b)=\int_{a}^{b} f(x) \; dx \; (단 -\infty \le a \lt b \le \infty) \]</span></p>
<div id="fig-bet-2-pro" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/betw-2-prob-of-normal.png" class="img-fluid figure-img" data-align="left"></p>
<figcaption class="figure-caption">Figure&nbsp;8.1: 확률밀도함수와 구간의 확률</figcaption>
</figure>
</div>
<p>연속확률변수 X가 특정한 값 <span class="math inline">\(a\)</span>와 <span class="math inline">\(b\)</span> 사이에 있을 확률은 그 구간의 확률밀도함수 적분한 값, 즉 확률밀도함수 곡선과 밑변 사이의 면적과 같습니다.</p>
<p><span style="color:red">이산확률분포, 확률질량함수, 연속확률분포, 확률밀도함수</span></p>
</section>
<section id="확률분포의-종류" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="확률분포의-종류"><span class="header-section-number">8.5</span> 확률분포의 종류</h2>
<p>이론적으로 확립된 확률분포는 여러 가지가 있습니다. 이론적으로 확립된 분포는 분포가 알려져 있으므로 분포를 이용해서 여러 가지 통계적 분석을 할 수 있습니다. 대표적인 것이 정규분포, t 분포, <span class="math inline">\(\chi^{2}\)</span> 분포, F 분포 등이 있습니다. 이들은 추론통계에 사용될 수 있으며 가설을 검증하거나 신뢰구간을 정하거나 모델을 검증할 수 있습니다.</p>
</section>
<section id="정규분포" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="정규분포"><span class="header-section-number">8.6</span> 정규분포</h2>
<p>통계에서 가장 많이 활용하는 분포는 <strong>정규분포</strong> normal distribution 입니다. 정규분포는 가우스가 물리 계측의 오차에 대한 확률분포로서 처음 소개하였습니다. 정규분포는 자연적인 환경에서 많이 발생하는 분포입니다. 정규분포는 대칭이며 아래가 넓고 위가 좁은 종 모양과 비슷합니다. 정규분포의 확률밀도함수는 아래와 같습니다. 즉 이렇게 생긴 확률분포가 정규확률분포입니다.</p>
<p><span class="math display">\[X \sim N(\mu, \; \sigma^{2}) \]</span></p>
<p><span class="math display">\[{\displaystyle f(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}\left({\frac {x-\mu }{\sigma }}\right)^{2}}}\;, \; -\infty \lt x \lt \infty\]</span></p>
<p>여기서 <span class="math inline">\(\pi\)</span>=3.141592…, <span class="math inline">\(e\)</span>= 2.71828…</p>
<p>정규분포는 정규확률밀도함수에 의해 이루어지므로 분포를 알 수 있습니다. 평균을 중심으로 해서 표준편차의 거리의 사이에 있는 측정값의 확률은, 즉 상대도수는, 68.3%입니다. 표준편차의 2배 거리 사이에 있는 확률은 95.4%이고, 3배 거리의 사이에 있는 확률은 99.7%입니다. 추론통계에서 그걸 이용하는 법을 배웁니다.</p>
<p>i<a href="images/prob-of-normal-distrib-by-sd.png">정규분포에서 평균과 표준편차로 본 구간 확률</a> {#fig-pro-of-nor align=‘left’}</p>
<p>아래는 <span class="math inline">\(\mu\)</span> = 0, <span class="math inline">\(\sigma\)</span> = 1 인 표준정규분포 곡선입니다. 정규분포곡선을 z값으로 표준화한 것입니다. z값을 계산하는 공식은;</p>
<p><span class="math display">\[Z= {\frac {X-\mu}{\sigma}}\]</span></p>
<div class="cell" data-layout-align="left" data-fig.margin="c(1, 0.5, 0, 0.5)">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 표준정규분포</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">500</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, f, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">main =</span> <span class="st">"표준정규분포"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-sta-nor-dis" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="probabilistic-distribution_files/figure-html/fig-sta-nor-dis-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.2: 표준정규분포</figcaption>
</figure>
</div>
</div>
</div>
<p>평균m과 표준편차 sd를 다르게 넣으면 달라집니다. 모두 정규분포곡선입니다.</p>
<div class="cell" data-layout-align="left" data-fig.margin="c(1, 0.5, 0, 0.5)">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">500</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.6</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y0, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.7</span>), <span class="at">main =</span> <span class="st">"표준정규분포곡선(검정), 다른 표준편차(빨강), 다른 평균(녹색)"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y3, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y4, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-some-nor-diff" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="probabilistic-distribution_files/figure-html/fig-some-nor-diff-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.3: 여러 정규분포곡선</figcaption>
</figure>
</div>
</div>
</div>
<p>이항분포에서 시행횟수가 커질 때 이항분포는 정규분포를 닮아갑니다. 이걸 이항분포의 <strong>정규근사</strong> The normal approximation of the binomial distribution 라고 합니다.</p>
<div class="cell" data-layout-align="left" data-fig.margin="c(1, 0.5, 0, 0.5)">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))  <span class="co"># 그래프 둘을 옆으로 나란히 그린다. </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 이항분포: 동전 앞면 확률은 p=0.5, 시행횟수는 n=10번일 때 앞면 횟수는 x</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, n, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"3"</span>, <span class="st">""</span>, <span class="st">"5"</span>, <span class="st">""</span>, <span class="st">"7"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"10"</span> )</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 앞면의 횟수에 따른 확률질량함수. 즉 이론적인 실험의 기대값, y는 확률함수</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> n, <span class="at">prob =</span> p)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(y, <span class="at">names.arg =</span> labels, <span class="at">xlab=</span><span class="st">"앞면 나온 횟수"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">10.5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.006</span>, <span class="fl">0.27</span>), <span class="at">ylab=</span><span class="st">"상대빈도"</span>, <span class="at">main=</span><span class="st">"이항분포 n=10 (기대값)"</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 이항분포: 앞면 확률이 0.5, 시행횟수가 20번일 때 -- 실제 실험</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 이항본포의 난수를 천 개 뽑는다. 즉 10번 시행해서 앞면이 몇 개 나오는가? 하는 실험을 천 번 한다. </span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, n, p)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, n<span class="fl">+0.5</span>, <span class="at">by=</span><span class="dv">1</span>), <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">"앞면 나온 횟수"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.20</span>), <span class="at">ylab=</span><span class="st">"상대빈도"</span>, <span class="at">main=</span><span class="st">"이항분포 n=20 (천번 실험)"</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="fl">2.236</span>), <span class="dv">0</span>, <span class="dv">20</span>,  <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">add =</span> T) <span class="co"># 붉은 색 정규분포곡선을 추가로 넣는다</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-nor-app-bino" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="probabilistic-distribution_files/figure-html/fig-nor-app-bino-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.4: 정규근사:기대값 vs 표본 추출</figcaption>
</figure>
</div>
</div>
</div>
<p><span style="color:red">정규분포, 표준정규분포, 정규근사</span></p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.1 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>통계점수가 평균이 60, 표준편차가 8인 정규분포를 하는 집단에서 통계점수가 55점이라면 z값은 얼마인가요? 상위에서 몇 %에 들어갈까요?</p>
</blockquote>
</div>
<p><strong>답:</strong></p>
<p>풀이: 정규분포에서 55점에 대한 누적확률을 구한다 (상위 %를 구한다.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (<span class="dv">55-60</span>)<span class="sc">/</span><span class="dv">8</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="dv">55</span>, <span class="dv">60</span>, <span class="dv">8</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)  <span class="co"># lower.tail = FALSE 는 상위 %</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"z="</span>, z, <span class="st">","</span>, <span class="st">" 상위"</span>, <span class="fu">round</span>(p, <span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span>, <span class="st">"%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>z= -0.625 ,  상위 73 %</code></pre>
</div>
</div>
<div id="exr-sec-pro-exr3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.3 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>평균이 3, 표준편차가 2인 정규분포 곡선을 그리고 거기에 동일한 조건의 누적분포 곡선을 넣으세요. 색을 달리하세요.</p>
</blockquote>
</div>
<p><a href="solutions.html#sec-sol-pro-exr3">해답 가기</a></p>
</section>
<section id="t-분포" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="t-분포"><span class="header-section-number">8.7</span> t 분포</h2>
<p>분포는 변수값에 따른 빈도를 나타낸 것입니다. 확률분포는 확률변수의 분포이고요. t 분포는 Gosset가 student라는 익명으로 발표해서 student’s t 라는 이름으로 불립니다. t 분포는 정규분포와 모양이 아주 비슷한데 정규분포를 좀더 일반화한 것이라고 볼 수 있습니다. t 분포는 정규분포와 마찬가지로 좌우 대칭이며 종 모양의 형태를 가집니다. t 분포는 정규분포보다 더 넓게 분산되어 있습니다. 뒤에 배울 표집분포에서 표본의 크기가 30보다 작을 때 정규분포와 비슷하지만 분산이 넓어서 오차를 더 허용하는 t 분포를 자주 사용합니다.</p>
<p>t 분포를 사용하는 방식은 표준정규분포의 Z값을 사용하는 방식과 거의 같습니다. 아래는 표집분포에서 평균 <span class="math inline">\(\bar X\)</span> 의 T값을 계산하는 공식입니다. T 값을 계산한 뒤에 해당 자유도를 찾아 확률을 검정합니다. T값은 Z값과 공식이 동일하지만 대응하는 분포의 값이 약간 다릅니다.</p>
<p><span class="math display">\[\displaystyle  T= {\frac {{\bar {X}}-\mu_\bar X }{S_\bar X}}\]</span></p>
<p>참고로, 확률변수 <span class="math inline">\(T\)</span>가 자유도 <span class="math inline">\(n\)</span>인 <span class="math inline">\(t\)</span> 분포를 가질 때 <span class="math inline">\(T\)</span> 의 확률밀도 함수는 이렇습니다.</p>
<p><span class="math display">\[\displaystyle f(t)={\frac {\Gamma ({\frac {n +1}{2}})}{{\sqrt {n \pi }}\,\Gamma ({\frac {n }{2}})}}\left(1+{\frac {t^{2}}{n}}\right)^{-(n +1)/2}   \]</span></p>
<div class="cell" data-layout-align="left" data-fig.margin="c(1, 0.5, 0, 0.5)">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 표준정규분포와 여러 t 분포</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">500</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dt</span>(x, <span class="at">df =</span><span class="dv">1</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dt</span>(x, <span class="at">df =</span><span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dt</span>(x, <span class="at">df =</span><span class="dv">3</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">dt</span>(x, <span class="at">df =</span><span class="dv">4</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">main =</span> <span class="st">"표준정규분포(빨강)과 여러 자유도의 t 분포(녹색)"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y3, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y4, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"red"</span>)  <span class="co"># 빨강 줄이 맨 나중에 나오게</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-some-t-dis" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="probabilistic-distribution_files/figure-html/fig-some-t-dis-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.5: 여러 t 분포</figcaption>
</figure>
</div>
</div>
</div>
<p>참고로 t 분포는 바로 다음에 배우는 <span class="math inline">\(\chi_2\)</span> 분포와 연관이 있습니다. T가 자유도 df를 가지고 <span class="math inline">\(\chi^2\)</span> 역시 자유도 df를 가진다면 아래 공식이 성립합니다. T와 <span class="math inline">\(\chi^2\)</span> 는 서로 독립적입니다.</p>
<p>아래 공식에 따라 t 값을 계산하는데 그대로는 어려우니까 <span class="math inline">\(\chi^2\)</span> 값을 그 아래의 공식에 따라서 대체합니다. <span class="math display">\[ T={\frac {Z}{\sqrt {\chi^2/df }}}=Z{\sqrt {\frac {df }{\chi^2}}} \]</span></p>
<p><span class="math display">\[ S_{n}^{2}={\frac {1}{n-1}}\sum _{i=1}^{n}\left(X_{i}-{\overline {X}}_{n}\right)^{2} \]</span></p>
<p><span class="math display">\[  \chi^2 = (n-1)\frac{S_n^2}{\sigma^2}, \; \; 여기서 \chi^2 는 자유도 (n-1) 을 가진다 \]</span></p>
<p><span class="math display">\[ Z=\left({\overline {X}}_{n}-\mu \right){\frac {\sqrt {n}}{\sigma }} \]</span></p>
<p>위의 <span class="math inline">\(Z\)</span>와 <span class="math inline">\(\chi^2\)</span> 를 아래 좌측에 대입하면 우측이 나옵니다. <span class="math display">\[ T\equiv {\frac {Z}{\sqrt {\chi^{2}/df }}}=\left({\overline {X}}_{n}-\mu \right){\frac {\sqrt {n}}{S_{n}}}\]</span></p>
<p>위의 공식에서 두 가지를 주목해야 합니다. 첫째는 알려지지 않는 <span class="math inline">\(\sigma^2\)</span> 가 분자와 분모에서 서로 상쇄되어 없어져 t값의 계산이 가능해졌습니다. 둘째는 <span class="math inline">\(S_n\)</span> 을 주목해야합니다. 통상 S는 단일한 값이지만 여기서는 표본 크기 <span class="math inline">\(n\)</span>에 따라서 표집분포가 달라지게 되었습니다. 그래서 student’s t가 자유도에 따라 분포가 달라지게 됩니다.</p>
<p><span style="color:red">t 분포</span></p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.2 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>키 평균이 170cm이고 표준편차가 8cm인 집단이 있습니다. 키 관찰값이 자유도 15인 t 분포를 갖는다면 키 163cm에 해당하는 t값은 얼마인가요? 이 집단에서 163cm 이하의 사람을 만날 확률은 얼마인가요?</p>
</blockquote>
</div>
<p><strong>답:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">163-170</span>)<span class="sc">/</span><span class="dv">8</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.875</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="sc">-</span><span class="fl">0.875</span>,<span class="dv">15</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1976844</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(t = (x - \mu) / \sigma = (163-170)/8 = -0.875, \; \;p = pt(-0.875,15) = 0.197\)</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>$t = (x - \mu) / \sigma = (163-170)/8 = -0.875, \; \;p = pt(-0.875,15) = 0.197$ </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="exr-sec-pro-exr4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.4 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>평균이 3, 표준편차가 2이고 자유도가 30인 t 분포 곡선을 그리고 거기에 동일한 조건에 자유도가 4인 분포 곡선을 넣으세요. 색을 달리하세요.</p>
</blockquote>
</div>
<p><a href="solutions.html#sec-sol-pro-exr4">해답 가기</a></p>
</section>
<section id="카이제곱-분포" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="카이제곱-분포"><span class="header-section-number">8.8</span> 카이제곱 분포</h2>
<p>카이제곱 분포 <span class="math inline">\(\chi^{2}\)</span> distribution 는 표준정규분포인 확률변수에서 서로 독립적이고 무작위적인 <span class="math inline">\(k\)</span>개의 값을 꺼내어 제곱한 뒤에 그 합으로 이루어진 분포입니다. <span class="math inline">\(k\)</span>는 자유도로 부르며 분포는 당연히 자유도에 따라서 달라집니다. 조금 아래에 자유도에 따른 <span class="math inline">\(\chi^{2}\)</span> 분포 그래프가 있습니다.</p>
<p>예를 들어, 표준정규분포인 <span class="math inline">\(N(0,1)\)</span>에서 3개의 Z값을 선택해 제곱의 합으로 <span class="math inline">\(Q\)</span>라는 확률변수를 만든다면 <span class="math inline">\(Q\)</span>=<span class="math inline">\(Z_{1}^{2}+Z_{2}^{2}+Z_{3}^{2}\)</span>가 됩니다. 3개 선택해서 <span class="math inline">\(Q_1\)</span> 만들고 또다른 세 개를 선택해서 <span class="math inline">\(Q_2\)</span>를 만들고 … 이렇게 무한하게 <span class="math inline">\(Q_i\)</span>를 만들면 그런 게 무한히 모인 <span class="math inline">\(Q\)</span>는 자유도가 3인 <span class="math inline">\(\chi^{2}\)</span> 분포를 한다는 겁니다.</p>
<p>참고로 <span class="math inline">\(\chi^{2}\)</span> 분포는 감마분포의 특별한 경우입니다. 확률변수 X가 자유도 <span class="math inline">\(k\)</span>인 <span class="math inline">\(\chi^{2}\)</span> 분포 <span class="math inline">\(\chi^{2}(k)\)</span>를 따를 때 <span class="math inline">\(\chi^{2}\)</span> 분포의 확률밀도함수는 아래와 같습니다.</p>
<p><span class="math display">\[{\displaystyle f(x;\,k)={\begin{cases}{\dfrac {x^{{\frac {k}{2}}-1}e^{-{\frac {x}{2}}}}{2^{\frac {k}{2}}\Gamma \left({\frac {k}{2}}\right)}},&amp;x&gt;0 \end{cases}}}\]</span></p>
<p><span class="math inline">\(\chi^{2}\)</span> 의 자유도 <span class="math inline">\(k\)</span> 는 <span class="math inline">\(\chi_k^{2}\)</span> 나 <span class="math inline">\(\chi^{2}(k)\)</span> 로 표기합니다.</p>
<p>참고로 임의의 <span class="math inline">\(a\)</span>에 대해서 감마함수는 아래처럼 정의됩니다.</p>
<p><span class="math display">\[\displaystyle \Gamma (a)=\int _{0}^{\infty }x^{a-1}e^{-x}\,dt,\; 단 \; a &gt;0 \]</span></p>
<p>위의 식이 복잡하다면, 지금부터 말하는 표집분포에 사용되는 방법만 생각하면 됩니다. 정규분포인 모집단 <span class="math inline">\(N(\mu,\sigma^{2})\)</span>에서 크기가 <span class="math inline">\(k\)</span>인 표본 {<span class="math inline">\(X_{1}, X_{2}, \cdots , X_{n}\)</span>}을 추출했을 때 아래 식에 의한 <span class="math inline">\(\chi^{2}\)</span> 값은 자유도 <span class="math inline">\(k-1\)</span>인 <span class="math inline">\(\chi^{2}\)</span>분포를 따른다는 사실을.</p>
<p><span class="math display">\[\chi^{2}=\sum Z_i^{2} = \frac{\sum_{i=1}^{k} (X_i-\bar X)^{2}}{\sigma^{2}} = \frac{(k-1)S^{2}}{\sigma^{2}} \sim \chi^{2}_{k-1}\]</span></p>
<div class="cell" data-layout-align="left" data-fig.margin="c(1, 0.5, 0, 0.5)">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 자유도</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 분포를 그리기 위한 카이제곱의 값</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 카이제곱분포의 값 (확률밀도함수에 카이제곱을 넣어서 구한 값)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, df)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 카이제곱분포 그리기</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"purple"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">xlab=</span><span class="st">"카이제곱"</span>, <span class="at">ylab=</span><span class="st">"확률밀도"</span>, <span class="at">main=</span><span class="st">"카이제곱분포"</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#여기까지가 AI chatGPT가 코딩</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="dv">1</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="dv">2</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="dv">3</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="dv">4</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y1, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y2, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"orange"</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y3, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y4, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"top"</span>, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>), <span class="at">lwd =</span> <span class="fl">2.0</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">"n"</span>, </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"자유도 1"</span>, <span class="st">"자유도 2"</span>, <span class="st">"자유도 3"</span>, <span class="st">"자유도 4"</span>, <span class="st">"자유도 5"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-chi-2-dis" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="probabilistic-distribution_files/figure-html/fig-chi-2-dis-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.6: 카이제곱분포</figcaption>
</figure>
</div>
</div>
</div>
<p>참고: 위의 코드는 챗지피티를 일부 이용했어요</p>
<div class="cell" data-layout-align="center" data-fig.margin="c(1, 0.5, 0, 0.5)">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">'images/chi-distr-by-chatgpt.png'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-chi-dis-chat" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/chi-distr-by-chatgpt.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.7: AI chatGPT가 작성한 카이제곱 그래프의 코드</figcaption>
</figure>
</div>
</div>
</div>
<p>아래는 4종류의 자유도와 범례(legend)를 갖춰 만들라는 부탁을 받은 chatGPT의 코딩</p>
<div class="cell" data-layout-align="left" data-fig.margin="c(1, 0.5, 0, 0.5)">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the degrees of freedom for the chi-square distributions</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of x values to plot the distributions</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the probability density function of the chi-square distributions</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, df[<span class="dv">1</span>])</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, df[<span class="dv">2</span>])</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, df[<span class="dv">3</span>])</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, df[<span class="dv">4</span>])</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the chi-square distributions with colored legends</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"Probability Density"</span>, <span class="at">main=</span><span class="st">"Chi-Square Distributions with Different Degrees of Freedom"</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y2, <span class="at">col=</span><span class="st">"green"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y3, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y4, <span class="at">col=</span><span class="st">"purple"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"df="</span>, df[<span class="dv">1</span>]), <span class="fu">paste</span>(<span class="st">"df="</span>, df[<span class="dv">2</span>]), <span class="fu">paste</span>(<span class="st">"df="</span>, df[<span class="dv">3</span>]), <span class="fu">paste</span>(<span class="st">"df="</span>, df[<span class="dv">4</span>])), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"purple"</span>), <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-cgpt-dra-chi" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="probabilistic-distribution_files/figure-html/fig-cgpt-dra-chi-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.8: 챗지피티가 그린 카이제곱 그래프</figcaption>
</figure>
</div>
</div>
</div>
<p><span style="color:red">카이제곱 분포</span></p>
</section>
<section id="f-분포" class="level2" data-number="8.9">
<h2 data-number="8.9" class="anchored" data-anchor-id="f-분포"><span class="header-section-number">8.9</span> F 분포</h2>
<p>F 분포는 각각 <span class="math inline">\(\chi^{2}\)</span> 분포를 하는 2개의 독립적 확률변수로 이루어진 분포이며 따라서 2개의 자유도를 가지고 그것에 따라 분포가 달라집니다. 확률독립변수를 각각 <span class="math inline">\(V_1\)</span>, <span class="math inline">\(V-2\)</span> 라고 하고 자유도를 <span class="math inline">\(d_1\)</span><span class="math inline">\(d_2\)</span> 라고 할 때 아래의 식이 성립합니다.</p>
<p><span class="math display">\[\displaystyle F={\frac {V_{1}/d_{1}}{V_{2}/d_{2}}} \;=\; \sim F(d_1, d_2) \]</span></p>
<p><span class="math inline">\(X\)</span>에 대한 확률밀도함수는 아래와 같이 표시됩니다.</p>
<p><span class="math display">\[ f(x) = \frac{\Gamma(\frac{d_1 + d_2}{2})}{\Gamma(\frac{d_1}{2}) \Gamma(\frac{d_2}{2})} \left(\frac{d_1}{d_2}\right)^{\frac{d_1}{2}} \frac{x^{\frac{d_1}{2}-1}}{\left(1+\frac{d_1}{d_2}x\right)^{\frac{d_1+d_2}{2}}} \]</span></p>
<p>여기서 <span class="math inline">\(x \gt 0\)</span>, <span class="math inline">\(\Gamma\)</span>는 <span class="math inline">\(\Gamma\)</span> 함수입니다.</p>
<p><span style="color:red">F 분포</span></p>
</section>
<section id="각-분포에-대한-r-함수" class="level2" data-number="8.10">
<h2 data-number="8.10" class="anchored" data-anchor-id="각-분포에-대한-r-함수"><span class="header-section-number">8.10</span> 각 분포에 대한 R 함수</h2>
<p>지금까지 정규분포, t 분포, <span class="math inline">\(\chi^2\)</span> 분포, F 분포 등 분포 4 종류를 배웠습니다. R에는 각 분포마다 4개의 함수가 있습니다.</p>
<div id="tbl-func-4-dis" class="anchored">
<table class="table">
<caption>Table&nbsp;8.1: 각 분포에서 사용하는 R 함수</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 30%">
<col style="width: 11%">
<col style="width: 22%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">함수</th>
<th style="text-align: center;">정규분포</th>
<th style="text-align: center;">t 분포</th>
<th style="text-align: center;"><span class="math inline">\(\chi^2\)</span> 분포</th>
<th style="text-align: center;">F 분포</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">확률밀도함수</td>
<td style="text-align: center;">dnorm(x, mu, sigma)</td>
<td style="text-align: center;">dt</td>
<td style="text-align: center;">dchisq</td>
<td style="text-align: center;">df</td>
</tr>
<tr class="even">
<td style="text-align: center;">누적밀도함수</td>
<td style="text-align: center;">pnorm(x, mu, sigma)</td>
<td style="text-align: center;">pt</td>
<td style="text-align: center;">pchisq</td>
<td style="text-align: center;">pf</td>
</tr>
<tr class="odd">
<td style="text-align: center;">역누적밀도함수</td>
<td style="text-align: center;">qnorm(k, mu, sigma)</td>
<td style="text-align: center;">qt</td>
<td style="text-align: center;">qchisq</td>
<td style="text-align: center;">qf</td>
</tr>
<tr class="even">
<td style="text-align: center;">난수발생함수</td>
<td style="text-align: center;">rdorm(n, mu, sigma)</td>
<td style="text-align: center;">rt</td>
<td style="text-align: center;">rchisq</td>
<td style="text-align: center;">rf</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><strong>d</strong>는 <strong>확률밀도함수</strong>: density function. 준 값의 확률(상대빈도)을 알려준다. 통상 분포 곡선을 그릴 때 사용한다.</li>
<li><strong>p</strong>는 <strong>누적밀도함수</strong>: cumulative density function. 준 값에 대한 누적확률을 알려준다. 추정과 검정에서 대개 이것을 사용한다.</li>
<li><strong>q</strong>는 <strong>역누적밀도함수</strong>: inverse cumulative density function. upper k % of quantile of distribution. 준 누적확률에 대한 해당 값을 알려준다.</li>
<li><strong>r</strong>은 <strong>난수발생함수</strong>: random numbers. 해당 분포에 따라서 난수들을 발생시킨다. (즉 표본을 뽑아준다)</li>
</ul>
<p>누적밀도함수에서 오른쪽부터 누적을 하려면 <code>lower.tail = FALSE</code>를 넣으면 됩니다. 예를 들어,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 자유도 14를 갖는 t 분포에서 t값 -0.785 에 해당하는 누적확률은 (왼쪽 면적)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="sc">-</span><span class="fl">0.785</span>, <span class="dv">14</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 오른쪽 면적을 구하려면 1에서 빼면 된다 (오른쪽 면적 = 1-왼쪽 면적)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="sc">-</span><span class="fl">0.785</span>, <span class="dv">14</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 오른쪽 면적을 직접 구하려면 (오른쪽 면적)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(<span class="sc">-</span><span class="fl">0.785</span>, <span class="dv">14</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이 외에도 이항분포 binominal distribution 의 함수 dbinom(p-, q-, r-), 균일분포 uniform distribution 의 함수 dunif (p-, q-, r-), 지수분포 expotential distribution 의 함수 dexp (p-, q-, r-) 등 여러 분포에 대한 함수가 같은 방식으로 더 있습니다.</p>
</section>
<section id="표집분포" class="level2" data-number="8.11">
<h2 data-number="8.11" class="anchored" data-anchor-id="표집분포"><span class="header-section-number">8.11</span> 표집분포</h2>
<p><strong>표집분포</strong> sampling distribution 는 한국에서 <strong>표본분포</strong>라고도 합니다. 모집단에서 가능한 모든 표본을 추출해서 통계량을 계산한다면 매우 많은 통계량이 산출될 것이고, 그 통계량의 분포를 표집분포라고 합니다.</p>
<p>평균을 예로 들어 보죠. 모집단을 한국의 고등학생으로 설정하고 100명 크기의 표본을 뽑아 키 평균을 산출한다고 하죠. 평균이 하나 나오는데 170cm라고 합시다. 또 다른 100명 크기 표본을 뽑아 평균을 산출하니 이번에는 167cm가 나왔습니다. 또 다른 표본을 뽑아 평균을 산출하고 … 이런 식으로 가능한 모든 표본을 뽑아서 모든 평균을 산출하는 겁니다. 고등학생 수가 약 120만 명이므로 거기서 100명을 뽑는다면 표본의 가짓수가 엄청나게 많을 겁니다. 흔히 말하는 천문학적인 숫자의 표본들이 나오고 그 만큼 엄창난 수의 평균이 산출될 겁니다. 이러한 가능한 모든 평균을 산출하여 늘어놓은 분포가 바로 표집분포입니다. 이번 예는 100명 크기 표본의 키 평균의 표집분포입니다.</p>
<p>표집분포는 산출되는 평균 등의 통계량이 확률변수이므로 확률분포입니다. 통계량의 모든 산출값이 선택될 확률이 동일한 거죠. 이론적으로 확률변수로 논의되는 통계량은 <span class="math inline">\(\bar X\)</span> 처럼 대문자로 표시하고 실제로 표본을 뽑아 계산한 통계량은 <span class="math inline">\(\bar x\)</span> 처럼 소문자로 표시합니다. 분산의 경우에도 <span class="math inline">\(S^{2}\)</span>와 <span class="math inline">\(s^{2}\)</span>로 각각 표시합니다. 다른 부분에서도 동일한 원칙이 적용됩니다. 확률변수로서 논의할 때는 대문자, 실제 측정한 숫자로서 논의할 때는 소문자입니다.</p>
<p><span style="color:red">표집분포, 표본분포, 통계량</span></p>
<section id="중심극한-정리" class="level3" data-number="8.11.1">
<h3 data-number="8.11.1" class="anchored" data-anchor-id="중심극한-정리"><span class="header-section-number">8.11.1</span> 중심극한 정리</h3>
<p>정규분포에서 나온 평균의 표집분포는 정규분포를 이루지만 정규분포가 아닌 비정규분포에서 나온 평균의 표집분포는 정규분포가 아닐 수 있습니다. 추론 통계애서 추론을 하려면 분포를 알아야 하는데 정규분포가 아니라면 추론을 하기가 어렵습니다. <strong>중심극한 정리</strong> central limit theorem 는 이런 걱정을 없애줍니다.</p>
<p>중심극한정리는 비정규분포에서 나온 평균의 표집분포라도 표본의 크기가 충분히 크다면 정규분포를 갖는다고 알려줍니다. 따라서 추론통계분석이 가능합니다.</p>
<p>위의 내용을 중심극한정리 공식으로 나타내자면</p>
<p>평균이 <span class="math inline">\(\mu\)</span> 이고 분산이 <span class="math inline">\(\sigma^{2}\)</span>인 모집단에서 크기 <span class="math inline">\(n\)</span>인 표본의 평균 <span class="math inline">\(\bar X\)</span>의 분포는 <span class="math inline">\(n \rightarrow \infty\)</span> 일때</p>
<p><span class="math display">\[\displaystyle \bar X \rightarrow N(\mu, \frac{\sigma^{2}}{n}), \; Z=\frac{\bar X - \mu}{\frac{\sigma}{\sqrt n}} \rightarrow N(0,1)   \]</span></p>
<p><span style="color:red">중심극한정리, 정규분포, 비정규분포, 표본평균의 분포</span></p>
</section>
</section>
<section id="평균의-표집분포-한-모집단" class="level2" data-number="8.12">
<h2 data-number="8.12" class="anchored" data-anchor-id="평균의-표집분포-한-모집단"><span class="header-section-number">8.12</span> 평균의 표집분포; 한 모집단</h2>
<p>모집단이 정규분포를 한다면 그리고 표본의 크기가 충분하다면, 표본평균 <span class="math inline">\(\bar X\)</span> 의 표집분포는 정규분포를 합니다. 그리고 표집분포의 평균 <span class="math inline">\(\mu_\bar X\)</span> 은 모집단의 평균 <span class="math inline">\(\mu\)</span> 과 같고, 표집분포의 표준편차 <span class="math inline">\(\sigma_\bar X\)</span> 는 모집단의 표준편차를 <span class="math inline">\(n\)</span> 으로 나눈 <span class="math inline">\(\frac{\sigma}{\sqrt n}\)</span>과 같습니다. 간단히 말해서:</p>
<ul>
<li>표본평균들의 평균은 모평균과 같다:</li>
</ul>
<p><span class="math display">\[ E(\bar X) = \mu_\bar X = \mu\]</span></p>
<ul>
<li>표본평균들의 표준편차는 모표준편차를 <span class="math inline">\(\sqrt n\)</span>으로 나눈 것과 같다:</li>
</ul>
<p><span class="math display">\[S(\bar X) = \sigma_\bar X = \frac{\sigma}{\sqrt n}\]</span></p>
<p>아래는 모집단에서 무한한 표본을 추출해서 평균의 표집분포를 만드는 그림입니다.</p>
<div id="fig-sampling-dis-mean" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/popul-sampling-distri-of-mean.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;8.9: 모집단과 평균의 표집분포</figcaption>
</figure>
</div>
<p>모집단이 정규분포를 하지 않을 때는 중심극한 정리에 따라 표본의 크기가 충분히 커지면, 약 30 이상이 되면, 표집분포는 정규분포에 근접하며 따라서 위의 공식을 동일하게 적용합니다. 즉 표본의 평균들은 정규분포를 합니다.</p>
<p>위에서 논의한 것은 모집단이 무한모집단일 경우를 가정한 것입니다. 무한모집단이 아닐 경우에 둘로 나뉩니다. 유한모집단이지만 <strong>복원추출</strong> sampling with replacement 을 한다면 무한모집단과 동일한 방식으로 적용할 수 있습니다. 복원추출은 표본을 뽑아도 그 표본이 모집단에 다시 그대로 복원된다는 가정을 하니까 무한모집단과 유사합니다. 문제가 되는 것은 <strong>비복원추출</strong> sampling without replacement 입니다. 유한한 모집단에서 표본을 뽑으면 모집단의 크기가 달라져서 일반적인 공식을 적용하지 못하고 보정을 해줘야 합니다.</p>
<ul>
<li>유한모집단 비복원추출일 경우에 아래의 공식을 적용한다.</li>
</ul>
<p><span class="math display">\[S(\bar X) =\sigma_\bar X = \frac{\sigma}{\sqrt n} \sqrt \frac{N-n}{N-1}\]</span></p>
<p>뒷부분인 <span class="math inline">\(\sqrt \frac{N-n}{N-1}\)</span>를 따로 <strong>유한모집단 수정계수</strong> finite population correction factor 라고 합니다.</p>
<p>표본을 조사해서 모평균 <span class="math inline">\(\mu\)</span> 을 추정하거나 검정할 때 정규분포를 사용합니다. 이때 모분산 <span class="math inline">\(\sigma^{2}\)</span> 이 필요한데 모분산은 통상 알려져 있지 않으므로 표준정규분포 <span class="math inline">\(Z=\frac{\bar X-\mu}{\sigma/\sqrt n}\)</span> 를 이용하기 어렵습니다. 하지만 정규분포의 모집단에서 나온 표본평균 <span class="math inline">\(\bar X\)</span>의 표집분포는 정규분포를 한다고 이미 알려졌고, 비정규분포 모집단의 표본평균도 중심극한 정리에 의해서 표본의 크기가 크다면 정규분포를 한다고 알려져서 문제가 없습니다. 왜냐하면 정규분포를 한다면 표본분산이 모분산과 유사하므로 대신 사용해도 문제가 적기 때문입니다. 표본의 크기가 30 이하일 때 충분히 크지 못하므로 표준정규분포인 z분포를 사용할 수 없는데 이때 자유도가 <span class="math inline">\(n-1\)</span> 인 t 분포를 사용합니다.</p>
<p>우리는 평균의 표집분포에서 표준편차를 계산할 때 모집단의 표준편차 <span class="math inline">\(\sigma\)</span> 를 사용해야 하지만 실제로는 모집단의 표준편차를 모르므로 표본의 표준편차 <span class="math inline">\(S\)</span> 를 사용합니다. 그래서 표본의 크기가 작아지면 오차의 가능성이 높아집니다. 그래서 표본의 크기가 적으면, 30 이하면, t 통계량을 사용합니다. <span class="math inline">\(t\)</span> 분포는 <span class="math inline">\(n-1\)</span> 의 자유도에 따라 분포가 약간씩 다릅니다.</p>
<p><span class="math display">\[\displaystyle  t= {\frac {{\bar {X}}-\mu_\bar X }{S_\bar X}}={\displaystyle {\frac {{\bar {X}}-\mu }{\frac{S}{\sqrt {n}}}}},   \]</span></p>
<p><span class="math display">\[ 여기서\; \;  \displaystyle S={\sqrt \frac {\sum _{i=1}^{n}(X_{i}-{\bar {X}})^{2}}{n-1}}   \]</span></p>
<p><span style="color:red">무한모집단, 유한모집단, 복원추출, 비복원추출, 유한모집단 수정계수, t 값</span></p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.3 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>모집단의 나이 평균이 40살이고 표준편차가 6살입니다. 크기가 40인 표본을 모두 추출해서 평균을 계산한다면, 그 표본평균들의 평균과 표준오차는 얼마가 될까요?</p>
</blockquote>
</div>
<p><strong>답:</strong> <span class="math inline">\(\mu_{\bar X}\)</span>=40, <span class="math inline">\(\sigma_{\bar X}\)</span>=0.9486833</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>$\mu_{\bar X}$=40, $\sigma_{\bar X}$=`r 6/sqrt(40)`</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="exr-sec-pro-exr5" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.5 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>모집단의 평균이 3이고 표준편차가 2일 때, 크기가 36인 표본의 평균의 표집분포 곡선을 그리세요.</p>
</blockquote>
</div>
<p><a href="solutions.html#sec-sol-pro-exr5">해답 가기</a></p>
<div id="exr-sec-pro-exr6" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.6 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>정규분포인 모집단에서 크기가 16인 표본을 추출하여 계산하니까 평균이 3이고 표준편차가 2가 나왔습니다. 이때 표본 평균의 표집분포 곡선을 그리세요.</p>
</blockquote>
</div>
<p><a href="solutions.html#sec-sol-pro-exr6">해답 가기</a></p>
</section>
<section id="평균-차이의-표집분포-두-모집단" class="level2" data-number="8.13">
<h2 data-number="8.13" class="anchored" data-anchor-id="평균-차이의-표집분포-두-모집단"><span class="header-section-number">8.13</span> 평균 차이의 표집분포; 두 모집단</h2>
<p>이번에는 모집단이 두 개 있을 때 평균 차이의 표집분포입니다. 평균이 각각 <span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span>이고 표준편차가 <span class="math inline">\(\sigma_1\)</span>, <span class="math inline">\(\sigma_2\)</span> 인 두개의 독립적인 모집단이 있다고 합시다. 또 그 모집단에서 각각 크기가 <span class="math inline">\(n_1\)</span>, <span class="math inline">\(n_2\)</span> 인 표본을 추출했다고 합시다. 만약 표본이 충분히 크다면 두 표본의 평균 차이인 <span class="math inline">\(\bar x_1-\bar x_2\)</span> 는 평균이 <span class="math inline">\(\mu_1-\mu_2\)</span>이고 표준편차가 <span class="math inline">\(\sqrt{\frac{\sigma_1^{2}}{n_1}+\frac{\sigma_2^{2}}{n_2}}\)</span> 인 정규분포를 합니다.</p>
<p>정리하면</p>
<p><span class="math display">\[ \mu_{\bar x_1-\bar x_2}=\mu_1-\mu_2 \]</span></p>
<p><span class="math display">\[ \sigma_{\bar x_1-\bar x_2} = \sqrt{\frac{\sigma_1^{2}}{n_1}+\frac{\sigma_2^{2}}{n_2}} \]</span></p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.4 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>모집단에서 남자의 나이 평균은 44살이고 표준편차는 6살, 여자의 나이 평균은 40살이고 표준편차는 4살입니다. 크기가 40인 표본을 남녀 별로 각각 추출해서 남녀 평균의 차이를 계산하는 걸 가능한 모든 경우에 실행한다면, 그 표본평균의 차이들의 평균과 표준오차는 얼마가 될까요?</p>
</blockquote>
</div>
<p><strong>답:</strong> <span class="math inline">\(\mu=44-40=4\)</span>, <span class="math inline">\(\sigma\)</span>=1.1401754</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>$\mu=44-40=4$,  $\sigma$=`r sqrt(6^2/40+4^2/40)`</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="exm-baro-wi" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.5 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>국민대학교 1학년과 2학년의 성적 차이를 추정하려고 합니다. 둘다 표본 크기는 40명씩입니다. 1학년 평균은 3.40이고 표준편차는 0.2, 2학년 평균은 3.55이고 표준편차는 0.22로 결과가 나왔습니다.</p>
<ol type="1">
<li>1학년과 2학년의 평균 차이의 평균은 얼마로 추정할 수 있을까요?</li>
<li>또 평균차이에 대한 표준오차는 얼마로 추정할 수 있을까요?</li>
</ol>
</blockquote>
</div>
<p><strong>답</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># collapse: true 이 옵션을 쓰면 결과가 붙어서 출력합니다. </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>m_1<span class="ot">&lt;-</span><span class="fl">3.40</span>   <span class="co"># 1학년</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sd_1 <span class="ot">&lt;-</span><span class="fl">0.2</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>n_1<span class="ot">&lt;-</span><span class="dv">40</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>m_2<span class="ot">&lt;-</span><span class="fl">3.55</span>   <span class="co"># 2학년</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>sd_2<span class="ot">&lt;-</span><span class="fl">0.22</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>n_2<span class="ot">&lt;-</span><span class="dv">40</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>m_diff<span class="ot">&lt;-</span>m_1<span class="sc">-</span>m_2   <span class="co"># 평균 차이</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">40</span><span class="sc">+</span>sd_2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">40</span>)   <span class="co"># 평균 차이의 표준오차</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(\mu_{\bar X1-\bar X2}=\)</span> = -0.15, <span class="math inline">\(\sigma_{\bar X1-\bar X2}\)</span>=0.0470106</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>$\mu_{\bar X1-\bar X2}=$ = `r m_diff`,   $\sigma_{\bar X1-\bar X2}$=`r se`</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="exr-sec-pro-exr7" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 8.7 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>바로 위의 <a href="#exm-baro-wi">Example&nbsp;<span>8.5</span></a> 자료를 이용하여 평균 차이의 분포 그래프를 그리세요.</p>
</blockquote>
</div>
<p><a href="solutions.html#sec-sol-pro-exr7">해답 가기</a></p>
</section>
<section id="분산의-표집분포-한-모집단" class="level2" data-number="8.14">
<h2 data-number="8.14" class="anchored" data-anchor-id="분산의-표집분포-한-모집단"><span class="header-section-number">8.14</span> 분산의 표집분포; 한 모집단</h2>
<p>분산의 표집분포는 <span class="math inline">\(\chi_2\)</span> 분포를 이용해서 알 수 있습니다.</p>
<ul>
<li>모집단의 분산</li>
</ul>
<p><span class="math display">\[ Var(X)= \sigma^{2} = \frac{\sum_{i=1}^{N}(X_i -\mu)^{2}}{N}\]</span></p>
<ul>
<li>표본의 분산</li>
</ul>
<p><span class="math display">\[ S^{2} = \frac{\sum_{i=1}^{n}(X_i -\bar X)^{2}}{n-1}\]</span></p>
<ul>
<li>카이제곱분포의 정의, 표준화한 변수 Z의 분산</li>
</ul>
<p><span class="math display">\[ Z \sim N(0, 1)일 때,\; \;  Z_1^{2}+Z_2^{2}+Z_3^{2}+ ... +Z_n^{2} \sim \chi^{2}(n) \]</span></p>
<ul>
<li>표본분산과 모분산의 관계</li>
</ul>
<p><span class="math display">\[ \displaystyle \chi^{2}= \frac{(n-1)S^{2}}{\sigma ^{2}} \sim \chi_{n-1}^{2} \]</span></p>
<p>즉 표본분산에 <span class="math inline">\(n-1\)</span>을 곱한 것을 모분산으로 나누면 <span class="math inline">\(\chi_2\)</span>값이 되고 이것은 자유도 <span class="math inline">\(n-1\)</span>의 <span class="math inline">\(\chi_2\)</span> 분포를 합니다. 따라서 표본분산과 모분산이 같아질수록 <span class="math inline">\(\chi_2\)</span>값은 <span class="math inline">\(n-1\)</span>에 근접합니다. 모분산이 크면 값이 작아지고, 표본분산이 크면 값이 커집니다. <span class="math inline">\(n\)</span>이 충분히 커지면, 즉 30이 넘으면 <span class="math inline">\(\chi_{2}\)</span>는 정규분포에 가까와집니다.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 8.6 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>모분산이 30일 때 크기가 16인 표본의 분산이 36보다 작을 확률은 얼마인가요?</p>
</blockquote>
</div>
<p><strong>답:</strong> 모분산과 표본분산의 관계는 위 공식처럼 자유도 <span class="math inline">\((n-1)\)</span>인 <span class="math inline">\(\chi^2\)</span> 분포를 따른다. 즉 <span class="math inline">\(\sigma^2\)</span>=30일 때 <span class="math inline">\(n\)</span>=16인 표본분산의 분포에서 <span class="math inline">\(S^2\)</span>=36인 값의 확률이 얼마인가하는 문제다. 공식에 대입하면,</p>
<p><span class="math display">\[ P \left( \chi^{2} \le \frac{(n-1)S^{2}}{\sigma ^{2}} \right) = P \left( \chi^{2} \le \frac{(16-1) 36}{30} \right) = P \left( \chi^{2} \le 18 \right)\]</span></p>
<p>따라서 자유도가 15이고 18보다 작은 <span class="math inline">\(\chi^2\)</span>값이 나올 (누적)확률은 0.7373344이다.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a># 답의 위 공식에서 큰 괄호를 집어넣는 방법: \left(    \right)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>$$ P \left( \chi^{2} \le \frac{(n-1)S^{2}}{\sigma ^{2}} \right) = P \left( \chi^{2} \le \frac{(16-1) 36}{30} \right) = P \left( \chi^{2} \le 18 \right) $$</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a># 원문에 R 함수를 넣어 결과를 출력하는 방법</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>따라서 자유도가 15이고 18보다 작은 $\chi^2$값이 나올 (누적)확률은 `r pchisq(18,15)`이다. </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="분산의-표집분포-두-모집단" class="level3" data-number="8.14.1">
<h3 data-number="8.14.1" class="anchored" data-anchor-id="분산의-표집분포-두-모집단"><span class="header-section-number">8.14.1</span> 분산의 표집분포; 두 모집단</h3>
<p>두 모집단의 분산 표집분포는 <span class="math inline">\(F\)</span> 분포를 이용해서 알 수 있습니다. 정규분포를 하며 각각 <span class="math inline">\(\sigma_1^{2}\)</span>, <span class="math inline">\(\sigma_2^{2}\)</span> 의 분산을 갖는 독립적인 두 모집단에서 각각 <span class="math inline">\(n_1\)</span>, <span class="math inline">\(n_2\)</span> 의 크기를 가진 표본을 뽑아 분산의 표집분포를 만들어봅시다. 두 표본분산을 각각 <span class="math inline">\(S_1\)</span>, <span class="math inline">\(S_1\)</span> 라고 할때 다음과 같은 관계가 형성됩니다.</p>
<p><span class="math display">\[ \displaystyle \chi_1^{2}= \frac{(n_1-1)S_1^{2}}{\sigma_1^{2}} \sim \chi^{2}(n-1) \]</span></p>
<p><span class="math display">\[ \displaystyle \chi_2^{2}= \frac{(n_2-1)S_2^{2}}{\sigma_2^{2}} \sim \chi^{2}(n-1) \]</span></p>
<p><span class="math display">\[\displaystyle \frac{\chi_1^{2}/v_1}{\chi_2^{2} / v_2} = \frac{S_1^{2}/\sigma_1^{2}}{S_2^{2}/\sigma_2^{2}} \sim F(v_1, v_2)\]</span> <span class="math display">\[ 위에서 \; \; v_1(자유도)=n_1-1, \; \; v_2(자유도)=n_2-1\]</span></p>
<p>여기에서 우리가 만일 두 모집단의 분산이 같다고 가정을 한다면 <span class="math inline">\((\sigma_1^{2}=\sigma_2^{2})\)</span> 위의 식은 아래처럼 간단해집니다.</p>
<p><span class="math display">\[ \frac{S_1^{2}}{S_2^{2}} \sim F(v_1, v_2) \]</span></p>
<p>위의 공식들에서 분자와 분모가 바뀌면 역수가 됩니다. 그래서 아래와 같은 공식이 성립합니다. 자유도의 순서가 바뀌는 걸 주의하세요.</p>
<p><span class="math display">\[ F_{\alpha} (v_1,v_2) = \frac{1}{F_{1-\alpha} (v_2, v_1)}  \]</span></p>
<p><span class="math inline">\(F\)</span> 분포도 표본 크기가 커지면 정규분포에 가까와집니다.</p>
</section>
</section>
<section id="sec-pro-n-1" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="sec-pro-n-1">왜 n이 아니고 n-1인가?</h2>
<p>확률 변수와 표집 분포를 배웠으니 이제 표본 표준편차가 왜 n이 아니라 n-1로 나누어야 하는지, 그 이유를 기대값을 사용해서 설명할 수 있게 되었습니다.</p>
<p><span class="math display">\[ E(S^{2})=E \Big[ \frac{\sum(x_i-\bar{x})^{2}}{n-1} \Big] = \frac{1}{n-1} E \Big[  \sum \big( \; (x_i - \mu) - (\bar{x}-\mu) \; \big)^{2} \Big] \]</span></p>
<p><span class="math display">\[ \; \; \; \; \; \; \; \; \; \; \; \; \; \; = \frac{1}{n-1} E \Big[  \sum \big( \; (x_i - \mu)^{2} - 2(x_i-\mu)(\bar{x}-\mu) + (\bar{x}-\mu)^{2} \; \big) \Big]  \]</span></p>
<p><span class="math display">\[ = \frac{1}{n-1} E \Big[  \sum (x_i - \mu)^{2} - n(\bar{x}-\mu)^{2} \; \Big] \; \; \; \; \; \; \; \; \; \;   \; \; \; \; \; \; \;  \]</span></p>
<p><span class="math display">\[ = \frac{1}{n-1} \sum E (x_i - \mu)^{2} - \frac{n}{n-1}E(\bar{x}-\mu)^{2} \; \Big]   \; \; \; \; \; \; \; \]</span></p>
<p><span class="math display">\[ = \frac{1}{n-1}n\sigma^{2} - \frac{n}{n-1}\sigma^{2}_\bar{x} \]</span></p>
<p><span class="math display">\[ = \frac{n}{n-1} \sigma^{2} - \frac{n}{n-1} \frac{\sigma^{2}}{n} \]</span></p>
<p><span class="math display">\[ = \frac{n}{n-1} \sigma^{2} - \frac{1}{n-1} \sigma^{2} \]</span></p>
<p><span class="math display">\[ = \sigma^{2} \; \; \; \; \; \;  \; \; \; \; \; \;  \;  \; \; \; \; \; \; \;  \; \; \; \; \; \; \]</span></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./exploratoy-analysis.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">탐색적 데이터 분석</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./inference-hypothesis.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">추정과 가설 검정</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>