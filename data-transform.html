<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="For the class: Statistics and Analysis with R &amp; Quarto">

<title>통계와 분석 - 5&nbsp; 데이터의 변환, 요약, 분석</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./descriptive-statistics.html" rel="next">
<link href="./write-quarto.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-transform.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">데이터의 변환, 요약, 분석</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">통계와 분석</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">안내</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">강의 소개</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">통계의 기초 개념</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R 기본</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./write-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quarto 사용하기</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-transform.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">데이터의 변환, 요약, 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">기술통계</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exploratoy-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">탐색적 데이터 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probabilistic-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">확률분포와 표집분포</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-hypothesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">추정과 가설 검정</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./categorical-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">범주형 자료분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variance-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">분산분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">선형 회귀분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">해답</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">참고문헌</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#데이터-프레임과-데이터-종류" id="toc-데이터-프레임과-데이터-종류" class="nav-link active" data-scroll-target="#데이터-프레임과-데이터-종류"><span class="header-section-number">5.1</span> 데이터 프레임과 데이터 종류</a>
  <ul class="collapse">
  <li><a href="#데이터-형과-데이터-구조" id="toc-데이터-형과-데이터-구조" class="nav-link" data-scroll-target="#데이터-형과-데이터-구조"><span class="header-section-number">5.1.1</span> 데이터 형과 데이터 구조</a></li>
  <li><a href="#테이블-종류" id="toc-테이블-종류" class="nav-link" data-scroll-target="#테이블-종류"><span class="header-section-number">5.1.2</span> 테이블 종류</a></li>
  </ul></li>
  <li><a href="#데이터프레임-안의-벡터" id="toc-데이터프레임-안의-벡터" class="nav-link" data-scroll-target="#데이터프레임-안의-벡터"><span class="header-section-number">5.2</span> 데이터프레임 안의 벡터</a>
  <ul class="collapse">
  <li><a href="#벡터와-요소에-접근하기" id="toc-벡터와-요소에-접근하기" class="nav-link" data-scroll-target="#벡터와-요소에-접근하기"><span class="header-section-number">5.2.1</span> 벡터와 요소에 접근하기</a></li>
  <li><a href="#기호-사용" id="toc-기호-사용" class="nav-link" data-scroll-target="#기호-사용"><span class="header-section-number">5.2.2</span> “$” 기호 사용</a></li>
  <li><a href="#조건-사용하기" id="toc-조건-사용하기" class="nav-link" data-scroll-target="#조건-사용하기"><span class="header-section-number">5.2.3</span> 조건 사용하기</a></li>
  </ul></li>
  <li><a href="#sec-tra-list" id="toc-sec-tra-list" class="nav-link" data-scroll-target="#sec-tra-list"><span class="header-section-number">5.3</span> 리스트</a></li>
  <li><a href="#sec-tra-get-data" id="toc-sec-tra-get-data" class="nav-link" data-scroll-target="#sec-tra-get-data"><span class="header-section-number">5.4</span> 데이터 가져오기</a>
  <ul class="collapse">
  <li><a href="#csv-파일-가져오기" id="toc-csv-파일-가져오기" class="nav-link" data-scroll-target="#csv-파일-가져오기"><span class="header-section-number">5.4.1</span> csv 파일 가져오기</a></li>
  <li><a href="#sec-tra-get-excel" id="toc-sec-tra-get-excel" class="nav-link" data-scroll-target="#sec-tra-get-excel"><span class="header-section-number">5.4.2</span> 엑셀 파일 가져오기</a></li>
  </ul></li>
  <li><a href="#데이터의-저장과-내보내기" id="toc-데이터의-저장과-내보내기" class="nav-link" data-scroll-target="#데이터의-저장과-내보내기"><span class="header-section-number">5.5</span> 데이터의 저장과 내보내기</a>
  <ul class="collapse">
  <li><a href="#데이터를-내보내기" id="toc-데이터를-내보내기" class="nav-link" data-scroll-target="#데이터를-내보내기"><span class="header-section-number">5.5.1</span> 데이터를 내보내기</a></li>
  <li><a href="#r-데이터의-저장과-불러오기" id="toc-r-데이터의-저장과-불러오기" class="nav-link" data-scroll-target="#r-데이터의-저장과-불러오기"><span class="header-section-number">5.5.2</span> R 데이터의 저장과 불러오기</a></li>
  </ul></li>
  <li><a href="#rstudioquarto-프로젝트-만들기" id="toc-rstudioquarto-프로젝트-만들기" class="nav-link" data-scroll-target="#rstudioquarto-프로젝트-만들기"><span class="header-section-number">5.6</span> RStudio/Quarto 프로젝트 만들기</a></li>
  <li><a href="#sec-tra-tte" id="toc-sec-tra-tte" class="nav-link" data-scroll-target="#sec-tra-tte"><span class="header-section-number">5.7</span> t 검정 실행하기</a></li>
  <li><a href="#sec-tra-lm" id="toc-sec-tra-lm" class="nav-link" data-scroll-target="#sec-tra-lm"><span class="header-section-number">5.8</span> 선형 회귀분석 모델</a></li>
  <li><a href="#집단-별로-요약하기" id="toc-집단-별로-요약하기" class="nav-link" data-scroll-target="#집단-별로-요약하기"><span class="header-section-number">5.9</span> 집단 별로 요약하기</a></li>
  <li><a href="#파이프를-이용하기" id="toc-파이프를-이용하기" class="nav-link" data-scroll-target="#파이프를-이용하기"><span class="header-section-number">5.10</span> %&gt;% 파이프를 이용하기</a>
  <ul class="collapse">
  <li><a href="#파이프" id="toc-파이프" class="nav-link" data-scroll-target="#파이프"><span class="header-section-number">5.10.1</span> 파이프</a></li>
  </ul></li>
  <li><a href="#두-개의-r-base-and-tidyverse" id="toc-두-개의-r-base-and-tidyverse" class="nav-link" data-scroll-target="#두-개의-r-base-and-tidyverse"><span class="header-section-number">5.11</span> 두 개의 R: Base and tidyverse</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-tra" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">데이터의 변환, 요약, 분석</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>대부분 데이터셋은 행과 열을 가진 테이블 형태로 저장됩니다. 이 장에서는 R을 이용할 때 그런 데이터를 가져오고 내보내며 저장하는 방법을 배웁니다. 데이터를 변환하고 요약하며 분석하는 방법도 배울 거에요. 분석은 뒷장에서 자세히 배울 테니 이 장에서는 그저 맛보기로만 다룹니다. 이 장의 목적은 데이터 다루는 걸 전체적으로 한 번 빠르게 경험하고 지나가는 겁니다.</p>
<section id="데이터-프레임과-데이터-종류" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="데이터-프레임과-데이터-종류"><span class="header-section-number">5.1</span> 데이터 프레임과 데이터 종류</h2>
<section id="데이터-형과-데이터-구조" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="데이터-형과-데이터-구조"><span class="header-section-number">5.1.1</span> 데이터 형과 데이터 구조</h3>
<p>데이터 종류가 다르면 사용하는 통계 방법도 달라집니다. 숫자형 데이터를 이용하여 우리는 박스플롯을 그리고 평균을 계산합니다. 범주형 데이터를 이용하여 우리는 막대 그래프를 그리고 빈도표를 보여줍니다. 당연히 R도 데이터 종류가 다르면 다르게 다룹니다.</p>
<p>R은 6가지 <strong>데이터 형</strong> data type 이 있습니다. 대개는 앞 세 개만 알면 됩니다.</p>
<ul>
<li><strong>숫자형 numeric</strong> : 숫자 1 또는 35.124 (<code>double</code>)</li>
<li><strong>논리형 logical</strong> : 참/거짓 값을 가진다. <code>TRUE</code> 또는 <code>FALSE</code></li>
<li><strong>문자형 character</strong> : 문자 “b” , “여자” “경기도”</li>
<li>정수형 integer : 정수. R에서 L로 표시한다: 1L, 45L</li>
<li>허수형 complex : 허수. 2+3i</li>
<li>raw : raw bytes. 거의 이것을 사용할 일이 없다.</li>
</ul>
<p>이런 데이터형들이 모여서 <strong>데이터 구조</strong> data structure 를 만듭니다. 데이터 구조는 벡터, 데이터 프레임, 팩터 factor, POSIXct 등을 말합니다. POSIXct 는 날짜와 시간을 저장하는 방식입니다.</p>
<p>R에서 작업의 대상을 <strong>객체</strong> object 라고 부르는데 객체는 변수, 벡터, 데이터 프레임, 플롯 등등이 있습니다. 객체가 어떤 종류인지 알려면 <code>typeof</code>나 <code>class</code> 함수를 씁니다. <code>typeof</code>는 데이터 저장형태를 알려주는데 초점이 있고 <code>class</code>는 해당 데이터를 관리하는 방식에 초점이 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">6</span>  </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">"파랑"</span>  </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>하 <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(x)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># 줄바꿈</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(y)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(y)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)  <span class="co"># 줄바꿈</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(하)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(하)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"
[1] "numeric"

[1] "character"
[1] "character"

[1] "logical"
[1] "logical"</code></pre>
</div>
</div>
<p>데이터 구조가 벡터일 때는 데이터형이 뭐로 나올까요? 숫자형만 있을 때는 당연히 numeric 으로 나옵니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>나벡터 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(나벡터)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<p>벡터에 숫자형, 문자형, 논리형 등 여러 데이터형을 섞어 넣으면 어떻게 될까요? 문자형이 벡터에 포함되면, R은 벡터에 포함한 모든 객체를 강제로 문자형 데이터로 만듭니다. 숫자형이나 논리형은 문자형으로 전환이 가능하지만, 문자형은 숫자형으로 전환이 불가능하기 때문입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>all_together <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="st">"파랑"</span>, <span class="cn">TRUE</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>all_together</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(all_together)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "6"    "파랑" "TRUE"
[1] "character"</code></pre>
</div>
</div>
<p>만일 숫자형과 논리형 데이터만 포함한다면 어떨까요? 그러면 R이 숫자형 데이터로 통일합니다. FALSE는 0, TRUE는 1 이 됩니다. 역시 논리형은 숫자형으로 전환이 가능하지만 숫자는 그렇지 못하기 때문입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>숫자_논리 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="cn">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>숫자_논리</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(숫자_논리)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5 1
[1] "numeric"</code></pre>
</div>
</div>
<p>이렇게 다른 결과가 나오니까 벡터에 다른 종류의 데이터형을 섞을 때 주의해서 사용해야 합니다. 벡터는 그 안에 포함한 데이터가 모두 동일한 종류 class 입니다. 만일 다른 종류가 섞였으면 통일이 가능한 쪽으로 강제로 한 종류로 통일합니다.</p>
</section>
<section id="테이블-종류" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="테이블-종류"><span class="header-section-number">5.1.2</span> 테이블 종류</h3>
<p>R에서 사용하는 거의 모든 데이터 분석을 위한 데이터 구조는 데이터프레임입니다. 열과 행을 지닌 테이블의 한 종류입니다. 아래처럼 벡터에서 데이터프레임을 만들어 봅니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>이름 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"김"</span>, <span class="st">"이"</span>, <span class="st">"권"</span>, <span class="st">"박"</span>, <span class="st">"류"</span>, <span class="st">"홍"</span>, <span class="st">"차"</span>, <span class="st">"길"</span>, <span class="st">"천"</span> )</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>나이 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">48</span>, <span class="dv">47</span>, <span class="dv">71</span>, <span class="dv">22</span>, <span class="dv">80</span>, <span class="dv">48</span>, <span class="dv">30</span>, <span class="dv">31</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>구매 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">59</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">160</span>, <span class="dv">34</span>, <span class="dv">34</span>, <span class="dv">29</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>서점 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(이름, 나이, 구매)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>서점</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  이름 나이 구매
1   김   28   20
2   이   48   59
3   권   47    2
4   박   71   12
5   류   22   22
6   홍   80  160
7   차   48   34
8   길   30   34
9   천   31   29</code></pre>
</div>
</div>
<p>데이터프레임은 각 열(세로 줄) column 이 변수를 나타내고 각 행(가로 줄) row 이 사례를 나타내는 테이블입니다. 이런 테이블에서 변수는 열과 동일하게 여겨집니다.</p>
<p>테이블의 종류는 대개 네 가지가 있습니다.</p>
<ul>
<li><strong>행렬</strong> matrix : 모든 열이 동일한 종류의 객체를 가집니다. 즉 모두 숫자형이거나 모두 문자형이거나. 메모리 용량도 작고 계산도 빠릅니다.</li>
<li><strong>데이터.프레임</strong> data.frame : 가장 보편적 형태. 데이터프레임의 다른 열은 다른 종류를 가질 수 있습니다. 즉 숫자형의 열, 문자형의 열 등.</li>
<li><strong>데이터.테이블</strong> data.table : 개선한 형태의 데이터프레임</li>
<li><strong>티블</strong> tbl_df (tibble) : 또 다른 개선한 형태의 데이터프레임</li>
</ul>
<p>우선 대부분 경우에 이 네 가지는 매우 유사해서 이들 중 어느 것을 사용하던 이용자는 별로 구분할 필요가 없습니다. 예를 볼까요? R 기본에 있는 데이터셋 두 개입니다.</p>
<p>매트릭스 형태입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>?WorldPhones</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(WorldPhones)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(WorldPhones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터 프레임입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>?airquality</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(airquality)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>티블입니다. <code>ggplot2</code> 패키지에서 데이터셋을 불러와서 살펴봅니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>?msleep</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(msleep)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(msleep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>데이터셋은 다른 종류로 변환이 가능합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>WorldPhonesDF <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(WorldPhones)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(WorldPhonesDF)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>airqualityMatrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(airquality)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(airqualityMatrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"
[1] "matrix" "array" </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
데이터 변환하면 속성만 바뀌고 구조는 그대로
</div>
</div>
<div class="callout-body-container callout-body">
<p>변환할 때 객체의 속성만 변환하고 실제 테이블 형태는 변환되지 않아요. WorldPhones 매트릭스가 WorldPhonesDF 데이터프레임으로 속성은 변환되었지만 자료 구성 형태는 그대로 있으므로 통계프로그램에 사용하지 못해요. 일반적인 데이터셋 형태로 자료 구성 구조를 바꾸어야 합니다.</p>
</div>
</div>
<p>아래는 WorldPhone 데이터를 이용해서 비교한 것입니다. 왼쪽이 원래 매트릭스 구조이고 이걸 <code>as.data.frame</code> 함수을 사용해서 변환해도 속성만 매트릭스에서 데이터프레임으로 바뀌고 구조는 아래 왼쪽 테이블과 동일하게 유지합니다.</p>
<p>이걸 통계에 사용하는 데이터 구조로 바꾸려면 오른쪽처럼 다시 정리해야 합니다. 네 번 관찰이므로 사례가 넷입니다. 북아메리가에서 1951년에 한 번 관찰, 1956년에 또 관찰. 유럽에서 1951년에 한 번 관찰, 1956년에 또 관찰. 그래서 관찰값(사례)이 네 개가 됩니다.</p>
<div id="tbl-comparison-mat-usual" class="tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;5.1: 매트릭스 구조와 통계분석에 사용하는 일반적 테이블 구조의 비교</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-comparison-mat-usual-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-comparison-mat-usual" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(a) 원래 매트릭스 구조</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;">N.Amer</th>
<th style="text-align: left;">Europe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1951</td>
<td style="text-align: left;">|</td>
<td style="text-align: left;">45939</td>
<td style="text-align: left;">21574</td>
</tr>
<tr class="even">
<td style="text-align: left;">1956</td>
<td style="text-align: left;">|</td>
<td style="text-align: left;">60423</td>
<td style="text-align: left;">29990</td>
</tr>
</tbody>
</table>
</div>
<div id="tbl-comparison-mat-usual-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-comparison-mat-usual" style="flex-basis: 50.0%;justify-content: center;">
<table class="table">
<caption>(b) 통계에 사용하는 구조</caption>
<thead>
<tr class="header">
<th style="text-align: left;">번호</th>
<th style="text-align: left;">전화대수</th>
<th style="text-align: left;">지역</th>
<th style="text-align: left;">연도</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">45939</td>
<td style="text-align: left;">N.Amer</td>
<td style="text-align: left;">1951</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">60423</td>
<td style="text-align: left;">N.Amer</td>
<td style="text-align: left;">1956</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">21574</td>
<td style="text-align: left;">Europe</td>
<td style="text-align: left;">1951</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">29990</td>
<td style="text-align: left;">Europe</td>
<td style="text-align: left;">1956</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="데이터프레임-안의-벡터" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="데이터프레임-안의-벡터"><span class="header-section-number">5.2</span> 데이터프레임 안의 벡터</h2>
<p>여기서는 뉴욕의 대기 질을 조사한 <code>airquality</code> 데이터셋을 이용합니다.</p>
<section id="벡터와-요소에-접근하기" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="벡터와-요소에-접근하기"><span class="header-section-number">5.2.1</span> 벡터와 요소에 접근하기</h3>
<p><a href="base-r.html"><span>3</span></a> 장의 <a href="base-r.html#sec-bas-numeric">숫자형 자료</a> 에서 <code>mean</code> 함수를 사용해서 벡터의 평균을 계산하는 법을 배웠습니다. 이번에는 데이터프레임 속의 벡터의 평균을 계산하는 걸 배워봅시다. 데이터프레임 속의 벡터는 이렇게 표현합니다: <code>데이터프레임_이름$벡터_이름</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(airquality<span class="sc">$</span>Temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 77.88235</code></pre>
</div>
</div>
<p>벡터 속의 요소 하나를 끄집어내려면 요소의 번호를 특정합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>airquality<span class="sc">$</span>Temp[<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56</code></pre>
</div>
</div>
<p>데이터셋에서 벡터를 특정하지 않고 행과 열 번호만으로 요소를 끄집어낼 수 있어요. 우선 <code>airquality</code> 데이터셋의 벡터(변수)가 어떤 순서인지 알아봅니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(airquality)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ozone"   "Solar.R" "Wind"    "Temp"    "Month"   "Day"    </code></pre>
</div>
</div>
<p>결과에서 Temp가 넷째 열이라는 것을 알았습니다. 우리가 원하는 건 Temp의 5번째 요소입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>airquality[<span class="dv">5</span>, <span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56</code></pre>
</div>
</div>
<p>아래처럼 요소를 끄집어내는 방법은 다양합니다.</p>
<ul>
<li><code>airquality[5, 4]</code> 5번째 행, 4번째 열 요소</li>
<li><code>airquality[5,]</code> 5번째 행 전부</li>
<li><code>airquality[,4]</code> 4번째 열 전부</li>
<li><code>airquality[[4]]</code> 4번째 열 전부</li>
<li><code>airquality[, c(2, 4, 6)]</code> 둘째, 넷째, 여섯째 열 전부</li>
<li><code>airquality[, -2]</code> 둘째 열을 뺀 나머지 열 전부</li>
<li><code>airquality[, c("Temp", "Wind")]</code> <code>Temp</code>와 <code>Wind</code> 열 전부</li>
</ul>
</section>
<section id="기호-사용" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="기호-사용"><span class="header-section-number">5.2.2</span> “$” 기호 사용</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>나이 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">48</span>, <span class="dv">47</span>, <span class="dv">71</span>, <span class="dv">22</span>, <span class="dv">80</span>, <span class="dv">48</span>, <span class="dv">30</span>, <span class="dv">31</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>구매 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">59</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">160</span>, <span class="dv">34</span>, <span class="dv">34</span>, <span class="dv">29</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>서점 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(나이, 구매)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>서점<span class="sc">$</span>나이[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">18</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>서점<span class="sc">$</span>나이</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28 18 47 71 22 80 48 30 31</code></pre>
</div>
</div>
<p>위에서 <code>나이</code>의 둘째 요소가 48 <span class="math inline">\(\rightarrow\)</span> 18 로 바뀌었어요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>서점<span class="sc">$</span>나이 <span class="ot">&lt;-</span> 서점<span class="sc">$</span>나이 <span class="sc">*</span> <span class="dv">12</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>서점<span class="sc">$</span>나이</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 336 216 564 852 264 960 576 360 372</code></pre>
</div>
</div>
<p>나이가 몇 년에서 몇 개월로 단위가 바뀌었어요.</p>
<p>데이터프레임에 벡터(변수)를 추가해볼게요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>서점<span class="sc">$</span>방문_기간 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">12</span>, <span class="dv">31</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>서점</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  나이 구매 방문_기간
1  336   20         5
2  216   59         2
3  564    2        20
4  852   12        22
5  264   22        12
6  960  160        31
7  576   34         9
8  360   34        10
9  372   29        11</code></pre>
</div>
</div>
</section>
<section id="조건-사용하기" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="조건-사용하기"><span class="header-section-number">5.2.3</span> 조건 사용하기</h3>
<p>최대값을 알고 싶을 때</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(airquality<span class="sc">$</span>Temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 97</code></pre>
</div>
</div>
<p>최대값이 어디 있는지 알고 싶을 때</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(airquality<span class="sc">$</span>Temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 120</code></pre>
</div>
</div>
<p><code>Temp</code>의 요소가 90 이상인지 알고싶을 때. 각 요소가 90이상이면 <code>TRUE</code>, 아니면 <code>FALSE</code> 값을 되줍니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [13] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [25] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [37] FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
 [49] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [61] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE FALSE FALSE
 [73] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
 [97] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
[109] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
[121]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
[133] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
[145] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
</div>
</div>
<p>아래는 데이터셋에서 <code>Temp</code>가 90 이상인 사례만 뽑아서 볼 때</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>airquality[airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Ozone Solar.R Wind Temp Month Day
42     NA     259 10.9   93     6  11
43     NA     250  9.2   92     6  12
69     97     267  6.3   92     7   8
70     97     272  5.7   92     7   9
75     NA     291 14.9   91     7  14
102    NA     222  8.6   92     8  10
120    76     203  9.7   97     8  28
121   118     225  2.3   94     8  29
122    84     237  6.3   96     8  30
123    85     188  6.3   94     8  31
124    96     167  6.9   91     9   1
125    78     197  5.1   92     9   2
126    73     183  2.8   93     9   3
127    91     189  4.6   93     9   4</code></pre>
</div>
</div>
<p><code>Temp</code> 가 90도 이상인 사례/행 번호들을 되줍니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  42  43  69  70  75 102 120 121 122 123 124 125 126 127</code></pre>
</div>
</div>
<p>아래는 <code>Temp</code>의 모든 요소가 90이상이면 TRUE, 아니면 FALSE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">all</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>하나라도 90 이상이면 <code>TRUE</code>, 아니면 <code>FALSE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>아래는 <code>Temp</code> 요소 중에서 90 이상인 것의 비율. 왜냐면 <code>TRUE</code>는 1, <code>FALSE</code>는 0으로 하여 평균을 계산하니 그게 비율이 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09150327</code></pre>
</div>
</div>
</section>
</section>
<section id="sec-tra-list" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-tra-list"><span class="header-section-number">5.3</span> 리스트</h2>
<p><strong>리스트</strong> list 는 벡터나 데이터프레임처럼 데이터 구조 형태의 하나입니다. 벡터나 데이터프레임이 일정한 틀을 갖는데 비해서 리스트는 좀 형태가 난잡합니다. 아무거나 넣는 형태라고 할까요? 아래의 리스트 예를 봅시다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>li <span class="ot">&lt;-</span> <span class="fu">list</span>(보호자<span class="ot">=</span><span class="st">"영희"</span>, 아이_수<span class="ot">=</span><span class="dv">3</span>, 아이_나이<span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">9</span>), 아이_이름<span class="ot">=</span><span class="fu">c</span>(<span class="st">"수동"</span>, <span class="st">"길동"</span>, <span class="st">"신혜"</span>) )</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>li</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$보호자
[1] "영희"

$아이_수
[1] 3

$아이_나이
[1] 4 7 9

$아이_이름
[1] "수동" "길동" "신혜"</code></pre>
</div>
</div>
<p>리스트 변수인 <code>li</code>는 그 안에 네 개의 데이터를 품고 있는데 심지어 이름도 붙어 있습니다. 네 개의 데이터 형태는 문자형, 숫자형, 벡터, 벡터 등입니다. 이런 리스트 형태는 나중에 분산분석이나 회귀분석 등의 R 통계함수 결과를 변수로 되줄 때 그 변수의 형태가 주로 리스트입니다.</p>
<p>리스트 등 변수가 생기면 환경 패널에 나타나므로 그것을 보고 요소를 찾을 수 있습니다. 예를 들어, 위의 <code>li$아이_수</code>의 값을 부르려면 <code>li[[2]]</code> 또는 <code>li[["아이_수"]]</code>로 표시합니다. 위의 <code>li$아이_나이</code>의 둘째 요소 값을 구하려면 <code>li[[3]][2]</code>로 표기합니다.</p>
<div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>li[<span class="dv">2</span>]             <span class="co"># 괄호가 하나면 이름과 값을 되준다</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>li[[<span class="dv">2</span>]]           <span class="co"># 괄호가 둘이면 값을 되준다</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>li[[<span class="st">"아이_수"</span>]]   <span class="co"># 번호 대신 요소 이름을 적어도 된다</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>li[[<span class="dv">3</span>]][<span class="dv">2</span>]        <span class="co"># 요소가 벡터일 때 그 안의 하위요소 값을 추출한다 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>$아이_수
[1] 3</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>[1] 3</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>[1] 7</code></pre>
</div>
</div>
</div>
</div>
<p>참고로 여러 데이터 형태를 간단히 보면 (청크 옵션 <code>layout-ncol: 4</code> )</p>
<div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ve <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)  <span class="co"># 벡터</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>ve</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>), <span class="at">nrow=</span><span class="dv">2</span>)  <span class="co"># 매트릭스</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>ma</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>li <span class="ot">&lt;-</span> <span class="fu">list</span>(보호자<span class="ot">=</span><span class="st">"영희"</span>, 아이_수<span class="ot">=</span><span class="dv">3</span>, 아이_나이<span class="ot">=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">9</span>), 아이_이름<span class="ot">=</span><span class="fu">c</span>(<span class="st">"수동"</span>, <span class="st">"길동"</span>, <span class="st">"신혜"</span>) )  <span class="co"># 리스트</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>li</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>키 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">174</span>, <span class="dv">182</span>, <span class="dv">167</span>, <span class="dv">164</span>, <span class="dv">161</span>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>무게 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">72</span>, <span class="dv">74</span>, <span class="dv">65</span>, <span class="dv">62</span>, <span class="dv">59</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>da <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(키, 무게)  <span class="co"># 데이터 프레임</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>da</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>     [,1] [,2]
[1,]    5    7
[2,]    6    8</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>$보호자
[1] "영희"

$아이_수
[1] 3

$아이_나이
[1] 4 7 9

$아이_이름
[1] "수동" "길동" "신혜"</code></pre>
</div>
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 25.0%;justify-content: center;">
<pre><code>   키 무게
1 174   72
2 182   74
3 167   65
4 164   62
5 161   59</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="sec-tra-get-data" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sec-tra-get-data"><span class="header-section-number">5.4</span> 데이터 가져오기</h2>
<p>R에서 간단한 변수를 만들거나 또는 내장된 데이터셋을 가져와 사용할 수 있습니다. 그러나 통계분석의 대부분은 외부에서 데이터를 가져와 분석합니다. 많이 사용되는 형태는 .csv 이거나 .xlsx 입니다. .csv 파일은 쉼표로 값을 구분하는 파일이고 .xlsx 파일은 엑셀 파일입니다.</p>
<section id="csv-파일-가져오기" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="csv-파일-가져오기"><span class="header-section-number">5.4.1</span> csv 파일 가져오기</h3>
<p>파일을 R에 가져오려면 그 파일의 경로를 지정하거나 <strong>작업 폴더</strong> working firectory 에 존재해야 합니다. 작업폴더와 경로를 보려면 콘솔 패널에 아래 코드를 칩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/Choon/Naver MYBOX/Quarto/StaAna-QBook"</code></pre>
</div>
</div>
<p>작업 폴더를 지정할 때 <code>setwd</code> 를 사용하거나 또는 메뉴의 <strong>Session &gt; Set Working Directory &gt; Choose Directory</strong>를 사용합니다. 또는 파일 패널의 파일 탭에서 맨 오른쪽의 …을 클릭해서 원하는 폴더로 가고, 중간의 톱니바퀴를 클릭해서 Set as Working Directory 를 선택합니다.</p>
<p>요즘에는 csv 파일도 엑셀을 사용해서 만들고 저장하고 수정할 수 있어서 편합니다. 아래처럼 코드를 이용하여 외부 데이터를 가져와 내부 데이터셋으로 지정합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>imported_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../file_name.csv"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>더 편한 방법이 있어요. 파일 패널 창의 (주로 오른쪽 아래 창) 메뉴에서 …를 클릭해서 열려는 파일이 있는 폴더로 갑니다. 그리고 그 파일을 클릭하면 메뉴 창이 뜨는데 Import Dataset를 선택합니다. 이때 파일 이름이 데이터셋 이름이 되는데 수정해도 됩니다.</p>
<p>인터넷에서 다운받을 수 있습니다. 아래는 WHO 세계보건기구의 결핵 보고서입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># WHO 결핵 데이터 다운받기</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>tb_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://tinyurl.com/whotbdata"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sec-tra-get-excel" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="sec-tra-get-excel"><span class="header-section-number">5.4.2</span> 엑셀 파일 가져오기</h3>
<p>우리가 흔히 사용하는 엑셀 파일을 가져와 내부 데이터셋으로 만듭니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("openxlsx")</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>imported_from_Excel <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"../file_name.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기에서도 더 편한 방법이 있어요. 파일 패널 메뉴의 …를 이용해서 가져오려는 파일이 있은 폴더로 이동한 다음에 그 파일을 클릭하면 메뉴 창이 나옵니다. 그때 Import Dataset를 선택하면 됩니다. 이때 필요한 패키지가 없으면 자동적으로 그 패키지를 설치합니다. 이때 아마도 설치되는 건 <code>readxl</code> 패키지고 명령어는 <code>read_excel</code>입니다.</p>
<p>데이터를 다운받으면 아래처럼 함수를 이용해서 파일을 획인해 보는 습관을 갖는 게 좋습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(imported_from_Excel)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(imported_from_Excel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="데이터의-저장과-내보내기" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="데이터의-저장과-내보내기"><span class="header-section-number">5.5</span> 데이터의 저장과 내보내기</h2>
<p>R에서 데이터를 저장하거나 내보낼 때 .csv 파일이나 .xlsx 또는 .RData를 사용합니다.</p>
<section id="데이터를-내보내기" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="데이터를-내보내기"><span class="header-section-number">5.5.1</span> 데이터를 내보내기</h3>
<p>먼저 데이터를 만듭니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">28</span>, <span class="dv">48</span>, <span class="dv">47</span>, <span class="dv">71</span>, <span class="dv">22</span>, <span class="dv">80</span>, <span class="dv">48</span>, <span class="dv">30</span>, <span class="dv">31</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>purchase <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">59</span>, <span class="dv">2</span>, <span class="dv">12</span>, <span class="dv">22</span>, <span class="dv">160</span>, <span class="dv">34</span>, <span class="dv">34</span>, <span class="dv">29</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>bookstore <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(age, purchase)  <span class="co"># 두 변수의 요소 숫자가 일치해야 한다</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>.csv 파일로 외부에 내보냅니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(bookstore, <span class="st">"bookstore.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>.xlsx 파일로 외부에 내보냅니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(bookstore, <span class="st">"bookstore.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-데이터의-저장과-불러오기" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="r-데이터의-저장과-불러오기"><span class="header-section-number">5.5.2</span> R 데이터의 저장과 불러오기</h3>
<p>RData 형태로 저장하고 불러오는 방법이에요. 위의 bookstore 데이터셋을 저장하는 걸 예로 듭니다.</p>
<p>(만일 R을 새로 시작했으면 위에서 <code>bookstore</code>를 생성해 주세요.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(bookstore, age, <span class="at">file =</span> <span class="st">"myData.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>모든 것(모든 객체)을 저장할 때는 <code>save.image</code> 를 사용합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="at">file =</span> <span class="st">"allMyData.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>저장한 객체를 불러올 때는 <code>load</code> 함수를 사용합니다. 외부 파일은 형태가 외부에서 규정한 것(.csv, xlsx 등)이지만 객체는 R에서 규정한 형식이므로 불러오면 바로 사용할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">"myData.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="rstudioquarto-프로젝트-만들기" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="rstudioquarto-프로젝트-만들기"><span class="header-section-number">5.6</span> RStudio/Quarto 프로젝트 만들기</h2>
<p>각 데이터 분석마다 새 폴더를 만들어서 코드, 데이터, 분석결과 outputs 등을 저장하는 게 좋습니다. RStudio에서는 새 프로젝트를 생성하면 새 폴더를 만들어 거기에 프로젝트를 연결시킵니다. 그래서 그 프로젝트를 불러오면 자동으로 그 폴더가 작업 폴더가 됩니다. 프로젝트에서 생성하는 프로그램과 자료, 글, 데이터 등이 언제나 연관된 프로젝트 폴더에 저장이 되므로 편리하고 혼동되지 않습니다. 여러 프로젝트를 실행하면 여러 작업폴더를 각각 사용할 수 있습니다.</p>
<p>새 프로젝트를 만들려면 메뉴에서 <strong>File &gt; New Project</strong> 를 선택하면 됩니다. 새 프로젝트는 기존의 폴더와 연관할 수 있고 또는 새 폴더를 만들어 연관한 수 있습니다. 프로젝트 파일은 .Rproj 입니다.</p>
<p>프로젝트를 실행할 때, 데이터를 하위 폴더에 저장하면 좋아요. 이때 상대적 경로를 변수로 지정하면 편하게 사용합니다. 상대적 경로란 <code>작업폴더</code>까지는 적을 필요가 없고 하위 폴더와 파일 이름만 적으면 된다는 의미입니다. 예를 들어.</p>
<p><code>file_path &lt;- "하위폴더_이름/bookstore.csv"</code></p>
<p>이것은 작업폴더 아래의 <code>하위폴더_이름</code> 폴더에 있는 <code>bookstore.csv</code> 파일을 <code>file_path</code> 란 변수에 저장하는 명령입니다. 앞으로 file_path를 사용하면 그 파일을 불러올 수 있습니다.</p>
<p>만일 현재 작업폴더의 상위 폴더에 데이터 파일이 존재한다면 아래처럼 코드를 실행해서 상대경로를 file_path 변수에 저장합니다. 현재 폴더의 상위 폴더는 “..”라고 표현합니다.</p>
<p><code>file_path &lt;- "../bookstore.csv"</code></p>
</section>
<section id="sec-tra-tte" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="sec-tra-tte"><span class="header-section-number">5.7</span> t 검정 실행하기</h2>
<p>R은 통계적 가설 검정을 위한 함수를 많이 보유합니다. 앞으로 자세한 것을 배우지만 여기서는 간단한 t 검정을 실시합니다. t 검정은 Student t-test 라고 불립니다. t 검정은 두 표본 집단의 평균 차이가 단순한 우연인지 아니면 정말로 의미있는 차이인지 확률적으로 검정하는 통계기법입니다.</p>
<p>육식동물(canivores)과 초식동물(herbivores)의 잠 시간 평균을 비교한다고 합시다. <code>ggplot2</code> 패키지의 <code>msleep</code> 데이터셋을 사용하고 두 벡터 변수를 투입합니다. <code>vore</code> 변수는 carni(육식)과 herbi(초식)의 두 종류 동물 집단을 대표하는 두 개 변수값을 가지고 <code>sleep_total</code>은 잠 시간을 측정한 숫자값을 변수값으로 가집니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>육식동물 <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">"carni"</span>,]</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>초식동물 <span class="ot">&lt;-</span> msleep[msleep<span class="sc">$</span>vore <span class="sc">==</span> <span class="st">"herbi"</span>,]</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(육식동물<span class="sc">$</span>sleep_total, 초식동물<span class="sc">$</span>sleep_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  육식동물$sleep_total and 초식동물$sleep_total
t = 0.63232, df = 39.31, p-value = 0.5308
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -1.911365  3.650509
sample estimates:
mean of x mean of y 
10.378947  9.509375 </code></pre>
</div>
</div>
<p>위의 것은 육식동물과 초식동물의 평균 잠 시간이 차이가 있는가 하는 가설을 검정하는 것이에요. 조건을 더 자세하게 줄 수 있어요. 아래는 육식동물이 더 잠을 많이 잔다는 가설을 95%의 확률로 검정하는 것이에요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(육식동물<span class="sc">$</span>sleep_total, 초식동물<span class="sc">$</span>sleep_total,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">conf.level =</span> <span class="fl">0.95</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">alternative =</span> <span class="st">"greater"</span>,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  육식동물$sleep_total and 초식동물$sleep_total
t = 0.62514, df = 49, p-value = 0.2674
alternative hypothesis: true difference in means is greater than 0
95 percent confidence interval:
 -1.462515       Inf
sample estimates:
mean of x mean of y 
10.378947  9.509375 </code></pre>
</div>
</div>
<p>t 검정은 뒤에 더 자세하게 공부할 겁니다.</p>
</section>
<section id="sec-tra-lm" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="sec-tra-lm"><span class="header-section-number">5.8</span> 선형 회귀분석 모델</h2>
<p>mtcars 데이터는 R이 기본으로 제공합니다. 1970년대 차에 관한 것인데, 연료소비와 실린더 수 등 여러 정보를 포함합니다. 데이터셋을 살펴봅니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>?mtcars</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기서는 총마력(hp)과 연료비(mpg)의 관계를 살펴봅니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(hp, mpg)) <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-transform_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>그래프에 나타난 점들이 완벽한 직선은 아니지만, 그래도 선형회귀모형은 그려볼 수 있어 보입니다. 총마력(hp)이 독립/설명 변수, 연료비(mpg)가 종속/결과 변수입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp, <span class="at">data =</span> mtcars)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.7121 -2.1122 -0.8854  1.5819  8.2360 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 30.09886    1.63392  18.421  &lt; 2e-16 ***
hp          -0.06823    0.01012  -6.742 1.79e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.863 on 30 degrees of freedom
Multiple R-squared:  0.6024,    Adjusted R-squared:  0.5892 
F-statistic: 45.46 on 1 and 30 DF,  p-value: 1.788e-07</code></pre>
</div>
</div>
<p><span class="math inline">\(mpg = \alpha + \beta * hp\)</span> : 이 선형 모델은 총마력(hp)이 연료비(mpg)를 예측하는 모형입니다. 즉 hp가 1 만큼 높아질수록 mpg가 <span class="math inline">\(\beta\)</span>만큼 높아지고, hp가 낮아질수록 mpg도 낮아진다는 걸 나타냅니다. <code>lm</code> 함수의 결과가 <code>summary</code> 함수를 통해서 나타납니다. <span class="math inline">\(\beta\)</span> 숫자가 나와 있는데 그 외에 여러 정보도 알려줍니다.</p>
<p>geom_abline 함수를 이용해서 산포도 위에 회귀선을 그릴 수 있고, coef 함수를 사용해서 회귀계수를 구할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 위의 선형회귀모형을 확인한다</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          hp 
30.09886054 -0.06822828 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 회귀선을 산포도에 추가한다</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(hp, mpg)) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(m)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(m)[<span class="dv">2</span>]),</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">colour =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-transform_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>잔차 그래프를 그릴 수도 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="data-transform_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="data-transform_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="data-transform_files/figure-html/unnamed-chunk-45-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="data-transform_files/figure-html/unnamed-chunk-45-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>독립변수를 추가해서 다중회귀분석을 할 수도 있습니다. 여기서는 자동차 무게(wt)를 추가합니다. 독립변수는 여러 개를 추가할 수 있어요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 37.22727    1.59879  23.285  &lt; 2e-16 ***
hp          -0.03177    0.00903  -3.519  0.00145 ** 
wt          -3.87783    0.63273  -6.129 1.12e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.593 on 29 degrees of freedom
Multiple R-squared:  0.8268,    Adjusted R-squared:  0.8148 
F-statistic: 69.21 on 2 and 29 DF,  p-value: 9.109e-12</code></pre>
</div>
</div>
</section>
<section id="집단-별로-요약하기" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="집단-별로-요약하기"><span class="header-section-number">5.9</span> 집단 별로 요약하기</h2>
<p><code>aggregate</code> 함수는 집단 별로 요약합니다. 예를 들어, 한국의 기온 통계를 계산할 때, 모든 측정 기간 전체의 기온 평균을 계산하는 것도 좋지만, 각 월 별로 평균을 계산한다면 일 년 동안의 기온을 예측하는 데 더 도움이될 것입니다. 이렇게 한 해 전체의 기온을 측정한 데이터에서 월 별로 평균을 각각 계산할 때 aggregate를 사용합니다. grouped summary 라고 봐도 됩니다.</p>
<p>R 기본에 포함한 <code>airquality</code> 데이터셋을 사용합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(Temp <span class="sc">~</span> Month, <span class="at">data =</span> airquality, <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Month     Temp
1     5 65.54839
2     6 79.10000
3     7 83.90323
4     8 83.96774
5     9 76.90000</code></pre>
</div>
</div>
<p>여기서 평균을 계산할 때 디폴트로 결측값은 제외합니다. 두 변수의 표준편처를 동시에 계산할 수도 있어요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(<span class="fu">cbind</span>(Temp, Wind) <span class="sc">~</span> Month, <span class="at">data =</span> airquality, <span class="at">FUN =</span> sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Month     Temp     Wind
1     5 6.854870 3.531450
2     6 6.598589 3.769234
3     7 4.315513 3.035981
4     8 6.585256 3.225930
5     9 8.355671 3.461254</code></pre>
</div>
</div>
<p><code>by</code> 함수도 비슷한 기능이지만 평균을 계산할 때는 아웃풋 포맷이 <code>aggregate</code>가 더 좋아요. 상관계수처럼 두 변수가 동시에 연결되는 통계분석에는 by 함수가 더 나아요. 아래는 R 기본에 포함한 airquality 데이터셋을 이용한 예입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(airquality)  <span class="co"># 3과 4열에 있는 Temp와 Wind 변수를 확인한다.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Ozone"   "Solar.R" "Wind"    "Temp"    "Month"   "Day"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(airquality[, <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>], airquality<span class="sc">$</span>Month, cor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>airquality$Month: 5
          Wind      Temp
Wind  1.000000 -0.373276
Temp -0.373276  1.000000
------------------------------------------------------------ 
airquality$Month: 6
           Wind       Temp
Wind  1.0000000 -0.1210353
Temp -0.1210353  1.0000000
------------------------------------------------------------ 
airquality$Month: 7
           Wind       Temp
Wind  1.0000000 -0.3052355
Temp -0.3052355  1.0000000
------------------------------------------------------------ 
airquality$Month: 8
           Wind       Temp
Wind  1.0000000 -0.5076146
Temp -0.5076146  1.0000000
------------------------------------------------------------ 
airquality$Month: 9
           Wind       Temp
Wind  1.0000000 -0.5704701
Temp -0.5704701  1.0000000</code></pre>
</div>
</div>
</section>
<section id="파이프를-이용하기" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="파이프를-이용하기"><span class="header-section-number">5.10</span> %&gt;% 파이프를 이용하기</h2>
<p>방문시간(visit_lenghth)으로 구매(purchase)를 나누어서 시간당 구매(rev_per_minute)를 구할 때</p>
<p><code>bookstore$rev_per_minte &lt;- bookstore$purchase / bookstore$visit_length</code></p>
<p><code>bookstore$</code> 를 자꾸 적은 건 불편해요. 파이프는 이걸 해소합니다.</p>
<section id="파이프" class="level3" data-number="5.10.1">
<h3 data-number="5.10.1" class="anchored" data-anchor-id="파이프"><span class="header-section-number">5.10.1</span> 파이프</h3>
<p><code>magrittr</code> 패키지는 pipes 라는 도구를 R에 추가합니다. pipes는 코드를 읽고 편집하기 편하게 합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"magrittr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>통상적으로 우리가 하는 방식:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 더운 날을 추출한다:</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>airquality2 <span class="ot">&lt;-</span> airquality[airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">80</span>, ]</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 바람 속도을 초속으로 변환한다</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>airquality2<span class="sc">$</span>Wind <span class="ot">&lt;-</span> airquality2<span class="sc">$</span>Wind <span class="sc">*</span> <span class="fl">0.44704</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 월의 바람 속도의 평균을 계산한다:</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>hot_wind_means <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Wind <span class="sc">~</span> Month, <span class="at">data =</span> airquality2,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이건 코드 자체는 문제가 없지만, airquality를 아주 여러 번 적는다는 게 문제예요. 아래처럼 <code>aggregate</code> 를 사용하면 좀 줄일 수 있지만, 그러면 코드를 이해하기가 좀 어려워지지요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 더 간단한 유형</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>hot_wind_means <span class="ot">&lt;-</span>  <span class="fu">aggregate</span>(Wind<span class="sc">*</span><span class="fl">0.44704</span> <span class="sc">~</span> Month,</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> airquality[airquality<span class="sc">$</span>Temp <span class="sc">&gt;</span> <span class="dv">80</span>, ],</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>magrittr</code>는 <code>pipe</code>라고 부르는 %&gt;%를 도입해서 잇단 함수를 편하게 사용합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>new_variable <span class="ot">&lt;-</span> <span class="fu">function_2</span>(<span class="fu">function_1</span>(your_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>위의 것을 아래처럼 적습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>your_data <span class="sc">%&gt;%</span> function_1 <span class="sc">%&gt;%</span> function_2 <span class="ot">-&gt;</span> new_variable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>자, 예를 들어봅시다. 아래 것은 통상적 방법입니다. <code>subset</code> 함수로 화씨 80도 넘는 더운 날의 데이터만 뽑아내고 <code>magrittr</code> 의 <code>inset</code> 함수로 바람 속도를 마일에서 미터로 고쳤습니다. <code>aggregate</code> 로 평균을 변수로 만들었구요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 더운 날을 추출한다:</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>airquality2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(airquality, Temp <span class="sc">&gt;</span> <span class="dv">80</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 바람 속도을 초속으로 변환한다</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>airquality2 <span class="ot">&lt;-</span> <span class="fu">inset</span>(airquality2, <span class="st">"Wind"</span>,</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">value =</span> airquality2<span class="sc">$</span>Wind <span class="sc">*</span> <span class="fl">0.44704</span>)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 각 월의 바람 속도의 평균을 계산한다:</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>hot_wind_means <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Wind <span class="sc">~</span> Month, <span class="at">data =</span> airquality2,</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">FUN =</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>아래 것은 <code>pipe</code>를 이용한 겁니다. 왼쪽 것 (데이터) 안에서 오른쪽 것(데이터)이 행해지니까 <code>airquality</code> 나 <code>airquality2</code>를 지정할 필요가 없어졌습니다. 즉 왼쪽이 오른쪽의 실행 범위를 지정/제한해주는 거지요.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">subset</span>(Temp <span class="sc">&gt;</span> <span class="dv">80</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inset</span>(<span class="st">"Wind"</span>, <span class="at">value =</span> .<span class="sc">$</span>Wind <span class="sc">*</span> <span class="fl">0.44704</span>) <span class="sc">%&gt;%</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aggregate</span>(Wind <span class="sc">~</span> Month, <span class="at">data =</span> ., <span class="at">FUN =</span> mean) <span class="ot">-&gt;</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>      hot_wind_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="두-개의-r-base-and-tidyverse" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="두-개의-r-base-and-tidyverse"><span class="header-section-number">5.11</span> 두 개의 R: Base and tidyverse</h2>
<p>base R은 원래 R을 말하고 tidyverse R은 여러 종류의 데이터를 다루기 쉽게 추가적인 패키지를 첨가한 것입니다. 둘 다 상호 호환적이니 사용에 문제는 없습니다. tidyverse는 ggplot2와 magrittr 패키지를 모두 포함합니다.</p>
<p>최근에 사용자들은 tidyverse R을 modern R이라 부르며 사용하기 편하다고 더 선호하는 경향을 보입니다. 사실 tidyverse는 통상적인 조건이나 파라미터를 디폴트로 사용하는 함수들이 많아서 편하기는 합니다. 그러나 디폴트를 사용하다보면 통계 결과를 분석할 때 그 의미를 놓칠 수 있습니다. 그래서 tidyverse의 편리함을 이용하면서도 base의 원칙도 익히는 게 바람직합니다.</p>
<p>더구나 수많은 패키지들이 지금도 만들어지므로 base를 익히는 게 미래의 R에 적응하는데 도움이 됩니다. 시간을 좀 투자해서 base R의 조건(옵션)을 공부하는 것도 좋습니다.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./write-quarto.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quarto 사용하기</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./descriptive-statistics.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">기술통계</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>