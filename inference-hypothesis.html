<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="For the class: Statistics and Analysis with R &amp; Quarto">

<title>통계와 분석 - 9&nbsp; 추정과 가설 검정</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./categorical-analysis.html" rel="next">
<link href="./probabilistic-distribution.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./inference-hypothesis.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">추정과 가설 검정</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">통계와 분석</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">안내</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">강의 소개</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./basic-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">통계의 기초 개념</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./base-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R 기본</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./write-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quarto 사용하기</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">데이터의 변환, 요약, 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">기술통계</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exploratoy-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">탐색적 데이터 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probabilistic-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">확률분포와 표집분포</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference-hypothesis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">추정과 가설 검정</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./categorical-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">범주형 자료분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variance-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">분산분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">선형 회귀분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">해답</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">참고문헌</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#추정" id="toc-추정" class="nav-link active" data-scroll-target="#추정"><span class="header-section-number">9.1</span> 추정</a></li>
  <li><a href="#sec-hyp-p-estimate" id="toc-sec-hyp-p-estimate" class="nav-link" data-scroll-target="#sec-hyp-p-estimate"><span class="header-section-number">9.2</span> 점 추정</a>
  <ul class="collapse">
  <li><a href="#모-평균의-점-추정" id="toc-모-평균의-점-추정" class="nav-link" data-scroll-target="#모-평균의-점-추정"><span class="header-section-number">9.2.1</span> 모 평균의 점 추정</a></li>
  <li><a href="#모-분산의-점-추정" id="toc-모-분산의-점-추정" class="nav-link" data-scroll-target="#모-분산의-점-추정"><span class="header-section-number">9.2.2</span> 모 분산의 점 추정</a></li>
  <li><a href="#모-비율의-점-추정" id="toc-모-비율의-점-추정" class="nav-link" data-scroll-target="#모-비율의-점-추정"><span class="header-section-number">9.2.3</span> 모 비율의 점 추정</a></li>
  </ul></li>
  <li><a href="#sec-hyp-conf-interval" id="toc-sec-hyp-conf-interval" class="nav-link" data-scroll-target="#sec-hyp-conf-interval"><span class="header-section-number">9.3</span> 구간 추정</a></li>
  <li><a href="#모-평균의-구간-추정" id="toc-모-평균의-구간-추정" class="nav-link" data-scroll-target="#모-평균의-구간-추정"><span class="header-section-number">9.4</span> 모 평균의 구간 추정</a></li>
  <li><a href="#평균차이-구간추정-두-모집단" id="toc-평균차이-구간추정-두-모집단" class="nav-link" data-scroll-target="#평균차이-구간추정-두-모집단"><span class="header-section-number">9.5</span> 평균차이 구간추정: 두 모집단</a></li>
  <li><a href="#가설-검정" id="toc-가설-검정" class="nav-link" data-scroll-target="#가설-검정"><span class="header-section-number">9.6</span> 가설 검정</a></li>
  <li><a href="#귀무가설과-대립가설" id="toc-귀무가설과-대립가설" class="nav-link" data-scroll-target="#귀무가설과-대립가설"><span class="header-section-number">9.7</span> 귀무가설과 대립가설</a></li>
  <li><a href="#종-오류와-2종-오류" id="toc-종-오류와-2종-오류" class="nav-link" data-scroll-target="#종-오류와-2종-오류"><span class="header-section-number">9.8</span> 1종 오류와 2종 오류</a></li>
  <li><a href="#모평균-검정-단일-모집단" id="toc-모평균-검정-단일-모집단" class="nav-link" data-scroll-target="#모평균-검정-단일-모집단"><span class="header-section-number">9.9</span> 모평균 검정: 단일 모집단</a></li>
  <li><a href="#평균차이-검정-두-모집단" id="toc-평균차이-검정-두-모집단" class="nav-link" data-scroll-target="#평균차이-검정-두-모집단"><span class="header-section-number">9.10</span> 평균차이 검정: 두 모집단</a></li>
  <li><a href="#평균차이-검정-쌍일-때" id="toc-평균차이-검정-쌍일-때" class="nav-link" data-scroll-target="#평균차이-검정-쌍일-때"><span class="header-section-number">9.11</span> 평균차이 검정: 쌍일 때</a></li>
  <li><a href="#모-분산-검정-단일-모집단" id="toc-모-분산-검정-단일-모집단" class="nav-link" data-scroll-target="#모-분산-검정-단일-모집단"><span class="header-section-number">9.12</span> 모 분산 검정: 단일 모집단</a></li>
  <li><a href="#모-분산의-검정-두-모집단" id="toc-모-분산의-검정-두-모집단" class="nav-link" data-scroll-target="#모-분산의-검정-두-모집단"><span class="header-section-number">9.13</span> 모 분산의 검정: 두 모집단</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-hyp" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">추정과 가설 검정</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="추정" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="추정"><span class="header-section-number">9.1</span> 추정</h2>
<p><strong>추정</strong> estimation 은 표본 통계량에서 모집단의 모수를 계산해내는 과정을 말합니다. 점 추정과 구간 추정이 있습니다. 이때 해당 통계량의 표집 분포를 이용하고 그 과정을 <strong>통계적 추론</strong> statistical inference 이라고 합니다. 추정 외에 가설검정도 통계적 추론에 속합니다.</p>
<p><span style="color:red">추정, 통계적 추론</span></p>
</section>
<section id="sec-hyp-p-estimate" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sec-hyp-p-estimate"><span class="header-section-number">9.2</span> 점 추정</h2>
<p><strong>점 추정</strong> point estimation 은 표본에서 모수의 값을 추정하는 것을 말하며 평균, 분산, 비율 등이 있습니다. 점 추정에 사용하는 값을 <strong>점 추정값</strong> point estimate 또는 그냥 <strong>추정값</strong> estimate 으로 부릅니다. 좋은 점 추정은 아래의 속성을 갖습니다.</p>
<ol type="1">
<li>일치 consistent: 표본 크기가 커지면 추정값이 더 정확해진다</li>
<li>불편 unbiased: 표집 분포의 기대값이 모수와 같다.</li>
<li>불편최소분산 most efficient: 표집 분포의 분산이 가장 작다. 즉 표본과 표본 사이의 측정값 차이가 가장 적다.</li>
</ol>
<p>점 추정의 방법이 위의 기준을 잘 충족하는지 여부는 모집단의 분포에 따릅니다. 모집단 분포가 정규분포에 가까우면 평균이 좋은 추정방법 estimator 이지만 한쪽으로 심하게 기울었다면 skewed 중간값이 좋은 추정방법 estimator 입니다.</p>
<p><span style="color:red">점 추정, 점 추정값, 추정값</span></p>
<section id="모-평균의-점-추정" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="모-평균의-점-추정"><span class="header-section-number">9.2.1</span> 모 평균의 점 추정</h3>
<p>모 평균 추정값은 표본 평균을 가장 많이 사용합니다.</p>
<p><span class="math display">\[ \bar X = \frac{X_1+X_2+ ... +X_n}{n}=\frac{1}{n}\sum_{i=1}^{n} X_i \]</span></p>
</section>
<section id="모-분산의-점-추정" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="모-분산의-점-추정"><span class="header-section-number">9.2.2</span> 모 분산의 점 추정</h3>
<p>모 분산 추정값은 표본 분산을 가장 많이 사용합니다. 표본분산을 구할 때 <span class="math inline">\((n-1)\)</span>로 나누는 걸 잊지 마세요.</p>
<p><span class="math display">\[ S^{2} = \frac{\sum_{i=1}^{n}(X_i-\bar X)^{2}}{n-1}  \]</span></p>
</section>
<section id="모-비율의-점-추정" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="모-비율의-점-추정"><span class="header-section-number">9.2.3</span> 모 비율의 점 추정</h3>
<p>비율은 모집단에서 어떤 속성을 갖는 요소의 비율을 말합니다. 남녀 비율, 특정 후보의 지지율, 실업률, 합격률 등등이 있습니다. 모집단의 변수가 1과 0의 값만을 갖는다고 할 때 그 평균과 같습니다.</p>
<p><span class="math display">\[ p = \frac{K}{n}, \; \; K는 \; 표본에서 \; 해당 \; 속성을 \; 갖는 \; 갯수 \]</span></p>
</section>
</section>
<section id="sec-hyp-conf-interval" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="sec-hyp-conf-interval"><span class="header-section-number">9.3</span> 구간 추정</h2>
<p><strong>구간 추정</strong> interval estimation 은 모수의 추정을 구간으로 하는 것입니다. 이때 구간을 <strong>신뢰구간</strong> confidence interval 이라고 하는데 구간이 모수를 포함할 확률에 따라 달라지며 이때 확률을 <strong>신뢰수준</strong> confidence level 이라고 합니다. 90%, 99% 등도 있으나 보통 95%를 많이 사용합니다. 95% 신뢰수준의 의미는, 만일 표본을 100개 뽑아서 평균의 신뢰구간을 모두 계산한다면 그 중에 95개의 신뢰구간이 모평균을 포함할 가능성을 말합니다.</p>
<p>일단 계산이 된 특정한 신뢰구간은 확률을 말할 수 없습니다. 따라서 계산된 신뢰구간이 모 평균을 포함하고 있을 가능성이 95%라고 말할 수 없습니다.</p>
<p><span style="color:red">구간 추정, 신뢰구간, 신뢰수준</span></p>
</section>
<section id="모-평균의-구간-추정" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="모-평균의-구간-추정"><span class="header-section-number">9.4</span> 모 평균의 구간 추정</h2>
<section id="모집단이-정규-분포고-모-분산을-알-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="모집단이-정규-분포고-모-분산을-알-때">모집단이 정규 분포고 모 분산을 알 때</h4>
<p><span class="math display">\[  \bar X \sim N(\mu, \frac{\sigma^{2}}{n}) ,  \; \; Z=\frac{\bar X-\mu}{\frac{\sigma}{\sqrt{n}}} \sim N(0,1) \]</span> 여기서 <span class="math inline">\(Z\)</span>는 <span class="math inline">\(\bar X\)</span> 를 표준화시키면 표준정규분포를 한다는 것을 의미합니다.</p>
<p>신뢰수준이 <span class="math inline">\(c\)</span> 라면 <span class="math inline">\(\alpha=1-c\)</span> (즉 신뢰수준이 95%라면 $= 0.05)</p>
<p><span class="math display">\[ P(\bar X - z_{\alpha/2}\frac {\sigma}{\sqrt {n}} \leq \mu \leq \bar X + z_{\alpha/2}\frac {\sigma}{\sqrt {n}}) = 1-\alpha \]</span></p>
<p>여기서 <span class="math inline">\(z_{\alpha/2}\)</span>는 <span class="math inline">\({\alpha/2}\)</span>에 대응하는 z값을 말합니다.</p>
<p>모집단이 비정규 분포를 해도 표본 크기가 30이 넘으면 중심극한정리에 의해 표집분포는 정규분포와 유사하므로 위의 공식을 사용합니다.</p>
<div id="fig-con-interv-z" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/conf-interv-z-two.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9.1: Z값과 신뢰구간</figcaption>
</figure>
</div>
<p>i<a href="images/if-conf-95.png" id="fig-if-conf-95" width="70%" data-fig-align="left">신뢰도가 95%라면</a></p>
</section>
<section id="모-분산을-모르지만-표본-크기가-클-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="모-분산을-모르지만-표본-크기가-클-때">모 분산을 모르지만 표본 크기가 클 때</h4>
<p>표본의 크기가 크면 중심극한정리에 따라 평균의 표집분포는 정규분포에 근접합니다.</p>
<p><span class="math display">\[  \bar X \sim N(\mu, \frac{\sigma^{2}}{n}) \]</span></p>
<p>문제는 모분산을 모르는 것인데 표본 분산을 모 분산으로 대체해서 계산합니다.</p>
<p><span class="math display">\[ S^{2} = \frac{\sum_{i=1}^{n}(X_i-\bar X)^{2}}{n-1}  \]</span></p>
<p>따라서 모 분산을 알 때의 공식을, 아래처럼 <span class="math inline">\(\sigma^{2}\)</span> 을 <span class="math inline">\(S^{2}\)</span> 로 대체하여, 사용할 수 있습니다.</p>
<p><span class="math display">\[ P(\bar X - z_{\alpha/2}\frac {S}{\sqrt {n}} \leq \mu \leq \bar X + z_{\alpha/2}\frac {S}{\sqrt {n}}) = 1-\alpha \]</span></p>
</section>
<section id="모-분산을-모르고-표본-크기가-작을-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="모-분산을-모르고-표본-크기가-작을-때">모 분산을 모르고 표본 크기가 작을 때</h4>
<p>이 경우에는 적어도 모집단이 정규분포를 한다는 가정이 필요합니다. 그 가정에서 t 분포를 사용합니다.</p>
<p><span class="math display">\[ X \sim N(\mu, \sigma^{2}) \]</span></p>
<p><span class="math display">\[ T=\frac{\bar X-\mu}{\frac{S}{\sqrt{n}}} \sim T(n-1) \]</span></p>
<p>아래의 공식을 사용하여 계산합니다. z값을 이용하는 것과 공식은 동일하지만 t값을 사용합니다.</p>
<p><span class="math display">\[ P(\bar X - t_{\alpha/2}\frac {S}{\sqrt {n}} \leq \mu \leq \bar X + t_{\alpha/2}\frac {S}{\sqrt {n}}) = 1-\alpha \]</span></p>
<p>정리를 하면;</p>
<div id="tbl-hyp-z-t" class="anchored">
<table class="table">
<caption>Table&nbsp;9.1: 추정에서 z 분포와 t 분포를 사용할 때</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 20%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">모집단 정규분포</th>
<th style="text-align: center;"><span class="math inline">\(\sigma\)</span> 안다</th>
<th style="text-align: center;"><span class="math inline">\(n \gt 30\)</span></th>
<th style="text-align: center;">임곗값</th>
<th style="text-align: center;">표준오차</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(z_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\sigma / \sqrt{n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"><span class="math inline">\(z_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\sigma / \sqrt{n}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(t_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(s / \sqrt{n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"><span class="math inline">\(t_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(s / \sqrt{n}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(z_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\sigma / \sqrt{n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">안 됨</td>
</tr>
<tr class="odd">
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(t_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(s / \sqrt{n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">안 됨</td>
</tr>
</tbody>
</table>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 9.1 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>크기가 40인 표본의 평균이 45이고 표준편차가 8일 때, 신뢰도 95%인 모평균의 신뢰구간은 얼마입니까?</p>
</blockquote>
</div>
<p><strong>풀이:</strong> 평균의 표준오차를 구하고 신뢰구간 95%와 자유도 <span class="math inline">\((n-1)\)</span>을 가진 <span class="math inline">\(t\)</span> 값을 구해서 계산한다.</p>
<p>여기서 <span class="math inline">\(n=40, \; \bar x=45, \; s=8\)</span>일 때, <span class="math inline">\(S_{\bar x} = 8 / \sqrt{40}\)</span> = 1.2649111,</p>
<p><span class="math inline">\(\alpha = 1- 0.95, \; t_{\alpha/2}\)</span> = 2.0226909</p>
<p>따라서 모평균의 95% 신뢰구간은 45 - 2.5585241 <span class="math inline">\(\le \mu \le\)</span> 45 + 2.5585241,</p>
<p>계산하면 답: 42.4414759 <span class="math inline">\(\le \mu \le\)</span> 47.5585241</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a># 위의 qmd 파일 원문 (R 인라인 코드+ Quarto)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>여기서  $n=40, \; \bar x=45, \; s=8$일 때, $S_{\bar x} = 8 / \sqrt{40}$ = `r S=8/sqrt(40)` `r S`, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>$\alpha = 1- 0.95, \; t_{\alpha/2}$ = `r t=abs(qt(0.025, 39))` `r t` </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>따라서 모평균의 95% 신뢰구간은 45-`r t*S` $\le \mu \le$ 45 +`r t*S`, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>계산하면 답: `r 45-t*S` $\le \mu \le$ `r 45 + t*S`</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 9.2 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>데이터 <code>iris</code> 의 변수인 <code>Sepal.Length</code>에 대해서 평균의 신뢰도 95%인 신뢰구간을 구하세요.</p>
</blockquote>
</div>
<p><strong>풀이:</strong> <code>t.test</code> 함수를 사용해서 t 검정의 결과로 <code>result$conf.int</code>라는 변수를 만들어 답을 구한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(iris<span class="sc">$</span>Sepal.Length, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 평균</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> result<span class="sc">$</span>estimate</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>mean</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="do">## mean of x </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  5.843333</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 신뢰구간</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>conf_interval <span class="ot">&lt;-</span> result<span class="sc">$</span>conf.int</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>conf_interval</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5.709732 5.976934</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,"conf.level")</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>또는</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 평균의 신뢰구간 구하기</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">t.test</span>(iris<span class="sc">$</span>Sepal.Length, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과 출력</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>conf.int)    <span class="co"># 왼쪽 오른쪽 신뢰구간 동시에 출력</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5.709732 5.976934</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="do">## attr(,"conf.level")</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.95</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>conf.int[<span class="dv">1</span>])  <span class="co"># 왼쪽 신뢰구간 출력</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5.709732</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>conf.int[<span class="dv">2</span>])  <span class="co"># 오른쪽 신뢰구간 출력</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5.976934</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>여기서 왼쪽과 오른쪽 신뢰구간은 <code>result</code>란 데이터셋에 <code>conf.int</code>란 변수에 저장되어 있다.</p>
<p>따라서</p>
<p><strong>답:</strong> 5.7097325 <span class="math inline">\(\le \mu \le\)</span> 5.9769342</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a># 위의 qmd 파일 원문 (R 인라인 코드+ Quarto)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>**답:** `r result$conf.int[1]` $\le \mu \le$ `r result$conf.int[2]` </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="평균차이-구간추정-두-모집단" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="평균차이-구간추정-두-모집단"><span class="header-section-number">9.5</span> 평균차이 구간추정: 두 모집단</h2>
<p>위의 모집단 평균의 구간 추정과 동일한 근거로 계산합니다.</p>
<section id="두-모집단이-독립인-정규분포를-하고-모분산이-알려진-경우" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="두-모집단이-독립인-정규분포를-하고-모분산이-알려진-경우">두 모집단이 독립인 정규분포를 하고 모분산이 알려진 경우</h4>
<p><span class="math display">\[ P\Big( \; (\bar X-\bar Y) - z_{\alpha/2} \sqrt{\frac{\sigma_1^{2}}{n_1}+\frac{\sigma_2^{2}}{n_2}} \leq \mu_1-\mu_2 \leq (\bar X - \bar Y) + z_{\alpha/2} \sqrt{\frac{\sigma_1^{2}}{n_1}+\frac{\sigma_2^{2}}{n_2}} \; \; \Big) = 1-\alpha \]</span></p>
</section>
<section id="두-모분산을-모르지만-표본-크기가-클-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="두-모분산을-모르지만-표본-크기가-클-때">두 모분산을 모르지만 표본 크기가 클 때</h4>
<p><span class="math display">\[ P( \; (\bar X-\bar Y) - z_{\alpha/2} \sqrt{\frac{S_1^{2}}{n_1}+\frac{S_2^{2}}{n_2}} \leq \mu_1-\mu_2 \leq (\bar X - \bar Y) + z_{\alpha/2} \sqrt{\frac{S_1^{2}}{n_1}+\frac{S_2^{2}}{n_2}} \; ) = 1-\alpha   \]</span></p>
</section>
<section id="모분산을-모르고-표본-크기도-작을-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="모분산을-모르고-표본-크기도-작을-때">모분산을 모르고 표본 크기도 작을 때</h4>
<p>두 모집단이 독립이고 정규분포라는 가정이 필요하고 더불어 두 모분산이 같다는 가정도 필요합니다.</p>
<p>두 모분산이 같으므로 두 모집단을 합쳐서 분산을 계산합니다. 이것을 <strong>합동추정량</strong> pooled estimator 이라고 합니다. 두 모집단에서 표본 {<span class="math inline">\(X_1, X_2, ..., X_n\)</span>}와 {<span class="math inline">\(Y_1, Y_2, ... , Y_n\)</span>}을 추출해서 합동추정량을 계산하면,</p>
<p><span class="math display">\[ S_{p}^{2} = \frac {\sum _{i=1}^{n_1}(X_i-\bar X)^{2}+ \sum _{i=1}^{n_2}(Y_i-\bar Y)^{2}}{n_1+n_2 -2} = \frac {(n_1-1) S_1^{2}+(n_2-1) S_2^{2}}{n_1+n_2 -2} \]</span></p>
<p>합동분산을 계산하는 이유는, 표본 크기가 작으므로 개별 분산을 사용하면 t 분포는 오차의 범위가 커진다는 겁니다. 합동분산을 계산하면 분산에 사용하는 n의 크기가 커지므로 오차의 범위가 줄어듭니다. 분산을 계산할 때 평균을 빼주므로 (예, <span class="math inline">\(X_i-\bar X\)</span>) 평균이 달라도 문제가 없습니다. 분산이 같다는 가정만 충족하면 됩니다.</p>
<p><span class="math display">\[ P\Big( \; (\bar X-\bar Y) - t_{\alpha/2} (n_1+n_2-2) S_p \sqrt{\frac{1}{n_1}+\frac{1}{n_2}} \leq \mu_1-\mu_2 \leq (\bar X - \bar Y) + t_{\alpha/2} (n_1+n_2-2) S_p \sqrt{\frac{1}{n_1}+\frac{1}{n_2}} \; \; \Big)= 1-\alpha   \]</span></p>
</section>
<section id="두-표본이-독립적이-아니며-쌍을-이룰-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="두-표본이-독립적이-아니며-쌍을-이룰-때">두 표본이 독립적이 아니며 쌍을 이룰 때</h4>
<p>두 확률표본이 독립적이 아니며 서로 대응을 하는 값일 때 두 모평균 차이에 대한 신뢰구간은 사실상 그 쌍의 차이에 대한 단일 표본의 신뢰구간과 같습니다.</p>
<p>예를 들면, 영어 점수와 수학 점수 차이에 대한 두 모평균의 차이의 신뢰구간을 구한다고 합니다. 두 점수는 (85, 78) (72, 68) 처럼 한 학생이 두 점수를 가지고 있으므로 쌍을 이룹니다. 그리고 한 과목을 잘 하는 학생이 다른 과목도 잘 하는 경향이 있으므로 두 변수가 독립적이 아닙니다. (85, 78) (72, 68) 는 차이만 보면 7 (85-78), 4 (72-68) 입니다. 그래서 차이라는 단일 변수의 평균의 신뢰구간을 구하면 됩니다.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">영어</th>
<th style="text-align: center;">수학</th>
<th style="text-align: center;">차이</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">85</td>
<td style="text-align: center;">78</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: center;">72</td>
<td style="text-align: center;">68</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td style="text-align: center;">평균</td>
<td style="text-align: center;">평균</td>
<td style="text-align: center;">평균</td>
</tr>
<tr class="odd">
<td style="text-align: center;">75</td>
<td style="text-align: center;">71</td>
<td style="text-align: center;">6</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="가설-검정" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="가설-검정"><span class="header-section-number">9.6</span> 가설 검정</h2>
<p><strong>가설</strong> hypothesis 은 이론이 되기 전의 어떤 주장을 말합니다. 가설이 증명되면, 즉 검정을 통과하면 이론이 됩니다. 예를 들어, “지구는 둥글다”라는 주장이 있은데 예전에는 가설이었습니다. 갈릴레오가 이 가설을 주장해서 큰 곤란을 겪었지요. 그러나 점차 여러 증거들이 발견되고 이제는 우주에서 둥근 지구를 관찰하기까지 하니까 “지구는 둥글다”는 주장이 검정되어 확고한 이론이 되었습니다.</p>
<p>모집단에 대한 아직 검정되지 않는 주장을 <strong>통계적 가설</strong> statistical hypothesis 이라고 합니다. 통계적 가설은 표본조사를 통해서 검정하는데 이 과정에서 표집분포와 확률이론을 사용합니다. 따라서 추론적 통계에 속합니다. 이때 통계적 유의미 여부의 검정 대상이 되는 것을 <strong>귀무가설</strong> null hypothesis 이라 하며, 주로 ‘차이가 없다’ 또는 ‘효과가 없다’는 내용의 가설입니다. 귀무가설의 반대 주장이 대립가설입니다. <strong>대립가설</strong> alternative hypothesis 은 그 자체를 검정하지 않고 귀무가설의 검정 결과에 따라 결정됩니다. 대립가설은 귀무가설의 반대이므로 주로 ’차이가 있다’ 또는 ’효과가 있다’는 내용입니다.</p>
<p>가설 검정의 절차는 아래와 같습니다. 첫째 것이 일반적이지만, 다른 의견들도 있습니다. 여기는 두 개만 예로 듭니다.</p>
<ul>
<li><strong>첫째</strong></li>
</ul>
<ol type="1">
<li>귀무가설 <span class="math inline">\(H_0\)</span>와 대립가설 <span class="math inline">\(H_A\)</span>을 설정한다</li>
<li>유의수준 <span class="math inline">\(\alpha\)</span> 을 설정한다</li>
<li>적절한 검정 통계량을 선정하고 임계값을 설정한다</li>
<li>통계량과 <span class="math inline">\(p\)</span> 값을 계산한다</li>
<li>결과를 해석하고 결론 짓는다</li>
</ol>
<ul>
<li><strong>둘째</strong></li>
</ul>
<ol type="1">
<li>가정을 살펴보고 가설을 설정한다</li>
<li>검정 통계량을 계산한다</li>
<li><span class="math inline">\(p\)</span> 값을 결정한다</li>
<li>결정을 내린다</li>
<li>현실에 적절한 결론을 작성한다</li>
</ol>
</section>
<section id="귀무가설과-대립가설" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="귀무가설과-대립가설"><span class="header-section-number">9.7</span> 귀무가설과 대립가설</h2>
<p>앞서 말한 바와 같이, <strong>통계적 유의 검정</strong> statistical significance test 의 직접 대상이 되는 가설이 귀무가설입니다. 귀무가설은 대개 차이가 없다, 효과가 없다 등의 내용을 가집니다. 귀무가설의 예를 들면, ‘남자와 여자의 언어 능력의 차이가 없다’ ‘마스트는 바이러스 감염에 효과가 없다’ ‘수학성적과 영어성적은 상관관계가 없다’ 등이 있습니다. 대립가설은 귀무가설의 반대 주장입니다. 예를 들어, ’마스크는 바이러스 감염 방지에 효과가 없다’라는 귀무가설의 대립가설은 ’마스크는 바이러스 감염 방지에 효과가 있다’입니다. 따라서 귀무가설 검정의 결과에 따라 대립가설의 채택 여부가 결정됩니다. 귀무가설이 기각되면, 대립가설이 선택되고, 귀무가설이 채택되면 대립가설이 선택되지 않습니다.</p>
<p>사회과학 분야에서 연구자들이 주장하고자 하는 가설은 대개 대립가설입니다. 사회과학자는 통상 과거의 연구를 토대로 ‘차이가있다’ ‘효과가 있다’ ‘연관이 있다’ 등의 가설을 내세웁니다. 예를 들어, ’남자와 여자는 미디어 이용 시간에 차이가 있다’는 가설을 내세운다면 그건 대립가설입니다. 그것에 상응하는 ’남자와 여자는 미디어 이용 사간에 차이가 없다’는 귀무가설을 세우고 귀무가설의 통계적 유의미를 검정합니다.</p>
<p>통계적 유의수준의 검정에는 두 가지가 있습니다. <strong>양측 검정</strong> two-sided test 과 <strong>단측 검정</strong> one-sided test 이 있는데 단측 검정은 다시 <strong>우측 검정</strong> right-sided test 과 <strong>좌측 검정</strong> left-sided test 으로 나누어집니다. 예를 들어 보죠. ‘모집단 평균이 85’라는 귀무가설이 있다고 할 때, 대립가설은 ’85와 다르다’, ‘85보다 작다’, ‘85보다 크다’, 세 가지가 가능합니다.</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu= 85\)</span>, <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu \ne 85\)</span> 양측검정</li>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu= 85\)</span>, <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu \lt 85\)</span> 좌측검정</li>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu= 85\)</span>, <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu \gt 85\)</span> 우측검정</li>
</ul>
<p>귀무가설을 검정하는 수준이 <strong>유의 수준</strong> significance level 입니다. 유의 수준에 따라 그에 대응하는 <strong>임곗값</strong> critical value 이 결정됩니다. <strong>검정 통계량</strong> test statistics 이 임계값을 넘으면 귀무가설은 기각되고 대립가설이 채택됩니다. 예를 들어, 유의수준 <span class="math inline">\(\alpha=0.05\)</span> 면 양측검정에서 그에 대응하는 <span class="math inline">\(Z\)</span>의 임곗값은 -1.96과 1.96입니다.</p>
<div id="fig-hypo-two-s" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/hypo-two-sided.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9.2: 양측검정</figcaption>
</figure>
</div>
<div id="fig-hypo-left-s" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/hypo-left-sided.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9.3: 단측검정: 좌측검정</figcaption>
</figure>
</div>
</section>
<section id="종-오류와-2종-오류" class="level2" data-number="9.8">
<h2 data-number="9.8" class="anchored" data-anchor-id="종-오류와-2종-오류"><span class="header-section-number">9.8</span> 1종 오류와 2종 오류</h2>
<p>가설 검정의 결과에 나타나는 오류는 두 가지가 있습니다. <strong>제1종 오류</strong> type I error 는 귀무가설이 참인데 그걸 기각하고 대립가설을 선택하는 것입니다. 이것이 발생할 확률은 유의수준 <span class="math inline">\(\alpha\)</span> 과 같습니다. 왜냐하면 우리가 검정에 사용하는 분포는 귀무가설이 참이라고 가정할 때의 분포이기 때문입니다. <strong>제2종 오류</strong> type II error 는 귀무가설이 거짓인데 그걸 채택하고 대립가설을 기각하는 것입니다. 이것이 발생할 확률을 <span class="math inline">\(\beta\)</span> 라고 합니다. <span class="math inline">\(\beta\)</span> 는 알기 어렵습니다. 귀무가설이 거짓이라는 것을 알아도 참값이 얼마인지 모르므로 (예를 들어, 모 평균이 얼마인지 모르므로) 분포를 특정할 수 없기 때문입니다.</p>
<div id="tbl-type-i-ii-err" class="anchored">
<table class="table">
<caption>Table&nbsp;9.2: 1종 오류와 2종 오류</caption>
<thead>
<tr class="header">
<th style="text-align: center;">실제사실</th>
<th style="text-align: center;"><span class="math inline">\(H_0\)</span> 채택</th>
<th style="text-align: center;"><span class="math inline">\(H_A\)</span> 채택</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(H_0\)</span> 참</td>
<td style="text-align: center;"><span class="math inline">\(1-\alpha\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\alpha\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(H_A\)</span> 참</td>
<td style="text-align: center;"><span class="math inline">\(\beta\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1-\beta\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="fig-type-i-error" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/type-I-error.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9.4: 제1종 오류</figcaption>
</figure>
</div>
<div id="fig-type-ii-er" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/type-II-error.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9.5: 제2종 오류</figcaption>
</figure>
</div>
</section>
<section id="모평균-검정-단일-모집단" class="level2" data-number="9.9">
<h2 data-number="9.9" class="anchored" data-anchor-id="모평균-검정-단일-모집단"><span class="header-section-number">9.9</span> 모평균 검정: 단일 모집단</h2>
<section id="정규-모집단이고-분산을-알-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="정규-모집단이고-분산을-알-때">정규 모집단이고 분산을 알 때</h4>
<p>이미 아는 모집단의 평균이 맞는지 표본조사의 의한 표본 평균을 이용하여 검정합니다. 정규 모집단이므로 표본 평균도 정규 분포를 한다는 가정을 합니다. 표집분포가 정규이므로 검정통계량은 Z값입니다.</p>
<ol type="1">
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu=\mu_0\)</span>, <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu \ne \mu_0\)</span>, <br> 또는 <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu \le \mu_0\)</span>, <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu \gt \mu_0\)</span>, <br> 또는 <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu \ge \mu_0\)</span>, <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu \lt \mu_0\)</span></li>
<li>유의수준 <span class="math inline">\(\alpha\)</span>을 결정한다</li>
<li>표본에서 평균 <span class="math inline">\(\bar x\)</span>을 계산한다</li>
<li>평균에 대응하는 검정통계량 <span class="math inline">\(z\)</span>값을 계산한다 <span class="math inline">\(z=\frac{\bar x-\mu_0}{\sigma/\sqrt{n}}\)</span></li>
<li>임계값과 비교하여 기각과 채택을 결정한다</li>
</ol>
</section>
<section id="모-분산을-모르고-표본의-크기가-클-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="모-분산을-모르고-표본의-크기가-클-때">모 분산을 모르고 표본의 크기가 클 때</h4>
<p>위와 동일하고, 모분산 대신에 표본 분산을 사용합니다. <span class="math inline">\(S^{2}=\frac{1}{n-1}\sum(X_i-\bar X)^{2}\)</span></p>
</section>
<section id="모-분산을-모르고-표본의-크기가-작을-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="모-분산을-모르고-표본의-크기가-작을-때">모 분산을 모르고 표본의 크기가 작을 때</h4>
<p>모집단이 정규분포를 한다면, 위와 동일한 과정을 거치되 <span class="math inline">\(Z\)</span>값 대신에 <span class="math inline">\(T\)</span>값을 사용합니다. <span class="math inline">\(T=\frac{\bar x-\mu_0}{S/\sqrt{n}}\)</span> 자유도는 <span class="math inline">\(n-1\)</span> 입니다.</p>
<p>정리를 하면 (앞에 나왔던 것과 동일)</p>
<table class="table">
<colgroup>
<col style="width: 21%">
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 20%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">모집단 정규분포</th>
<th style="text-align: center;"><span class="math inline">\(\sigma\)</span> 안다</th>
<th style="text-align: center;"><span class="math inline">\(n \gt 30\)</span></th>
<th style="text-align: center;">임곗값</th>
<th style="text-align: center;">표준오차</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(z_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\sigma / \sqrt{n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"><span class="math inline">\(z_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\sigma / \sqrt{n}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(t_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(s / \sqrt{n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"><span class="math inline">\(t_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(s / \sqrt{n}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(z_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\sigma / \sqrt{n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">안 됨</td>
</tr>
<tr class="odd">
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;"><span class="math inline">\(t_{\alpha / 2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(s / \sqrt{n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">no</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">안 됨</td>
</tr>
</tbody>
</table>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 9.3 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>한 방송국의 토크쇼가 평균 시청 시간이 42.5분이고 표준편차가 7.07분인 정규분포를 가졌습니다. MC가 바뀌었는데 시청 시간이 바뀌었는지 알아보려고 시청자 50명을 무작위로 뽑아 조사했더니 평균이 39.7분이 나왔습니다.</p>
<ol type="1">
<li>시청시간이 달라졌을까요? 유의수준 5%로 계산해보세요.</li>
<li>시청시간이 줄었다고 말할 수 있을까요? 유의수준 5%로 계산해보세요.</li>
</ol>
</blockquote>
</div>
<p><strong>풀이: </strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="fl">42.5</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">=</span><span class="fl">7.07</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>xbar<span class="ot">=</span><span class="fl">39.7</span>  <span class="co"># 표본평균</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>se<span class="ot">=</span>sigma<span class="sc">/</span><span class="fu">sqrt</span>(n) <span class="co"># 표본평균의 표준오차: standard error</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(xbar<span class="sc">-</span>mu)<span class="sc">/</span>se  <span class="co"># 표본평균의 z값</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>cv.two.l <span class="ot">=</span><span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>)    <span class="co"># 양측검정일 때 왼쪽 임곗값</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>cv.two.r <span class="ot">=</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># 양측검정일 때 오른쪽 임곗값</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>cv.left <span class="ot">=</span><span class="fu">qnorm</span>(alpha)      <span class="co"># 왼쪽 단측검정일 때 임곗값</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># sprintf() 함수가 만드는 문자열을 cat() 함수가 출력합니다. </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>str<span class="ot">=</span><span class="fu">sprintf</span>(<span class="st">"유의수준= %.2f, z값= %.2f, 왼쪽임곗값= %.2f, 오른쪽임곗값= %.2f, 단측왼쪽임곗값=%.2f"</span>, alpha, z, cv.two.l, cv.two.r, cv.left)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(str)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>유의수준= 0.05, z값= -2.80, 왼쪽임곗값= -1.96, 오른쪽임곗값= 1.96, 단측왼쪽임곗값=-1.64</code></pre>
</div>
</div>
<p><strong>답:</strong> 1) 양측 검정: <span class="math inline">\(H_0: \mu = 42.5, \; \; H_A: \mu \ne 42.5\)</span></p>
<p>임계값 <span class="math inline">\(z_{\alpha /2}=z_{0.025}=\pm\)</span> 1.959964</p>
<p>표본평균 39.7분에 대한 z값은 -2.8004229이며 왼쪽 임곗값인 -1.959964보다 작으므로 시청시간이 달라졌다고 판단합니다.</p>
<ol start="2" type="1">
<li>왼쪽 단측 검정: <span class="math inline">\(H_0: \mu = 42.5, \; \; H_A: \mu \lt 42.5\)</span></li>
</ol>
<p>임계값 <span class="math inline">\(z_{\alpha}=z_{0.05}=\)</span> –1.6448536</p>
<p>표본평균 39.7분에 대한 z값은 -2.8004229이며 단측 임곗값인 -1.6448536보다 작으므로 시청시간이 적어졌다고 판단합니다.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>1) 양측 검정: $H_0: \mu = 42.5, \; \; H_A: \mu \ne 42.5$</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>임계값 $z_{\alpha /2}=z_{0.025}=\pm$ `r cv.two.r`</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>표본평균 39.7분에 대한 z값은 `r z`이며 왼쪽 임곗값인 `r cv.two.l`보다</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 9.4 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p><code>iris</code> 데이터셋에서 명목변수인 <code>Species</code> 의 <code>setosa</code> 품종의 <code>Sepal.Length</code> 평균이 평균 5.2를 가진 모집단에서 나온 것인지 검정해보세요. (변수의 대문자 주의!)</p>
</blockquote>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># iris 데이터셋 불러온다</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Species에서 "setosa"만 선택해서 new_iris 데이터셋을 만든다</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>new_iris <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, Species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"setosa"</span>)) </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(new_iris<span class="sc">$</span>Sepal.Length, <span class="at">mu=</span><span class="fl">5.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  new_iris$Sepal.Length
t = -3.8917, df = 49, p-value = 0.0003007
alternative hypothesis: true mean is not equal to 5.2
95 percent confidence interval:
 4.905824 5.106176
sample estimates:
mean of x 
    5.006 </code></pre>
</div>
</div>
<p><strong>답:</strong> setosa의 Sepal.Length 평균의 t 값은 -3.8917고 확률 <span class="math inline">\(p=0.0003\)</span> 입니다. 따라서 차이가 0이라는 귀무가설을 기각하고 대립가설을 채택합니다.</p>
</section>
</section>
<section id="평균차이-검정-두-모집단" class="level2" data-number="9.10">
<h2 data-number="9.10" class="anchored" data-anchor-id="평균차이-검정-두-모집단"><span class="header-section-number">9.10</span> 평균차이 검정: 두 모집단</h2>
<section id="독립적인-정규-모집단이고-분산을-알-때" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="독립적인-정규-모집단이고-분산을-알-때">독립적인 정규 모집단이고 분산을 알 때</h4>
<p>두 모집단의 평균이 같은지 표본조사의 의한 표본 평균을 이용하여 검정합니다. 정규 모집단이므로 표본 평균도 정규 분포를 한다는 가정을 합니다. 표집분포가 정규이므로 검정통계량은 Z값입니다.</p>
<ol type="1">
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1=\mu_2\)</span> 또는 <span class="math inline">\(\mu_1-\mu_2=0\)</span>, <br> <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu_1 \ne \mu_2\)</span> 또는 <span class="math inline">\(\mu_1-\mu_2 \ne 0\)</span> <br></li>
<li>유의수준 <span class="math inline">\(\alpha\)</span>을 결정한다</li>
<li>표본에서 평균 차이를 <span class="math inline">\(\bar x_1-\bar x_2\)</span>을 계산한다</li>
<li>평균에 대응하는 검정통계량 <span class="math inline">\(z\)</span>값을 계산한다 <span class="math display">\[z=\frac{(\bar x_1-\bar x_2)-(\mu_1-\mu_2)}{\sqrt{\sigma_1^{2}/n_1+\sigma_2^{2}/n_2}}\]</span></li>
<li>임계값과 비교하여 기각과 채택을 결정한다</li>
</ol>
</section>
<section id="모-분산을-모르고-표본의-크기가-클-때-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="모-분산을-모르고-표본의-크기가-클-때-1">모 분산을 모르고 표본의 크기가 클 때</h4>
<p>위와 동일하고, 모분산 대신에 표본 분산을 사용합니다.</p>
<p><span class="math display">\[S^{2}=\frac{1}{n-1}\sum(X_i-\bar X)^{2}\]</span></p>
</section>
<section id="모-분산을-모르고-표본의-크기가-작을-때-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="모-분산을-모르고-표본의-크기가-작을-때-1">모 분산을 모르고 표본의 크기가 작을 때</h4>
<p>모집단이 정규분포를 한다면, 위와 동일한 과정을 거치되 <span class="math inline">\(Z\)</span>값 대신에 <span class="math inline">\(T\)</span>값을 사용합니다.</p>
<p><span class="math display">\[T=\frac{\bar X_1-\bar X_2}{S_p\sqrt{\frac{1}{n_1}+\frac{1}{n_2}}} \; \sim t(n_1+n_2-2)\]</span></p>
<p>여기서 <span class="math inline">\(S_p\)</span>는 합동추정량입니다.</p>
<p><span class="math display">\[ S_{p}^{2} = \frac {(n_1-1) S_1^{2}+(n_2-1) S_2^{2}}{n_1+n_2 -2} \]</span></p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 9.5 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p>국민대학교 1학년과 2학년의 성적 평균에 차이가 있는지 검정하려고 합니다. 둘다 표본 크기는 40명씩입니다. 1학년 평균은 3.40이고 표준편차는 0.2, 2학년 평균은 3.55이고 표준편차는 0.22로 결과가 나왔습니다. 유의수준 10%에서 1학년과 2학년의 평균 차이가 있을까요?</p>
</blockquote>
</div>
<p><strong>풀이</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># {r collapse: TRUE} 이런 옵션을 쓰면 붙어서 나옵니다. </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>m_1<span class="ot">&lt;-</span><span class="fl">3.40</span>   <span class="co"># 1학년</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sd_1 <span class="ot">&lt;-</span><span class="fl">0.2</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>n_1<span class="ot">&lt;-</span><span class="dv">40</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>m_2<span class="ot">&lt;-</span><span class="fl">3.55</span>   <span class="co"># 2학년</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>sd_2<span class="ot">&lt;-</span><span class="fl">0.22</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>n_2<span class="ot">&lt;-</span><span class="dv">40</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>m_diff<span class="ot">&lt;-</span>m_1<span class="sc">-</span>m_2   <span class="co"># 평균 차이</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sd_1<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">40</span><span class="sc">+</span>sd_2<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">40</span>)   <span class="co"># 평균 차이의 표준오차</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span>(m_diff<span class="dv">-0</span>)<span class="sc">/</span>se  <span class="co">#평균차이의 z값, (평균차이의 평균= 0 :귀무가설)</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.10</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>cv.two.l <span class="ot">=</span><span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>)    <span class="co"># 양측검정일 때 왼쪽 임곗값</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>cv.two.r <span class="ot">=</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)  <span class="co"># 양측검정일 때 오른쪽 임곗값</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># sprintf() 함수가 만드는 문자열을 cat() 함수가 출력합니다. </span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>str<span class="ot">=</span><span class="fu">sprintf</span>(<span class="st">"유의수준= %.2f, z값= %.2f, 왼쪽임곗값= %.2f, 오른쪽임곗값= %.2f"</span>, alpha, z, cv.two.l, cv.two.r)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(str)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 유의수준= 0.10, z값= -3.19, 왼쪽임곗값= -1.64, 오른쪽임곗값= 1.64</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1=\mu_2\)</span> 또는 <span class="math inline">\(\mu_1-\mu_2=0\)</span>, <br> <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu_1 \ne \mu_2\)</span> 또는 <span class="math inline">\(\mu_1-\mu_2 \ne 0\)</span></li>
<li>유의수준 <span class="math inline">\(\alpha=0.1\)</span></li>
<li>표본평균 차이= -0.15</li>
<li>평균 차이에 대응하는 검정통계량 <span class="math inline">\(z\)</span>값 = -3.1907672</li>
<li>양측검정: 임계값과 비교하여 기각과 채택을 결정; 임곗값 <span class="math inline">\(\pm\)</span> 1.6448536</li>
</ol>
<p><strong>답:</strong> 표본평균 차이의 z값 -3.19가 임곗값보다 적으므로 남녀 차이가 있다고 검정한다.</p>
<ul>
<li>앞 <a href="data-transform.html"><span>5</span></a> 장의 <a href="data-transform.html#sec-tra-tte"><strong>t 검정 실시하기</strong></a> 부분을 잠깐 다시보면 도움이 될 거예요.</li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 9.6 </strong></span>&nbsp;</p>
<blockquote class="blockquote">
<p><code>iris</code> 데이터셋에서 명목변수인 <code>Species</code> 의 <code>setosa</code> 품종과 <code>versicolor</code> 품중 간에 <code>Sepal.Length</code>에 대한 평균 차이가 있는지 검정해 보세요. (변수의 대문자 주의!)</p>
</blockquote>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># iris 데이터셋 불러온다</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Species에서 "setosa"와 "versicolor"만 선택해서 new_iris 데이터셋을 만든다</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>new_iris <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, Species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"setosa"</span>, <span class="st">"versicolor"</span>)) </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(new_iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> new_iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  new_iris$Sepal.Length by new_iris$Species
t = -10.521, df = 86.538, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group setosa and group versicolor is not equal to 0
95 percent confidence interval:
 -1.1057074 -0.7542926
sample estimates:
    mean in group setosa mean in group versicolor 
                   5.006                    5.936 </code></pre>
</div>
</div>
<p><strong>답:</strong> setosa와 versicolor의 Sepal.Length 평균차이인 (5.006-5.936)의 t 값은 -10.521이고 확률 <span class="math inline">\(p \lt 0.001\)</span> 입니다. 따라서 차이가 0이라는 귀무가설을 기각하고 대립가설을 채택합니다.</p>
</section>
</section>
<section id="평균차이-검정-쌍일-때" class="level2" data-number="9.11">
<h2 data-number="9.11" class="anchored" data-anchor-id="평균차이-검정-쌍일-때"><span class="header-section-number">9.11</span> 평균차이 검정: 쌍일 때</h2>
<p>쌍을 이룬 두 모평균 차이의 검정은 사실 쌍의 차이의 평균이 0인가를 검정하는 것과 같습니다. 따라서 두 모집단이 아니라 한 모집단에 대한 검정입니다. 따라서 절차는 단일 모집단에 대한 검정을 따릅니다.</p>
<p><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1=\mu_2\)</span> 또는 <span class="math inline">\(\mu_1-\mu_2=0\)</span>, <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\mu_1 \ne \mu_2\)</span> 또는 <span class="math inline">\(\mu_1-\mu_2 \ne 0\)</span></p>
<p>각 쌍의 차이를 {<span class="math inline">\(D_1, D_2, ... , D_n\)</span>}이라고 하고 그것이 분산이 <span class="math inline">\(\sigma^{2}\)</span> 인 정규 모집단에서 추출한 확률 표본이라고 합니다.</p>
<p><span class="math display">\[\bar D = \frac{\sum_{i=1}^{n} D_i}{n}\]</span></p>
<p><span class="math display">\[S_D^{2}=\frac{\sum_{i=1}^{n} (D_i-\bar D)^{2}}{n-1}\]</span></p>
<p>귀무가설이 사실이라면 차이의 평균은 0이므로</p>
<p><span class="math display">\[T=\frac{\bar D}{S_D/\sqrt{n}} \; \sim t(n-1)\]</span></p>
<section id="모-분산을-모르고-표본의-크기가-클-때-2" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="모-분산을-모르고-표본의-크기가-클-때-2">모 분산을 모르고 표본의 크기가 클 때</h4>
<p>위와 동일하고, 모분산 대신에 표본 분산을 사용합니다. <span class="math inline">\(S^{2}=\frac{1}{n-1}\sum(X_i-\bar X)^{2}\)</span></p>
</section>
</section>
<section id="모-분산-검정-단일-모집단" class="level2" data-number="9.12">
<h2 data-number="9.12" class="anchored" data-anchor-id="모-분산-검정-단일-모집단"><span class="header-section-number">9.12</span> 모 분산 검정: 단일 모집단</h2>
<p><span class="math inline">\(H_0\)</span>가 제시한 모 분산에 대해서 표본 분산을 이용하여 검정을 하는 방법입니다. 모 분산에 대한 검정통계량은 <span class="math inline">\(\chi^{2}\)</span> 며, 계산하는 법은 아래와 같습니다. 비율을 이용해서 양측검정과 단측검정을 모두 할 수 있습니다.</p>
<p><span class="math display">\[\chi^{2}= \frac{(n-1)S^{2}}{\sigma_0^{2}} \sim \chi_{n-1}^{2}\]</span></p>
<ol type="1">
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\sigma^{2}=\sigma^{2}_0\)</span>, <br> <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\sigma^{2} \ne \sigma^{2}_0\)</span></li>
<li>유의수준 <span class="math inline">\(\alpha\)</span>을 결정한다</li>
<li>표본에서 카이제곱 <span class="math inline">\(\chi^{2}\)</span>을 계산한다. 자유도는 <span class="math inline">\(n-1\)</span>.</li>
<li>임계값과 비교하여 기각과 채택을 결정한다</li>
</ol>
<div id="fig-chisq-two-s" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/chisq-two-sided.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9.6: 분산의 가설검정: 단일 모집단</figcaption>
</figure>
</div>
</section>
<section id="모-분산의-검정-두-모집단" class="level2" data-number="9.13">
<h2 data-number="9.13" class="anchored" data-anchor-id="모-분산의-검정-두-모집단"><span class="header-section-number">9.13</span> 모 분산의 검정: 두 모집단</h2>
<p>두 모집단 분산의 차이는 비율로 검정합니다. 확률변수인 두 분산의 비율은 F 분포를 따르므로 F 값을 검정통계량으로 사용합니다. <span class="math inline">\(H_0\)</span>의 가정인 <span class="math inline">\(\sigma_1^{2}=\sigma_2^{2}\)</span> 를 적용하면 아래 공식이 도출됩니다. 그것를 이용해서 검정통계량을 계산합니다. 비율을 이용해서 양측검정과 단측검정을 모두 할 수 있습니다.</p>
<p>두 모집단 분산의 차이에 대한 검정통계량</p>
<p><span class="math display">\[ F=\frac{S_1^{2}}{S_2^{2}} \sim F(n_1-1, n_2-1) \]</span></p>
<section id="가설-검정의-절차" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="가설-검정의-절차">가설 검정의 절차</h4>
<ol type="1">
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(\sigma^{2}=\sigma^{2}_0\)</span>, <br> <span class="math inline">\(H_A\)</span>: <span class="math inline">\(\sigma^{2} \ne \sigma^{2}_0\)</span></li>
<li>유의수준 <span class="math inline">\(\alpha\)</span>을 결정한다</li>
<li>표본에서 F값을 계산한다. 자유도는 <span class="math inline">\((n_1-1,\;n_2-1)\)</span></li>
<li>임계값과 비교하여 기각과 채택을 결정한다</li>
</ol>
<div id="fig-f-one-sided" class="quarto-figure quarto-figure-left anchored">
<figure class="figure">
<p><img src="images/F-one-sided.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;9.7: 분산의 가설검정: 두 모집단</figcaption>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./probabilistic-distribution.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">확률분포와 표집분포</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./categorical-analysis.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">범주형 자료분석</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>